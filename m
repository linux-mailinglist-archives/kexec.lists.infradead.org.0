Return-Path: <kexec-bounces+lists+kexec=lfdr.de@lists.infradead.org>
X-Original-To: lists+kexec@lfdr.de
Delivered-To: lists+kexec@lfdr.de
Received: from bombadil.infradead.org (bombadil.infradead.org [IPv6:2607:7c80:54:e::133])
	by mail.lfdr.de (Postfix) with ESMTPS id A2672162448
	for <lists+kexec@lfdr.de>; Tue, 18 Feb 2020 11:10:16 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed;
	d=lists.infradead.org; s=bombadil.20170209; h=Sender:
	Content-Transfer-Encoding:Content-Type:Cc:List-Subscribe:List-Help:List-Post:
	List-Archive:List-Unsubscribe:List-Id:In-Reply-To:MIME-Version:Date:
	Message-ID:From:References:To:Subject:Reply-To:Content-ID:Content-Description
	:Resent-Date:Resent-From:Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:
	List-Owner; bh=xJNUcB0mU64Gq+KuoqaplvLndSsPpC+++LE6Y0b7Luc=; b=Avw7deohvDDk5c
	mLHxnwAr8UxQdku/BPxUZbx6MmBt5KbaR/d830ywASAjupHKFoqSFYknMdaaDBN11JfYhl35FxgIP
	3l4FjUbr47MYd2bYAo2wub7tljz4UwX7l8C4hkSPi5F9khi+gSraaIbflqNlz37v4kWqH4zUYTMHq
	VfIFEiB2XiZA7O3c6XpOFTqXYzU7uDGuCg9RT7wmPhb/0iBtyy3FJPkf45kjOZl+ideAnbLO6caOr
	x5vTOnT1Jx8ItsCH1nEMCkAvq/EKb5Qtr6BZ+2pYlleADmVivWuMkeaCEyiSBBpRvt+L0WDZ+jzyU
	Aufymq8lNAZe8dv8qUeQ==;
Received: from localhost ([127.0.0.1] helo=bombadil.infradead.org)
	by bombadil.infradead.org with esmtp (Exim 4.92.3 #3 (Red Hat Linux))
	id 1j3zpT-00078P-9B; Tue, 18 Feb 2020 10:10:11 +0000
Received: from us-smtp-1.mimecast.com ([207.211.31.81]
 helo=us-smtp-delivery-1.mimecast.com)
 by bombadil.infradead.org with esmtps (Exim 4.92.3 #3 (Red Hat Linux))
 id 1j2b2W-0003iK-NY
 for kexec@lists.infradead.org; Fri, 14 Feb 2020 13:29:56 +0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
 s=mimecast20190719; t=1581686989;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
 content-transfer-encoding:content-transfer-encoding:
 in-reply-to:in-reply-to:references:references;
 bh=W/8ILaB0zsU/H7AUCCYBmUtn1Jd/MLd/GbjKL0Xgu7M=;
 b=MelUwzP7H3tctOTNXH/55iQTJmuSEaFPC4d+z62fB1xSzSDobuBWgtxWwvsQHqQDRqIV41
 Lkxbbi/x6H5ju3hUaPSnPb8o5Q+mYJ1L2NhfwXnKNbk6k21uvjDvcMWVdYqwFrt2DD7bUU
 55jUWZIeUPdpTDU47TsuWYjMQxQ+nQw=
Received: from mimecast-mx01.redhat.com (mimecast-mx01.redhat.com
 [209.132.183.4]) (Using TLS) by relay.mimecast.com with ESMTP id
 us-mta-25-26jyM-XoMPqS42sPtK5DNg-1; Fri, 14 Feb 2020 08:29:36 -0500
X-MC-Unique: 26jyM-XoMPqS42sPtK5DNg-1
Received: from smtp.corp.redhat.com (int-mx05.intmail.prod.int.phx2.redhat.com
 [10.5.11.15])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mimecast-mx01.redhat.com (Postfix) with ESMTPS id 88BBF800D4E;
 Fri, 14 Feb 2020 13:29:34 +0000 (UTC)
Received: from localhost.localdomain (ovpn-12-202.pek2.redhat.com
 [10.72.12.202])
 by smtp.corp.redhat.com (Postfix) with ESMTPS id BA39D8642B;
 Fri, 14 Feb 2020 13:29:27 +0000 (UTC)
Subject: Re: [PATCH 2/2] printk: use the lockless ringbuffer
To: John Ogness <john.ogness@linutronix.de>
References: <20200128161948.8524-1-john.ogness@linutronix.de>
 <20200128161948.8524-3-john.ogness@linutronix.de>
From: lijiang <lijiang@redhat.com>
Message-ID: <ccbe1383-a4a4-41f8-3330-972f03c97429@redhat.com>
Date: Fri, 14 Feb 2020 21:29:23 +0800
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101
 Thunderbird/52.9.1
MIME-Version: 1.0
In-Reply-To: <20200128161948.8524-3-john.ogness@linutronix.de>
Content-Language: en-US
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.15
X-CRM114-Version: 20100106-BlameMichelson ( TRE 0.8.0 (BSD) ) MR-646709E3 
X-CRM114-CacheID: sfid-20200214_052953_023480_2CCCBFAA 
X-CRM114-Status: GOOD (  37.84  )
X-Spam-Score: -0.2 (/)
X-Spam-Report: SpamAssassin version 3.4.3 on bombadil.infradead.org summary:
 Content analysis details:   (-0.2 points)
 pts rule name              description
 ---- ---------------------- --------------------------------------------------
 -0.0 RCVD_IN_DNSWL_NONE     RBL: Sender listed at https://www.dnswl.org/,
 no trust [207.211.31.81 listed in list.dnswl.org]
 0.0 SPF_HELO_NONE          SPF: HELO does not publish an SPF Record
 -0.0 SPF_PASS               SPF: sender matches SPF record
 -0.1 DKIM_VALID Message has at least one valid DKIM or DK signature
 -0.1 DKIM_VALID_EF          Message has a valid DKIM or DK signature from
 envelope-from domain
 0.1 DKIM_SIGNED            Message has a DKIM or DK signature, not necessarily
 valid
 -0.1 DKIM_VALID_AU          Message has a valid DKIM or DK signature from
 author's domain
 -0.0 DKIMWL_WL_HIGH         DKIMwl.org - Whitelisted High sender
X-Mailman-Approved-At: Tue, 18 Feb 2020 02:10:07 -0800
X-BeenThere: kexec@lists.infradead.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <kexec.lists.infradead.org>
List-Unsubscribe: <http://lists.infradead.org/mailman/options/kexec>,
 <mailto:kexec-request@lists.infradead.org?subject=unsubscribe>
List-Archive: <http://lists.infradead.org/pipermail/kexec/>
List-Post: <mailto:kexec@lists.infradead.org>
List-Help: <mailto:kexec-request@lists.infradead.org?subject=help>
List-Subscribe: <http://lists.infradead.org/mailman/listinfo/kexec>,
 <mailto:kexec-request@lists.infradead.org?subject=subscribe>
Cc: Andrea Parri <parri.andrea@gmail.com>, Petr Mladek <pmladek@suse.com>,
 Sergey Senozhatsky <sergey.senozhatsky.work@gmail.com>,
 Peter Zijlstra <peterz@infradead.org>,
 Greg Kroah-Hartman <gregkh@linuxfoundation.org>, kexec@lists.infradead.org,
 linux-kernel@vger.kernel.org, Steven Rostedt <rostedt@goodmis.org>,
 Sergey Senozhatsky <sergey.senozhatsky@gmail.com>,
 Thomas Gleixner <tglx@linutronix.de>,
 Linus Torvalds <torvalds@linux-foundation.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Sender: "kexec" <kexec-bounces@lists.infradead.org>
Errors-To: kexec-bounces+lists+kexec=lfdr.de@lists.infradead.org

5ZyoIDIwMjDlubQwMeaciDI55pelIDAwOjE5LCBKb2huIE9nbmVzcyDlhpnpgZM6Cj4gUmVwbGFj
ZSB0aGUgZXhpc3RpbmcgcmluZ2J1ZmZlciB1c2FnZSBhbmQgaW1wbGVtZW50YXRpb24gd2l0aAo+
IGxvY2tsZXNzIHJpbmdidWZmZXIgdXNhZ2UuIEV2ZW4gdGhvdWdoIHRoZSBuZXcgcmluZ2J1ZmZl
ciBkb2VzIG5vdAo+IHJlcXVpcmUgbG9ja2luZywgYWxsIGV4aXN0aW5nIGxvY2tpbmcgaXMgbGVm
dCBpbiBwbGFjZS4gVGhlcmVmb3JlLAo+IHRoaXMgY2hhbmdlIGlzIHB1cmVseSByZXBsYWNpbmcg
dGhlIHVuZGVybGluaW5nIHJpbmdidWZmZXIuCj4gCj4gQ2hhbmdlcyB0aGF0IGV4aXN0IGR1ZSB0
byB0aGUgcmluZ2J1ZmZlciByZXBsYWNlbWVudDoKPiAKPiAtIFRoZSBWTUNPUkVJTkZPIGhhcyBi
ZWVuIHVwZGF0ZWQgZm9yIHRoZSBuZXcgc3RydWN0dXJlcy4KPiAKPiAtIERpY3Rpb25hcnkgZGF0
YSBpcyBub3cgc3RvcmVkIGluIGEgc2VwYXJhdGUgZGF0YSBidWZmZXIgZnJvbSB0aGUKPiAgIGh1
bWFuLXJlYWRhYmxlIG1lc3NhZ2VzLiBUaGUgZGljdGlvbmFyeSBkYXRhIGJ1ZmZlciBpcyBzZXQg
dG8gdGhlCj4gICBzYW1lIHNpemUgYXMgdGhlIG1lc3NhZ2UgYnVmZmVyLiBUaGVyZWZvcmUsIHRo
ZSB0b3RhbCByZXNlcnZlZAo+ICAgbWVtb3J5IGZvciBtZXNzYWdlcyBpcyAyICogKDIgXiBDT05G
SUdfTE9HX0JVRl9TSElGVCkgZm9yIHRoZQo+ICAgaW5pdGlhbCBzdGF0aWMgYnVmZmVyIGFuZCAy
eCB0aGUgc3BlY2lmaWVkIHNpemUgaW4gdGhlIGxvZ19idWZfbGVuCj4gICBrZXJuZWwgcGFyYW1l
dGVyLgo+IAo+IC0gUmVjb3JkIG1ldGEtZGF0YSBpcyBub3cgc3RvcmVkIGluIGEgc2VwYXJhdGUg
YXJyYXkgb2YgZGVzY3JpcHRvcnMuCj4gICBUaGlzIGlzIGFuIGFkZGl0aW9uYWwgNzIgKiAoMiBe
ICgoQ09ORklHX0xPR19CVUZfU0hJRlQgLSA2KSkpIGJ5dGVzCj4gICBmb3IgdGhlIHN0YXRpYyBh
cnJheSBhbmQgNzIgKiAoMiBeICgobG9nX2J1Zl9sZW4gLSA2KSkpIGJ5dGVzIGZvcgo+ICAgdGhl
IGR5bmFtaWMgYXJyYXkuCj4gCj4gU2lnbmVkLW9mZi1ieTogSm9obiBPZ25lc3MgPGpvaG4ub2du
ZXNzQGxpbnV0cm9uaXguZGU+Cj4gLS0tCj4gIGluY2x1ZGUvbGludXgva21zZ19kdW1wLmggfCAg
IDIgLQo+ICBrZXJuZWwvcHJpbnRrL01ha2VmaWxlICAgIHwgICAxICsKPiAga2VybmVsL3ByaW50
ay9wcmludGsuYyAgICB8IDgzNiArKysrKysrKysrKysrKysrKysrLS0tLS0tLS0tLS0tLS0tLS0t
LQo+ICAzIGZpbGVzIGNoYW5nZWQsIDQxNiBpbnNlcnRpb25zKCspLCA0MjMgZGVsZXRpb25zKC0p
Cj4gCj4gZGlmZiAtLWdpdCBhL2luY2x1ZGUvbGludXgva21zZ19kdW1wLmggYi9pbmNsdWRlL2xp
bnV4L2ttc2dfZHVtcC5oCj4gaW5kZXggMmU3YTFlMDMyYzcxLi5hZTYyNjUwMzNlMzEgMTAwNjQ0
Cj4gLS0tIGEvaW5jbHVkZS9saW51eC9rbXNnX2R1bXAuaAo+ICsrKyBiL2luY2x1ZGUvbGludXgv
a21zZ19kdW1wLmgKPiBAQCAtNDYsOCArNDYsNiBAQCBzdHJ1Y3Qga21zZ19kdW1wZXIgewo+ICAJ
Ym9vbCByZWdpc3RlcmVkOwo+ICAKPiAgCS8qIHByaXZhdGUgc3RhdGUgb2YgdGhlIGttc2cgaXRl
cmF0b3IgKi8KPiAtCXUzMiBjdXJfaWR4Owo+IC0JdTMyIG5leHRfaWR4Owo+ICAJdTY0IGN1cl9z
ZXE7Cj4gIAl1NjQgbmV4dF9zZXE7Cj4gIH07Cj4gZGlmZiAtLWdpdCBhL2tlcm5lbC9wcmludGsv
TWFrZWZpbGUgYi9rZXJuZWwvcHJpbnRrL01ha2VmaWxlCj4gaW5kZXggNGQwNTJmYzZiY2RlLi5l
ZWUzZGM5YjYwYTkgMTAwNjQ0Cj4gLS0tIGEva2VybmVsL3ByaW50ay9NYWtlZmlsZQo+ICsrKyBi
L2tlcm5lbC9wcmludGsvTWFrZWZpbGUKPiBAQCAtMiwzICsyLDQgQEAKPiAgb2JqLXkJPSBwcmlu
dGsubwo+ICBvYmotJChDT05GSUdfUFJJTlRLKQkrPSBwcmludGtfc2FmZS5vCj4gIG9iai0kKENP
TkZJR19BMTFZX0JSQUlMTEVfQ09OU09MRSkJKz0gYnJhaWxsZS5vCj4gK29iai0kKENPTkZJR19Q
UklOVEspCSs9IHByaW50a19yaW5nYnVmZmVyLm8KPiBkaWZmIC0tZ2l0IGEva2VybmVsL3ByaW50
ay9wcmludGsuYyBiL2tlcm5lbC9wcmludGsvcHJpbnRrLmMKPiBpbmRleCAxZWY2Zjc1ZDkyZjEu
LmQwZDI0ZWUxZDFmNCAxMDA2NDQKPiAtLS0gYS9rZXJuZWwvcHJpbnRrL3ByaW50ay5jCj4gKysr
IGIva2VybmVsL3ByaW50ay9wcmludGsuYwo+IEBAIC01Niw2ICs1Niw3IEBACj4gICNkZWZpbmUg
Q1JFQVRFX1RSQUNFX1BPSU5UUwo+ICAjaW5jbHVkZSA8dHJhY2UvZXZlbnRzL3ByaW50ay5oPgo+
ICAKPiArI2luY2x1ZGUgInByaW50a19yaW5nYnVmZmVyLmgiCj4gICNpbmNsdWRlICJjb25zb2xl
X2NtZGxpbmUuaCIKPiAgI2luY2x1ZGUgImJyYWlsbGUuaCIKPiAgI2luY2x1ZGUgImludGVybmFs
LmgiCj4gQEAgLTI5NCwzMCArMjk1LDIyIEBAIGVudW0gY29uX21zZ19mb3JtYXRfZmxhZ3Mgewo+
ICBzdGF0aWMgaW50IGNvbnNvbGVfbXNnX2Zvcm1hdCA9IE1TR19GT1JNQVRfREVGQVVMVDsKPiAg
Cj4gIC8qCj4gLSAqIFRoZSBwcmludGsgbG9nIGJ1ZmZlciBjb25zaXN0cyBvZiBhIGNoYWluIG9m
IGNvbmNhdGVuYXRlZCB2YXJpYWJsZQo+IC0gKiBsZW5ndGggcmVjb3Jkcy4gRXZlcnkgcmVjb3Jk
IHN0YXJ0cyB3aXRoIGEgcmVjb3JkIGhlYWRlciwgY29udGFpbmluZwo+IC0gKiB0aGUgb3ZlcmFs
bCBsZW5ndGggb2YgdGhlIHJlY29yZC4KPiArICogVGhlIHByaW50ayBsb2cgYnVmZmVyIGNvbnNp
c3RzIG9mIGEgc2VxdWVuY2VkIGNvbGxlY3Rpb24gb2YgcmVjb3JkcywgZWFjaAo+ICsgKiBjb250
YWluaW5nIHZhcmlhYmxlIGxlbmd0aCBtZXNzYWdlIGFuZCBkaWN0aW9uYXJ5IHRleHQuIEV2ZXJ5
IHJlY29yZAo+ICsgKiBhbHNvIGNvbnRhaW5zIGl0cyBvd24gbWV0YS1kYXRhIChAaW5mbykuCj4g
ICAqCj4gLSAqIFRoZSBoZWFkcyB0byB0aGUgZmlyc3QgYW5kIGxhc3QgZW50cnkgaW4gdGhlIGJ1
ZmZlciwgYXMgd2VsbCBhcyB0aGUKPiAtICogc2VxdWVuY2UgbnVtYmVycyBvZiB0aGVzZSBlbnRy
aWVzIGFyZSBtYWludGFpbmVkIHdoZW4gbWVzc2FnZXMgYXJlCj4gLSAqIHN0b3JlZC4KPiAtICoK
PiAtICogSWYgdGhlIGhlYWRzIGluZGljYXRlIGF2YWlsYWJsZSBtZXNzYWdlcywgdGhlIGxlbmd0
aCBpbiB0aGUgaGVhZGVyCj4gLSAqIHRlbGxzIHRoZSBzdGFydCBuZXh0IG1lc3NhZ2UuIEEgbGVu
Z3RoID09IDAgZm9yIHRoZSBuZXh0IG1lc3NhZ2UKPiAtICogaW5kaWNhdGVzIGEgd3JhcC1hcm91
bmQgdG8gdGhlIGJlZ2lubmluZyBvZiB0aGUgYnVmZmVyLgo+IC0gKgo+IC0gKiBFdmVyeSByZWNv
cmQgY2FycmllcyB0aGUgbW9ub3RvbmljIHRpbWVzdGFtcCBpbiBtaWNyb3NlY29uZHMsIGFzIHdl
bGwgYXMKPiAtICogdGhlIHN0YW5kYXJkIHVzZXJzcGFjZSBzeXNsb2cgbGV2ZWwgYW5kIHN5c2xv
ZyBmYWNpbGl0eS4gVGhlIHVzdWFsCj4gKyAqIEV2ZXJ5IHJlY29yZCBtZXRhLWRhdGEgY2Fycmll
cyB0aGUgbW9ub3RvbmljIHRpbWVzdGFtcCBpbiBtaWNyb3NlY29uZHMsIGFzCj4gKyAqIHdlbGwg
YXMgdGhlIHN0YW5kYXJkIHVzZXJzcGFjZSBzeXNsb2cgbGV2ZWwgYW5kIHN5c2xvZyBmYWNpbGl0
eS4gVGhlIHVzdWFsCj4gICAqIGtlcm5lbCBtZXNzYWdlcyB1c2UgTE9HX0tFUk47IHVzZXJzcGFj
ZS1pbmplY3RlZCBtZXNzYWdlcyBhbHdheXMgY2FycnkKPiAgICogYSBtYXRjaGluZyBzeXNsb2cg
ZmFjaWxpdHksIGJ5IGRlZmF1bHQgTE9HX1VTRVIuIFRoZSBvcmlnaW4gb2YgZXZlcnkKPiAgICog
bWVzc2FnZSBjYW4gYmUgcmVsaWFibHkgZGV0ZXJtaW5lZCB0aGF0IHdheS4KPiAgICoKPiAtICog
VGhlIGh1bWFuIHJlYWRhYmxlIGxvZyBtZXNzYWdlIGRpcmVjdGx5IGZvbGxvd3MgdGhlIG1lc3Nh
Z2UgaGVhZGVyLiBUaGUKPiAtICogbGVuZ3RoIG9mIHRoZSBtZXNzYWdlIHRleHQgaXMgc3RvcmVk
IGluIHRoZSBoZWFkZXIsIHRoZSBzdG9yZWQgbWVzc2FnZQo+IC0gKiBpcyBub3QgdGVybWluYXRl
ZC4KPiArICogVGhlIGh1bWFuIHJlYWRhYmxlIGxvZyBtZXNzYWdlIG9mIGEgcmVjb3JkIGlzIGF2
YWlsYWJsZSBpbiBAdGV4dCwgdGhlIGxlbmd0aAo+ICsgKiBvZiB0aGUgbWVzc2FnZSB0ZXh0IGlu
IEB0ZXh0X2xlbi4gVGhlIHN0b3JlZCBtZXNzYWdlIGlzIG5vdCB0ZXJtaW5hdGVkLgo+ICAgKgo+
IC0gKiBPcHRpb25hbGx5LCBhIG1lc3NhZ2UgY2FuIGNhcnJ5IGEgZGljdGlvbmFyeSBvZiBwcm9w
ZXJ0aWVzIChrZXkvdmFsdWUgcGFpcnMpLAo+IC0gKiB0byBwcm92aWRlIHVzZXJzcGFjZSB3aXRo
IGEgbWFjaGluZS1yZWFkYWJsZSBtZXNzYWdlIGNvbnRleHQuCj4gKyAqIE9wdGlvbmFsbHksIGEg
cmVjb3JkIGNhbiBjYXJyeSBhIGRpY3Rpb25hcnkgb2YgcHJvcGVydGllcyAoa2V5L3ZhbHVlIHBh
aXJzKSwKPiArICogdG8gcHJvdmlkZSB1c2Vyc3BhY2Ugd2l0aCBhIG1hY2hpbmUtcmVhZGFibGUg
bWVzc2FnZSBjb250ZXh0LiBUaGUgbGVuZ3RoIG9mCj4gKyAqIHRoZSBkaWN0aW9uYXJ5IGlzIGF2
YWlsYWJsZSBpbiBAZGljdF9sZW4uIFRoZSBkaWN0aW9uYXJ5IGlzIG5vdCB0ZXJtaW5hdGVkLgo+
ICAgKgo+ICAgKiBFeGFtcGxlcyBmb3Igd2VsbC1kZWZpbmVkLCBjb21tb25seSB1c2VkIHByb3Bl
cnR5IG5hbWVzIGFyZToKPiAgICogICBERVZJQ0U9YjEyOjggICAgICAgICAgICAgICBkZXZpY2Ug
aWRlbnRpZmllcgo+IEBAIC0zMzEsMjEgKzMyNCwxOSBAQCBzdGF0aWMgaW50IGNvbnNvbGVfbXNn
X2Zvcm1hdCA9IE1TR19GT1JNQVRfREVGQVVMVDsKPiAgICogZm9sbG93cyBkaXJlY3RseSBhZnRl
ciBhICc9JyBjaGFyYWN0ZXIuIEV2ZXJ5IHByb3BlcnR5IGlzIHRlcm1pbmF0ZWQgYnkKPiAgICog
YSAnXDAnIGNoYXJhY3Rlci4gVGhlIGxhc3QgcHJvcGVydHkgaXMgbm90IHRlcm1pbmF0ZWQuCj4g
ICAqCj4gLSAqIEV4YW1wbGUgb2YgYSBtZXNzYWdlIHN0cnVjdHVyZToKPiAtICogICAwMDAwICBm
ZiA4ZiAwMCAwMCAwMCAwMCAwMCAwMCAgICAgIG1vbm90b25pYyB0aW1lIGluIG5zZWMKPiAtICog
ICAwMDA4ICAzNCAwMCAgICAgICAgICAgICAgICAgICAgICAgIHJlY29yZCBpcyA1MiBieXRlcyBs
b25nCj4gLSAqICAgMDAwYSAgICAgICAgMGIgMDAgICAgICAgICAgICAgICAgICB0ZXh0IGlzIDEx
IGJ5dGVzIGxvbmcKPiAtICogICAwMDBjICAgICAgICAgICAgICAxZiAwMCAgICAgICAgICAgIGRp
Y3Rpb25hcnkgaXMgMjMgYnl0ZXMgbG9uZwo+IC0gKiAgIDAwMGUgICAgICAgICAgICAgICAgICAg
IDAzIDAwICAgICAgTE9HX0tFUk4gKGZhY2lsaXR5KSBMT0dfRVJSIChsZXZlbCkKPiAtICogICAw
MDEwICA2OSA3NCAyNyA3MyAyMCA2MSAyMCA2YyAgICAgICJpdCdzIGEgbCIKPiAtICogICAgICAg
ICA2OSA2ZSA2NSAgICAgICAgICAgICAgICAgICAgICJpbmUiCj4gLSAqICAgMDAxYiAgICAgICAg
ICAgNDQgNDUgNTYgNDkgNDMgICAgICAiREVWSUMiCj4gLSAqICAgICAgICAgNDUgM2QgNjIgMzgg
M2EgMzIgMDAgNDQgICAgICAiRT1iODoyXDBEIgo+IC0gKiAgICAgICAgIDUyIDQ5IDU2IDQ1IDUy
IDNkIDYyIDc1ICAgICAgIlJJVkVSPWJ1Igo+IC0gKiAgICAgICAgIDY3ICAgICAgICAgICAgICAg
ICAgICAgICAgICAgImciCj4gLSAqICAgMDAzMiAgICAgMDAgMDAgMDAgICAgICAgICAgICAgICAg
ICBwYWRkaW5nIHRvIG5leHQgbWVzc2FnZSBoZWFkZXIKPiAtICoKPiAtICogVGhlICdzdHJ1Y3Qg
cHJpbnRrX2xvZycgYnVmZmVyIGhlYWRlciBtdXN0IG5ldmVyIGJlIGRpcmVjdGx5IGV4cG9ydGVk
IHRvCj4gKyAqIEV4YW1wbGUgb2YgcmVjb3JkIHZhbHVlczoKPiArICogICByZWNvcmQudGV4dF9i
dWYgICAgICAgPSAiaXQncyBhIGxpbmUiICh1bnRlcm1pbmF0ZWQpCj4gKyAqICAgcmVjb3JkLmRp
Y3RfYnVmICAgICAgID0gIkRFVklDRT1iODoyXDBEUklWRVI9YnVnIiAodW50ZXJtaW5hdGVkKQo+
ICsgKiAgIHJlY29yZC5pbmZvLnNlcSAgICAgICA9IDU2Cj4gKyAqICAgcmVjb3JkLmluZm8udHNf
c2VjICAgID0gMzY4NjMKPiArICogICByZWNvcmQuaW5mby50ZXh0X2xlbiAgPSAxMQo+ICsgKiAg
IHJlY29yZC5pbmZvLmRpY3RfbGVuICA9IDIyCj4gKyAqICAgcmVjb3JkLmluZm8uZmFjaWxpdHkg
ID0gMCAoTE9HX0tFUk4pCj4gKyAqICAgcmVjb3JkLmluZm8uZmxhZ3MgICAgID0gMAo+ICsgKiAg
IHJlY29yZC5pbmZvLmxldmVsICAgICA9IDMgKExPR19FUlIpCj4gKyAqICAgcmVjb3JkLmluZm8u
Y2FsbGVyX2lkID0gMjk5ICh0YXNrIDI5OSkKPiArICoKPiArICogVGhlICdzdHJ1Y3QgcHJpbnRr
X2luZm8nIGJ1ZmZlciBtdXN0IG5ldmVyIGJlIGRpcmVjdGx5IGV4cG9ydGVkIHRvCj4gICAqIHVz
ZXJzcGFjZSwgaXQgaXMgYSBrZXJuZWwtcHJpdmF0ZSBpbXBsZW1lbnRhdGlvbiBkZXRhaWwgdGhh
dCBtaWdodAo+ICAgKiBuZWVkIHRvIGJlIGNoYW5nZWQgaW4gdGhlIGZ1dHVyZSwgd2hlbiB0aGUg
cmVxdWlyZW1lbnRzIGNoYW5nZS4KPiAgICoKPiBAQCAtMzY1LDIzICszNTYsNiBAQCBlbnVtIGxv
Z19mbGFncyB7Cj4gIAlMT0dfQ09OVAk9IDgsCS8qIHRleHQgaXMgYSBmcmFnbWVudCBvZiBhIGNv
bnRpbnVhdGlvbiBsaW5lICovCj4gIH07Cj4gIAo+IC1zdHJ1Y3QgcHJpbnRrX2xvZyB7Cj4gLQl1
NjQgdHNfbnNlYzsJCS8qIHRpbWVzdGFtcCBpbiBuYW5vc2Vjb25kcyAqLwo+IC0JdTE2IGxlbjsJ
CS8qIGxlbmd0aCBvZiBlbnRpcmUgcmVjb3JkICovCj4gLQl1MTYgdGV4dF9sZW47CQkvKiBsZW5n
dGggb2YgdGV4dCBidWZmZXIgKi8KPiAtCXUxNiBkaWN0X2xlbjsJCS8qIGxlbmd0aCBvZiBkaWN0
aW9uYXJ5IGJ1ZmZlciAqLwo+IC0JdTggZmFjaWxpdHk7CQkvKiBzeXNsb2cgZmFjaWxpdHkgKi8K
PiAtCXU4IGZsYWdzOjU7CQkvKiBpbnRlcm5hbCByZWNvcmQgZmxhZ3MgKi8KPiAtCXU4IGxldmVs
OjM7CQkvKiBzeXNsb2cgbGV2ZWwgKi8KPiAtI2lmZGVmIENPTkZJR19QUklOVEtfQ0FMTEVSCj4g
LQl1MzIgY2FsbGVyX2lkOyAgICAgICAgICAgIC8qIHRocmVhZCBpZCBvciBwcm9jZXNzb3IgaWQg
Ki8KPiAtI2VuZGlmCj4gLX0KPiAtI2lmZGVmIENPTkZJR19IQVZFX0VGRklDSUVOVF9VTkFMSUdO
RURfQUNDRVNTCj4gLV9fcGFja2VkIF9fYWxpZ25lZCg0KQo+IC0jZW5kaWYKPiAtOwo+IC0KPiAg
LyoKPiAgICogVGhlIGxvZ2J1Zl9sb2NrIHByb3RlY3RzIGttc2cgYnVmZmVyLCBpbmRpY2VzLCBj
b3VudGVycy4gIFRoaXMgY2FuIGJlIHRha2VuCj4gICAqIHdpdGhpbiB0aGUgc2NoZWR1bGVyJ3Mg
cnEgbG9jay4gSXQgbXVzdCBiZSByZWxlYXNlZCBiZWZvcmUgY2FsbGluZwo+IEBAIC00MjEsMjYg
KzM5NSwxNyBAQCBERUZJTkVfUkFXX1NQSU5MT0NLKGxvZ2J1Zl9sb2NrKTsKPiAgREVDTEFSRV9X
QUlUX1FVRVVFX0hFQUQobG9nX3dhaXQpOwo+ICAvKiB0aGUgbmV4dCBwcmludGsgcmVjb3JkIHRv
IHJlYWQgYnkgc3lzbG9nKFJFQUQpIG9yIC9wcm9jL2ttc2cgKi8KPiAgc3RhdGljIHU2NCBzeXNs
b2dfc2VxOwo+IC1zdGF0aWMgdTMyIHN5c2xvZ19pZHg7Cj4gIHN0YXRpYyBzaXplX3Qgc3lzbG9n
X3BhcnRpYWw7Cj4gIHN0YXRpYyBib29sIHN5c2xvZ190aW1lOwo+IC0KPiAtLyogaW5kZXggYW5k
IHNlcXVlbmNlIG51bWJlciBvZiB0aGUgZmlyc3QgcmVjb3JkIHN0b3JlZCBpbiB0aGUgYnVmZmVy
ICovCj4gLXN0YXRpYyB1NjQgbG9nX2ZpcnN0X3NlcTsKPiAtc3RhdGljIHUzMiBsb2dfZmlyc3Rf
aWR4Owo+IC0KPiAtLyogaW5kZXggYW5kIHNlcXVlbmNlIG51bWJlciBvZiB0aGUgbmV4dCByZWNv
cmQgdG8gc3RvcmUgaW4gdGhlIGJ1ZmZlciAqLwo+IC1zdGF0aWMgdTY0IGxvZ19uZXh0X3NlcTsK
PiAtc3RhdGljIHUzMiBsb2dfbmV4dF9pZHg7Cj4gK0RFQ0xBUkVfUFJJTlRLUkJfUkVDT1JEKHN5
c2xvZ19yZWNvcmQsIENPTlNPTEVfRVhUX0xPR19NQVgpOwo+ICAKPiAgLyogdGhlIG5leHQgcHJp
bnRrIHJlY29yZCB0byB3cml0ZSB0byB0aGUgY29uc29sZSAqLwo+ICBzdGF0aWMgdTY0IGNvbnNv
bGVfc2VxOwo+IC1zdGF0aWMgdTMyIGNvbnNvbGVfaWR4Owo+ICBzdGF0aWMgdTY0IGV4Y2x1c2l2
ZV9jb25zb2xlX3N0b3Bfc2VxOwo+ICtERUNMQVJFX1BSSU5US1JCX1JFQ09SRChjb25zb2xlX3Jl
Y29yZCwgQ09OU09MRV9FWFRfTE9HX01BWCk7Cj4gIAo+ICAvKiB0aGUgbmV4dCBwcmludGsgcmVj
b3JkIHRvIHJlYWQgYWZ0ZXIgdGhlIGxhc3QgJ2NsZWFyJyBjb21tYW5kICovCj4gIHN0YXRpYyB1
NjQgY2xlYXJfc2VxOwo+IC1zdGF0aWMgdTMyIGNsZWFyX2lkeDsKPiAgCj4gICNpZmRlZiBDT05G
SUdfUFJJTlRLX0NBTExFUgo+ICAjZGVmaW5lIFBSRUZJWF9NQVgJCTQ4Cj4gQEAgLTQ1MywxMyAr
NDE4LDI4IEBAIHN0YXRpYyB1MzIgY2xlYXJfaWR4Owo+ICAjZGVmaW5lIExPR19GQUNJTElUWSh2
KQkJKCh2KSA+PiAzICYgMHhmZikKPiAgCj4gIC8qIHJlY29yZCBidWZmZXIgKi8KPiAtI2RlZmlu
ZSBMT0dfQUxJR04gX19hbGlnbm9mX18oc3RydWN0IHByaW50a19sb2cpCj4gKyNkZWZpbmUgTE9H
X0FMSUdOIF9fYWxpZ25vZl9fKHVuc2lnbmVkIGxvbmcpCj4gICNkZWZpbmUgX19MT0dfQlVGX0xF
TiAoMSA8PCBDT05GSUdfTE9HX0JVRl9TSElGVCkKPiAgI2RlZmluZSBMT0dfQlVGX0xFTl9NQVgg
KHUzMikoMSA8PCAzMSkKPiAgc3RhdGljIGNoYXIgX19sb2dfYnVmW19fTE9HX0JVRl9MRU5dIF9f
YWxpZ25lZChMT0dfQUxJR04pOwo+ICBzdGF0aWMgY2hhciAqbG9nX2J1ZiA9IF9fbG9nX2J1ZjsK
PiAgc3RhdGljIHUzMiBsb2dfYnVmX2xlbiA9IF9fTE9HX0JVRl9MRU47Cj4gIAo+ICsvKgo+ICsg
KiBEZWZpbmUgdGhlIGF2ZXJhZ2UgbWVzc2FnZSBzaXplLiBUaGlzIG9ubHkgYWZmZWN0cyB0aGUg
bnVtYmVyIG9mCj4gKyAqIGRlc2NyaXB0b3JzIHRoYXQgd2lsbCBiZSBhdmFpbGFibGUuIFVuZGVy
ZXN0aW1hdGluZyBpcyBiZXR0ZXIgdGhhbgo+ICsgKiBvdmVyZXN0aW1hdGluZyAodG9vIG1hbnkg
YXZhaWxhYmxlIGRlc2NyaXB0b3JzIGlzIGJldHRlciB0aGFuIG5vdCBlbm91Z2gpLgo+ICsgKiBU
aGUgZGljdGlvbmFyeSBidWZmZXIgd2lsbCBiZSB0aGUgc2FtZSBzaXplIGFzIHRoZSB0ZXh0IGJ1
ZmZlci4KPiArICovCj4gKyNkZWZpbmUgUFJCX0FWR0JJVFMgNgo+ICsKPiArX0RFQ0xBUkVfUFJJ
TlRLUkIocHJpbnRrX3JiX3N0YXRpYywgQ09ORklHX0xPR19CVUZfU0hJRlQgLSBQUkJfQVZHQklU
UywKPiArCQkgIFBSQl9BVkdCSVRTLCBQUkJfQVZHQklUUywgJl9fbG9nX2J1ZlswXSk7Cj4gKwo+
ICtzdGF0aWMgc3RydWN0IHByaW50a19yaW5nYnVmZmVyIHByaW50a19yYl9keW5hbWljOwo+ICsK
PiArc3RhdGljIHN0cnVjdCBwcmludGtfcmluZ2J1ZmZlciAqcHJiID0gJnByaW50a19yYl9zdGF0
aWM7Cj4gKwo+ICAvKiBSZXR1cm4gbG9nIGJ1ZmZlciBhZGRyZXNzICovCj4gIGNoYXIgKmxvZ19i
dWZfYWRkcl9nZXQodm9pZCkKPiAgewo+IEBAIC00NzIsMTA4ICs0NTIsNiBAQCB1MzIgbG9nX2J1
Zl9sZW5fZ2V0KHZvaWQpCj4gIAlyZXR1cm4gbG9nX2J1Zl9sZW47Cj4gIH0KPiAgCj4gLS8qIGh1
bWFuIHJlYWRhYmxlIHRleHQgb2YgdGhlIHJlY29yZCAqLwo+IC1zdGF0aWMgY2hhciAqbG9nX3Rl
eHQoY29uc3Qgc3RydWN0IHByaW50a19sb2cgKm1zZykKPiAtewo+IC0JcmV0dXJuIChjaGFyICop
bXNnICsgc2l6ZW9mKHN0cnVjdCBwcmludGtfbG9nKTsKPiAtfQo+IC0KPiAtLyogb3B0aW9uYWwg
a2V5L3ZhbHVlIHBhaXIgZGljdGlvbmFyeSBhdHRhY2hlZCB0byB0aGUgcmVjb3JkICovCj4gLXN0
YXRpYyBjaGFyICpsb2dfZGljdChjb25zdCBzdHJ1Y3QgcHJpbnRrX2xvZyAqbXNnKQo+IC17Cj4g
LQlyZXR1cm4gKGNoYXIgKiltc2cgKyBzaXplb2Yoc3RydWN0IHByaW50a19sb2cpICsgbXNnLT50
ZXh0X2xlbjsKPiAtfQo+IC0KPiAtLyogZ2V0IHJlY29yZCBieSBpbmRleDsgaWR4IG11c3QgcG9p
bnQgdG8gdmFsaWQgbXNnICovCj4gLXN0YXRpYyBzdHJ1Y3QgcHJpbnRrX2xvZyAqbG9nX2Zyb21f
aWR4KHUzMiBpZHgpCj4gLXsKPiAtCXN0cnVjdCBwcmludGtfbG9nICptc2cgPSAoc3RydWN0IHBy
aW50a19sb2cgKikobG9nX2J1ZiArIGlkeCk7Cj4gLQo+IC0JLyoKPiAtCSAqIEEgbGVuZ3RoID09
IDAgcmVjb3JkIGlzIHRoZSBlbmQgb2YgYnVmZmVyIG1hcmtlci4gV3JhcCBhcm91bmQgYW5kCj4g
LQkgKiByZWFkIHRoZSBtZXNzYWdlIGF0IHRoZSBzdGFydCBvZiB0aGUgYnVmZmVyLgo+IC0JICov
Cj4gLQlpZiAoIW1zZy0+bGVuKQo+IC0JCXJldHVybiAoc3RydWN0IHByaW50a19sb2cgKilsb2df
YnVmOwo+IC0JcmV0dXJuIG1zZzsKPiAtfQo+IC0KPiAtLyogZ2V0IG5leHQgcmVjb3JkOyBpZHgg
bXVzdCBwb2ludCB0byB2YWxpZCBtc2cgKi8KPiAtc3RhdGljIHUzMiBsb2dfbmV4dCh1MzIgaWR4
KQo+IC17Cj4gLQlzdHJ1Y3QgcHJpbnRrX2xvZyAqbXNnID0gKHN0cnVjdCBwcmludGtfbG9nICop
KGxvZ19idWYgKyBpZHgpOwo+IC0KPiAtCS8qIGxlbmd0aCA9PSAwIGluZGljYXRlcyB0aGUgZW5k
IG9mIHRoZSBidWZmZXI7IHdyYXAgKi8KPiAtCS8qCj4gLQkgKiBBIGxlbmd0aCA9PSAwIHJlY29y
ZCBpcyB0aGUgZW5kIG9mIGJ1ZmZlciBtYXJrZXIuIFdyYXAgYXJvdW5kIGFuZAo+IC0JICogcmVh
ZCB0aGUgbWVzc2FnZSBhdCB0aGUgc3RhcnQgb2YgdGhlIGJ1ZmZlciBhcyAqdGhpcyogb25lLCBh
bmQKPiAtCSAqIHJldHVybiB0aGUgb25lIGFmdGVyIHRoYXQuCj4gLQkgKi8KPiAtCWlmICghbXNn
LT5sZW4pIHsKPiAtCQltc2cgPSAoc3RydWN0IHByaW50a19sb2cgKilsb2dfYnVmOwo+IC0JCXJl
dHVybiBtc2ctPmxlbjsKPiAtCX0KPiAtCXJldHVybiBpZHggKyBtc2ctPmxlbjsKPiAtfQo+IC0K
PiAtLyoKPiAtICogQ2hlY2sgd2hldGhlciB0aGVyZSBpcyBlbm91Z2ggZnJlZSBzcGFjZSBmb3Ig
dGhlIGdpdmVuIG1lc3NhZ2UuCj4gLSAqCj4gLSAqIFRoZSBzYW1lIHZhbHVlcyBvZiBmaXJzdF9p
ZHggYW5kIG5leHRfaWR4IG1lYW4gdGhhdCB0aGUgYnVmZmVyCj4gLSAqIGlzIGVpdGhlciBlbXB0
eSBvciBmdWxsLgo+IC0gKgo+IC0gKiBJZiB0aGUgYnVmZmVyIGlzIGVtcHR5LCB3ZSBtdXN0IHJl
c3BlY3QgdGhlIHBvc2l0aW9uIG9mIHRoZSBpbmRleGVzLgo+IC0gKiBUaGV5IGNhbm5vdCBiZSBy
ZXNldCB0byB0aGUgYmVnaW5uaW5nIG9mIHRoZSBidWZmZXIuCj4gLSAqLwo+IC1zdGF0aWMgaW50
IGxvZ2J1Zl9oYXNfc3BhY2UodTMyIG1zZ19zaXplLCBib29sIGVtcHR5KQo+IC17Cj4gLQl1MzIg
ZnJlZTsKPiAtCj4gLQlpZiAobG9nX25leHRfaWR4ID4gbG9nX2ZpcnN0X2lkeCB8fCBlbXB0eSkK
PiAtCQlmcmVlID0gbWF4KGxvZ19idWZfbGVuIC0gbG9nX25leHRfaWR4LCBsb2dfZmlyc3RfaWR4
KTsKPiAtCWVsc2UKPiAtCQlmcmVlID0gbG9nX2ZpcnN0X2lkeCAtIGxvZ19uZXh0X2lkeDsKPiAt
Cj4gLQkvKgo+IC0JICogV2UgbmVlZCBzcGFjZSBhbHNvIGZvciBhbiBlbXB0eSBoZWFkZXIgdGhh
dCBzaWduYWxpemVzIHdyYXBwaW5nCj4gLQkgKiBvZiB0aGUgYnVmZmVyLgo+IC0JICovCj4gLQly
ZXR1cm4gZnJlZSA+PSBtc2dfc2l6ZSArIHNpemVvZihzdHJ1Y3QgcHJpbnRrX2xvZyk7Cj4gLX0K
PiAtCj4gLXN0YXRpYyBpbnQgbG9nX21ha2VfZnJlZV9zcGFjZSh1MzIgbXNnX3NpemUpCj4gLXsK
PiAtCXdoaWxlIChsb2dfZmlyc3Rfc2VxIDwgbG9nX25leHRfc2VxICYmCj4gLQkgICAgICAgIWxv
Z2J1Zl9oYXNfc3BhY2UobXNnX3NpemUsIGZhbHNlKSkgewo+IC0JCS8qIGRyb3Agb2xkIG1lc3Nh
Z2VzIHVudGlsIHdlIGhhdmUgZW5vdWdoIGNvbnRpZ3VvdXMgc3BhY2UgKi8KPiAtCQlsb2dfZmly
c3RfaWR4ID0gbG9nX25leHQobG9nX2ZpcnN0X2lkeCk7Cj4gLQkJbG9nX2ZpcnN0X3NlcSsrOwo+
IC0JfQo+IC0KPiAtCWlmIChjbGVhcl9zZXEgPCBsb2dfZmlyc3Rfc2VxKSB7Cj4gLQkJY2xlYXJf
c2VxID0gbG9nX2ZpcnN0X3NlcTsKPiAtCQljbGVhcl9pZHggPSBsb2dfZmlyc3RfaWR4Owo+IC0J
fQo+IC0KPiAtCS8qIHNlcXVlbmNlIG51bWJlcnMgYXJlIGVxdWFsLCBzbyB0aGUgbG9nIGJ1ZmZl
ciBpcyBlbXB0eSAqLwo+IC0JaWYgKGxvZ2J1Zl9oYXNfc3BhY2UobXNnX3NpemUsIGxvZ19maXJz
dF9zZXEgPT0gbG9nX25leHRfc2VxKSkKPiAtCQlyZXR1cm4gMDsKPiAtCj4gLQlyZXR1cm4gLUVO
T01FTTsKPiAtfQo+IC0KPiAtLyogY29tcHV0ZSB0aGUgbWVzc2FnZSBzaXplIGluY2x1ZGluZyB0
aGUgcGFkZGluZyBieXRlcyAqLwo+IC1zdGF0aWMgdTMyIG1zZ191c2VkX3NpemUodTE2IHRleHRf
bGVuLCB1MTYgZGljdF9sZW4sIHUzMiAqcGFkX2xlbikKPiAtewo+IC0JdTMyIHNpemU7Cj4gLQo+
IC0Jc2l6ZSA9IHNpemVvZihzdHJ1Y3QgcHJpbnRrX2xvZykgKyB0ZXh0X2xlbiArIGRpY3RfbGVu
Owo+IC0JKnBhZF9sZW4gPSAoLXNpemUpICYgKExPR19BTElHTiAtIDEpOwo+IC0Jc2l6ZSArPSAq
cGFkX2xlbjsKPiAtCj4gLQlyZXR1cm4gc2l6ZTsKPiAtfQo+IC0KPiAgLyoKPiAgICogRGVmaW5l
IGhvdyBtdWNoIG9mIHRoZSBsb2cgYnVmZmVyIHdlIGNvdWxkIHRha2UgYXQgbWF4aW11bS4gVGhl
IHZhbHVlCj4gICAqIG11c3QgYmUgZ3JlYXRlciB0aGFuIHR3by4gTm90ZSB0aGF0IG9ubHkgaGFs
ZiBvZiB0aGUgYnVmZmVyIGlzIGF2YWlsYWJsZQo+IEBAIC01ODIsMjIgKzQ2MCwyNiBAQCBzdGF0
aWMgdTMyIG1zZ191c2VkX3NpemUodTE2IHRleHRfbGVuLCB1MTYgZGljdF9sZW4sIHUzMiAqcGFk
X2xlbikKPiAgI2RlZmluZSBNQVhfTE9HX1RBS0VfUEFSVCA0Cj4gIHN0YXRpYyBjb25zdCBjaGFy
IHRydW5jX21zZ1tdID0gIjx0cnVuY2F0ZWQ+IjsKPiAgCj4gLXN0YXRpYyB1MzIgdHJ1bmNhdGVf
bXNnKHUxNiAqdGV4dF9sZW4sIHUxNiAqdHJ1bmNfbXNnX2xlbiwKPiAtCQkJdTE2ICpkaWN0X2xl
biwgdTMyICpwYWRfbGVuKQo+ICtzdGF0aWMgdm9pZCB0cnVuY2F0ZV9tc2codTE2ICp0ZXh0X2xl
biwgdTE2ICp0cnVuY19tc2dfbGVuLCB1MTYgKmRpY3RfbGVuKQo+ICB7Cj4gIAkvKgo+ICAJICog
VGhlIG1lc3NhZ2Ugc2hvdWxkIG5vdCB0YWtlIHRoZSB3aG9sZSBidWZmZXIuIE90aGVyd2lzZSwg
aXQgbWlnaHQKPiAgCSAqIGdldCByZW1vdmVkIHRvbyBzb29uLgo+ICAJICovCj4gIAl1MzIgbWF4
X3RleHRfbGVuID0gbG9nX2J1Zl9sZW4gLyBNQVhfTE9HX1RBS0VfUEFSVDsKPiArCj4gIAlpZiAo
KnRleHRfbGVuID4gbWF4X3RleHRfbGVuKQo+ICAJCSp0ZXh0X2xlbiA9IG1heF90ZXh0X2xlbjsK
PiAtCS8qIGVuYWJsZSB0aGUgd2FybmluZyBtZXNzYWdlICovCj4gKwo+ICsJLyogZW5hYmxlIHRo
ZSB3YXJuaW5nIG1lc3NhZ2UgKGlmIHRoZXJlIGlzIHJvb20pICovCj4gIAkqdHJ1bmNfbXNnX2xl
biA9IHN0cmxlbih0cnVuY19tc2cpOwo+ICsJaWYgKCp0ZXh0X2xlbiA+PSAqdHJ1bmNfbXNnX2xl
bikKPiArCQkqdGV4dF9sZW4gLT0gKnRydW5jX21zZ19sZW47Cj4gKwllbHNlCj4gKwkJKnRydW5j
X21zZ19sZW4gPSAwOwo+ICsKPiAgCS8qIGRpc2FibGUgdGhlICJkaWN0IiBjb21wbGV0ZWx5ICov
Cj4gIAkqZGljdF9sZW4gPSAwOwo+IC0JLyogY29tcHV0ZSB0aGUgc2l6ZSBhZ2FpbiwgY291bnQg
YWxzbyB0aGUgd2FybmluZyBtZXNzYWdlICovCj4gLQlyZXR1cm4gbXNnX3VzZWRfc2l6ZSgqdGV4
dF9sZW4gKyAqdHJ1bmNfbXNnX2xlbiwgMCwgcGFkX2xlbik7Cj4gIH0KPiAgCj4gIC8qIGluc2Vy
dCByZWNvcmQgaW50byB0aGUgYnVmZmVyLCBkaXNjYXJkIG9sZCBvbmVzLCB1cGRhdGUgaGVhZHMg
Ki8KPiBAQCAtNjA2LDYwICs0ODgsNDIgQEAgc3RhdGljIGludCBsb2dfc3RvcmUodTMyIGNhbGxl
cl9pZCwgaW50IGZhY2lsaXR5LCBpbnQgbGV2ZWwsCj4gIAkJICAgICBjb25zdCBjaGFyICpkaWN0
LCB1MTYgZGljdF9sZW4sCj4gIAkJICAgICBjb25zdCBjaGFyICp0ZXh0LCB1MTYgdGV4dF9sZW4p
Cj4gIHsKPiAtCXN0cnVjdCBwcmludGtfbG9nICptc2c7Cj4gLQl1MzIgc2l6ZSwgcGFkX2xlbjsK
PiArCXN0cnVjdCBwcmJfcmVzZXJ2ZWRfZW50cnkgZTsKPiArCXN0cnVjdCBwcmludGtfcmVjb3Jk
IHI7Cj4gIAl1MTYgdHJ1bmNfbXNnX2xlbiA9IDA7Cj4gIAo+IC0JLyogbnVtYmVyIG9mICdcMCcg
cGFkZGluZyBieXRlcyB0byBuZXh0IG1lc3NhZ2UgKi8KPiAtCXNpemUgPSBtc2dfdXNlZF9zaXpl
KHRleHRfbGVuLCBkaWN0X2xlbiwgJnBhZF9sZW4pOwo+ICsJci50ZXh0X2J1Zl9zaXplID0gdGV4
dF9sZW47Cj4gKwlyLmRpY3RfYnVmX3NpemUgPSBkaWN0X2xlbjsKPiAgCj4gLQlpZiAobG9nX21h
a2VfZnJlZV9zcGFjZShzaXplKSkgewo+ICsJaWYgKCFwcmJfcmVzZXJ2ZSgmZSwgcHJiLCAmcikp
IHsKPiAgCQkvKiB0cnVuY2F0ZSB0aGUgbWVzc2FnZSBpZiBpdCBpcyB0b28gbG9uZyBmb3IgZW1w
dHkgYnVmZmVyICovCj4gLQkJc2l6ZSA9IHRydW5jYXRlX21zZygmdGV4dF9sZW4sICZ0cnVuY19t
c2dfbGVuLAo+IC0JCQkJICAgICZkaWN0X2xlbiwgJnBhZF9sZW4pOwo+ICsJCXRydW5jYXRlX21z
ZygmdGV4dF9sZW4sICZ0cnVuY19tc2dfbGVuLCAmZGljdF9sZW4pOwo+ICsJCXIudGV4dF9idWZf
c2l6ZSA9IHRleHRfbGVuICsgdHJ1bmNfbXNnX2xlbjsKPiArCQlyLmRpY3RfYnVmX3NpemUgPSBk
aWN0X2xlbjsKPiAgCQkvKiBzdXJ2aXZlIHdoZW4gdGhlIGxvZyBidWZmZXIgaXMgdG9vIHNtYWxs
IGZvciB0cnVuY19tc2cgKi8KPiAtCQlpZiAobG9nX21ha2VfZnJlZV9zcGFjZShzaXplKSkKPiAr
CQlpZiAoIXByYl9yZXNlcnZlKCZlLCBwcmIsICZyKSkKPiAgCQkJcmV0dXJuIDA7Cj4gIAl9Cj4g
IAo+IC0JaWYgKGxvZ19uZXh0X2lkeCArIHNpemUgKyBzaXplb2Yoc3RydWN0IHByaW50a19sb2cp
ID4gbG9nX2J1Zl9sZW4pIHsKPiAtCQkvKgo+IC0JCSAqIFRoaXMgbWVzc2FnZSArIGFuIGFkZGl0
aW9uYWwgZW1wdHkgaGVhZGVyIGRvZXMgbm90IGZpdAo+IC0JCSAqIGF0IHRoZSBlbmQgb2YgdGhl
IGJ1ZmZlci4gQWRkIGFuIGVtcHR5IGhlYWRlciB3aXRoIGxlbiA9PSAwCj4gLQkJICogdG8gc2ln
bmlmeSBhIHdyYXAgYXJvdW5kLgo+IC0JCSAqLwo+IC0JCW1lbXNldChsb2dfYnVmICsgbG9nX25l
eHRfaWR4LCAwLCBzaXplb2Yoc3RydWN0IHByaW50a19sb2cpKTsKPiAtCQlsb2dfbmV4dF9pZHgg
PSAwOwo+IC0JfQo+IC0KPiAgCS8qIGZpbGwgbWVzc2FnZSAqLwo+IC0JbXNnID0gKHN0cnVjdCBw
cmludGtfbG9nICopKGxvZ19idWYgKyBsb2dfbmV4dF9pZHgpOwo+IC0JbWVtY3B5KGxvZ190ZXh0
KG1zZyksIHRleHQsIHRleHRfbGVuKTsKPiAtCW1zZy0+dGV4dF9sZW4gPSB0ZXh0X2xlbjsKPiAt
CWlmICh0cnVuY19tc2dfbGVuKSB7Cj4gLQkJbWVtY3B5KGxvZ190ZXh0KG1zZykgKyB0ZXh0X2xl
biwgdHJ1bmNfbXNnLCB0cnVuY19tc2dfbGVuKTsKPiAtCQltc2ctPnRleHRfbGVuICs9IHRydW5j
X21zZ19sZW47Cj4gLQl9Cj4gLQltZW1jcHkobG9nX2RpY3QobXNnKSwgZGljdCwgZGljdF9sZW4p
Owo+IC0JbXNnLT5kaWN0X2xlbiA9IGRpY3RfbGVuOwo+IC0JbXNnLT5mYWNpbGl0eSA9IGZhY2ls
aXR5Owo+IC0JbXNnLT5sZXZlbCA9IGxldmVsICYgNzsKPiAtCW1zZy0+ZmxhZ3MgPSBmbGFncyAm
IDB4MWY7Cj4gKwltZW1jcHkoJnIudGV4dF9idWZbMF0sIHRleHQsIHRleHRfbGVuKTsKPiArCWlm
ICh0cnVuY19tc2dfbGVuKQo+ICsJCW1lbWNweSgmci50ZXh0X2J1Zlt0ZXh0X2xlbl0sIHRydW5j
X21zZywgdHJ1bmNfbXNnX2xlbik7Cj4gKwlpZiAoci5kaWN0X2J1ZikKPiArCQltZW1jcHkoJnIu
ZGljdF9idWZbMF0sIGRpY3QsIGRpY3RfbGVuKTsKPiArCXIuaW5mby0+ZmFjaWxpdHkgPSBmYWNp
bGl0eTsKPiArCXIuaW5mby0+bGV2ZWwgPSBsZXZlbCAmIDc7Cj4gKwlyLmluZm8tPmZsYWdzID0g
ZmxhZ3MgJiAweDFmOwo+ICAJaWYgKHRzX25zZWMgPiAwKQo+IC0JCW1zZy0+dHNfbnNlYyA9IHRz
X25zZWM7Cj4gKwkJci5pbmZvLT50c19uc2VjID0gdHNfbnNlYzsKPiAgCWVsc2UKPiAtCQltc2ct
PnRzX25zZWMgPSBsb2NhbF9jbG9jaygpOwo+IC0jaWZkZWYgQ09ORklHX1BSSU5US19DQUxMRVIK
PiAtCW1zZy0+Y2FsbGVyX2lkID0gY2FsbGVyX2lkOwo+IC0jZW5kaWYKPiAtCW1lbXNldChsb2df
ZGljdChtc2cpICsgZGljdF9sZW4sIDAsIHBhZF9sZW4pOwo+IC0JbXNnLT5sZW4gPSBzaXplOwo+
ICsJCXIuaW5mby0+dHNfbnNlYyA9IGxvY2FsX2Nsb2NrKCk7Cj4gKwlyLmluZm8tPmNhbGxlcl9p
ZCA9IGNhbGxlcl9pZDsKPiAgCj4gIAkvKiBpbnNlcnQgbWVzc2FnZSAqLwo+IC0JbG9nX25leHRf
aWR4ICs9IG1zZy0+bGVuOwo+IC0JbG9nX25leHRfc2VxKys7Cj4gKwlwcmJfY29tbWl0KCZlKTsK
PiAgCj4gLQlyZXR1cm4gbXNnLT50ZXh0X2xlbjsKPiArCXJldHVybiB0ZXh0X2xlbjsKPiAgfQo+
ICAKPiAgaW50IGRtZXNnX3Jlc3RyaWN0ID0gSVNfRU5BQkxFRChDT05GSUdfU0VDVVJJVFlfRE1F
U0dfUkVTVFJJQ1QpOwo+IEBAIC03MTEsMTMgKzU3NSwxMyBAQCBzdGF0aWMgdm9pZCBhcHBlbmRf
Y2hhcihjaGFyICoqcHAsIGNoYXIgKmUsIGNoYXIgYykKPiAgCQkqKCpwcCkrKyA9IGM7Cj4gIH0K
PiAgCj4gLXN0YXRpYyBzc2l6ZV90IG1zZ19wcmludF9leHRfaGVhZGVyKGNoYXIgKmJ1Ziwgc2l6
ZV90IHNpemUsCj4gLQkJCQkgICAgc3RydWN0IHByaW50a19sb2cgKm1zZywgdTY0IHNlcSkKPiAr
c3RhdGljIHNzaXplX3QgaW5mb19wcmludF9leHRfaGVhZGVyKGNoYXIgKmJ1Ziwgc2l6ZV90IHNp
emUsCj4gKwkJCQkgICAgIHN0cnVjdCBwcmludGtfaW5mbyAqaW5mbykKPiAgewo+IC0JdTY0IHRz
X3VzZWMgPSBtc2ctPnRzX25zZWM7Cj4gKwl1NjQgdHNfdXNlYyA9IGluZm8tPnRzX25zZWM7Cj4g
IAljaGFyIGNhbGxlclsyMF07Cj4gICNpZmRlZiBDT05GSUdfUFJJTlRLX0NBTExFUgo+IC0JdTMy
IGlkID0gbXNnLT5jYWxsZXJfaWQ7Cj4gKwl1MzIgaWQgPSBpbmZvLT5jYWxsZXJfaWQ7Cj4gIAo+
ICAJc25wcmludGYoY2FsbGVyLCBzaXplb2YoY2FsbGVyKSwgIixjYWxsZXI9JWMldSIsCj4gIAkJ
IGlkICYgMHg4MDAwMDAwMCA/ICdDJyA6ICdUJywgaWQgJiB+MHg4MDAwMDAwMCk7Cj4gQEAgLTcy
OCw4ICs1OTIsOCBAQCBzdGF0aWMgc3NpemVfdCBtc2dfcHJpbnRfZXh0X2hlYWRlcihjaGFyICpi
dWYsIHNpemVfdCBzaXplLAo+ICAJZG9fZGl2KHRzX3VzZWMsIDEwMDApOwo+ICAKPiAgCXJldHVy
biBzY25wcmludGYoYnVmLCBzaXplLCAiJXUsJWxsdSwlbGx1LCVjJXM7IiwKPiAtCQkJIChtc2ct
PmZhY2lsaXR5IDw8IDMpIHwgbXNnLT5sZXZlbCwgc2VxLCB0c191c2VjLAo+IC0JCQkgbXNnLT5m
bGFncyAmIExPR19DT05UID8gJ2MnIDogJy0nLCBjYWxsZXIpOwo+ICsJCQkgKGluZm8tPmZhY2ls
aXR5IDw8IDMpIHwgaW5mby0+bGV2ZWwsIGluZm8tPnNlcSwKPiArCQkJIHRzX3VzZWMsIGluZm8t
PmZsYWdzICYgTE9HX0NPTlQgPyAnYycgOiAnLScsIGNhbGxlcik7Cj4gIH0KPiAgCj4gIHN0YXRp
YyBzc2l6ZV90IG1zZ19wcmludF9leHRfYm9keShjaGFyICpidWYsIHNpemVfdCBzaXplLAo+IEBA
IC03ODMsMTAgKzY0NywxNCBAQCBzdGF0aWMgc3NpemVfdCBtc2dfcHJpbnRfZXh0X2JvZHkoY2hh
ciAqYnVmLCBzaXplX3Qgc2l6ZSwKPiAgLyogL2Rldi9rbXNnIC0gdXNlcnNwYWNlIG1lc3NhZ2Ug
aW5qZWN0L2xpc3RlbiBpbnRlcmZhY2UgKi8KPiAgc3RydWN0IGRldmttc2dfdXNlciB7Cj4gIAl1
NjQgc2VxOwo+IC0JdTMyIGlkeDsKPiAgCXN0cnVjdCByYXRlbGltaXRfc3RhdGUgcnM7Cj4gIAlz
dHJ1Y3QgbXV0ZXggbG9jazsKPiAgCWNoYXIgYnVmW0NPTlNPTEVfRVhUX0xPR19NQVhdOwo+ICsK
PiArCXN0cnVjdCBwcmludGtfaW5mbyBpbmZvOwo+ICsJY2hhciB0ZXh0X2J1ZltDT05TT0xFX0VY
VF9MT0dfTUFYXTsKPiArCWNoYXIgZGljdF9idWZbQ09OU09MRV9FWFRfTE9HX01BWF07Cj4gKwlz
dHJ1Y3QgcHJpbnRrX3JlY29yZCByZWNvcmQ7Cj4gIH07Cj4gIAo+ICBzdGF0aWMgX19wcmludGYo
MywgNCkgX19jb2xkCj4gQEAgLTg2OSw3ICs3MzcsNyBAQCBzdGF0aWMgc3NpemVfdCBkZXZrbXNn
X3JlYWQoc3RydWN0IGZpbGUgKmZpbGUsIGNoYXIgX191c2VyICpidWYsCj4gIAkJCSAgICBzaXpl
X3QgY291bnQsIGxvZmZfdCAqcHBvcykKPiAgewo+ICAJc3RydWN0IGRldmttc2dfdXNlciAqdXNl
ciA9IGZpbGUtPnByaXZhdGVfZGF0YTsKPiAtCXN0cnVjdCBwcmludGtfbG9nICptc2c7Cj4gKwlz
dHJ1Y3QgcHJpbnRrX3JlY29yZCAqciA9ICZ1c2VyLT5yZWNvcmQ7Cj4gIAlzaXplX3QgbGVuOwo+
ICAJc3NpemVfdCByZXQ7Cj4gIAo+IEBAIC04ODEsNyArNzQ5LDcgQEAgc3RhdGljIHNzaXplX3Qg
ZGV2a21zZ19yZWFkKHN0cnVjdCBmaWxlICpmaWxlLCBjaGFyIF9fdXNlciAqYnVmLAo+ICAJCXJl
dHVybiByZXQ7Cj4gIAo+ICAJbG9nYnVmX2xvY2tfaXJxKCk7Cj4gLQl3aGlsZSAodXNlci0+c2Vx
ID09IGxvZ19uZXh0X3NlcSkgewo+ICsJaWYgKCFwcmJfcmVhZF92YWxpZChwcmIsIHVzZXItPnNl
cSwgcikpIHsKPiAgCQlpZiAoZmlsZS0+Zl9mbGFncyAmIE9fTk9OQkxPQ0spIHsKPiAgCQkJcmV0
ID0gLUVBR0FJTjsKPiAgCQkJbG9nYnVmX3VubG9ja19pcnEoKTsKPiBAQCAtODkwLDMwICs3NTgs
MjYgQEAgc3RhdGljIHNzaXplX3QgZGV2a21zZ19yZWFkKHN0cnVjdCBmaWxlICpmaWxlLCBjaGFy
IF9fdXNlciAqYnVmLAo+ICAKPiAgCQlsb2didWZfdW5sb2NrX2lycSgpOwo+ICAJCXJldCA9IHdh
aXRfZXZlbnRfaW50ZXJydXB0aWJsZShsb2dfd2FpdCwKPiAtCQkJCQkgICAgICAgdXNlci0+c2Vx
ICE9IGxvZ19uZXh0X3NlcSk7Cj4gKwkJCQkJcHJiX3JlYWRfdmFsaWQocHJiLCB1c2VyLT5zZXEs
IHIpKTsKPiAgCQlpZiAocmV0KQo+ICAJCQlnb3RvIG91dDsKPiAgCQlsb2didWZfbG9ja19pcnEo
KTsKPiAgCX0KPiAgCj4gLQlpZiAodXNlci0+c2VxIDwgbG9nX2ZpcnN0X3NlcSkgewo+IC0JCS8q
IG91ciBsYXN0IHNlZW4gbWVzc2FnZSBpcyBnb25lLCByZXR1cm4gZXJyb3IgYW5kIHJlc2V0ICov
Cj4gLQkJdXNlci0+aWR4ID0gbG9nX2ZpcnN0X2lkeDsKPiAtCQl1c2VyLT5zZXEgPSBsb2dfZmly
c3Rfc2VxOwo+ICsJaWYgKHVzZXItPnNlcSA8IHItPmluZm8tPnNlcSkgewo+ICsJCS8qIHRoZSBl
eHBlY3RlZCBtZXNzYWdlIGlzIGdvbmUsIHJldHVybiBlcnJvciBhbmQgcmVzZXQgKi8KPiArCQl1
c2VyLT5zZXEgPSByLT5pbmZvLT5zZXE7Cj4gIAkJcmV0ID0gLUVQSVBFOwo+ICAJCWxvZ2J1Zl91
bmxvY2tfaXJxKCk7Cj4gIAkJZ290byBvdXQ7Cj4gIAl9Cj4gIAo+IC0JbXNnID0gbG9nX2Zyb21f
aWR4KHVzZXItPmlkeCk7Cj4gLQlsZW4gPSBtc2dfcHJpbnRfZXh0X2hlYWRlcih1c2VyLT5idWYs
IHNpemVvZih1c2VyLT5idWYpLAo+IC0JCQkJICAgbXNnLCB1c2VyLT5zZXEpOwo+ICsJbGVuID0g
aW5mb19wcmludF9leHRfaGVhZGVyKHVzZXItPmJ1Ziwgc2l6ZW9mKHVzZXItPmJ1ZiksIHItPmlu
Zm8pOwo+ICAJbGVuICs9IG1zZ19wcmludF9leHRfYm9keSh1c2VyLT5idWYgKyBsZW4sIHNpemVv
Zih1c2VyLT5idWYpIC0gbGVuLAo+IC0JCQkJICBsb2dfZGljdChtc2cpLCBtc2ctPmRpY3RfbGVu
LAo+IC0JCQkJICBsb2dfdGV4dChtc2cpLCBtc2ctPnRleHRfbGVuKTsKPiArCQkJCSAgJnItPmRp
Y3RfYnVmWzBdLCByLT5pbmZvLT5kaWN0X2xlbiwKPiArCQkJCSAgJnItPnRleHRfYnVmWzBdLCBy
LT5pbmZvLT50ZXh0X2xlbik7Cj4gIAo+IC0JdXNlci0+aWR4ID0gbG9nX25leHQodXNlci0+aWR4
KTsKPiAtCXVzZXItPnNlcSsrOwo+ICsJdXNlci0+c2VxID0gci0+aW5mby0+c2VxICsgMTsKPiAg
CWxvZ2J1Zl91bmxvY2tfaXJxKCk7Cj4gIAo+ICAJaWYgKGxlbiA+IGNvdW50KSB7Cj4gQEAgLTk0
NSw4ICs4MDksNyBAQCBzdGF0aWMgbG9mZl90IGRldmttc2dfbGxzZWVrKHN0cnVjdCBmaWxlICpm
aWxlLCBsb2ZmX3Qgb2Zmc2V0LCBpbnQgd2hlbmNlKQo+ICAJc3dpdGNoICh3aGVuY2UpIHsKPiAg
CWNhc2UgU0VFS19TRVQ6Cj4gIAkJLyogdGhlIGZpcnN0IHJlY29yZCAqLwo+IC0JCXVzZXItPmlk
eCA9IGxvZ19maXJzdF9pZHg7Cj4gLQkJdXNlci0+c2VxID0gbG9nX2ZpcnN0X3NlcTsKPiArCQl1
c2VyLT5zZXEgPSBwcmJfZmlyc3Rfc2VxKHByYik7Cj4gIAkJYnJlYWs7Cj4gIAljYXNlIFNFRUtf
REFUQToKPiAgCQkvKgo+IEBAIC05NTQsMTMgKzgxNywxMSBAQCBzdGF0aWMgbG9mZl90IGRldmtt
c2dfbGxzZWVrKHN0cnVjdCBmaWxlICpmaWxlLCBsb2ZmX3Qgb2Zmc2V0LCBpbnQgd2hlbmNlKQo+
ICAJCSAqIGxpa2UgaXNzdWVkIGJ5ICdkbWVzZyAtYycuIFJlYWRpbmcgL2Rldi9rbXNnIGl0c2Vs
Zgo+ICAJCSAqIGNoYW5nZXMgbm8gZ2xvYmFsIHN0YXRlLCBhbmQgZG9lcyBub3QgY2xlYXIgYW55
dGhpbmcuCj4gIAkJICovCj4gLQkJdXNlci0+aWR4ID0gY2xlYXJfaWR4Owo+ICAJCXVzZXItPnNl
cSA9IGNsZWFyX3NlcTsKPiAgCQlicmVhazsKPiAgCWNhc2UgU0VFS19FTkQ6Cj4gIAkJLyogYWZ0
ZXIgdGhlIGxhc3QgcmVjb3JkICovCj4gLQkJdXNlci0+aWR4ID0gbG9nX25leHRfaWR4Owo+IC0J
CXVzZXItPnNlcSA9IGxvZ19uZXh0X3NlcTsKPiArCQl1c2VyLT5zZXEgPSBwcmJfbmV4dF9zZXEo
cHJiKTsKPiAgCQlicmVhazsKPiAgCWRlZmF1bHQ6Cj4gIAkJcmV0ID0gLUVJTlZBTDsKPiBAQCAt
OTgwLDkgKzg0MSw5IEBAIHN0YXRpYyBfX3BvbGxfdCBkZXZrbXNnX3BvbGwoc3RydWN0IGZpbGUg
KmZpbGUsIHBvbGxfdGFibGUgKndhaXQpCj4gIAlwb2xsX3dhaXQoZmlsZSwgJmxvZ193YWl0LCB3
YWl0KTsKPiAgCj4gIAlsb2didWZfbG9ja19pcnEoKTsKPiAtCWlmICh1c2VyLT5zZXEgPCBsb2df
bmV4dF9zZXEpIHsKPiArCWlmIChwcmJfcmVhZF92YWxpZChwcmIsIHVzZXItPnNlcSwgTlVMTCkp
IHsKPiAgCQkvKiByZXR1cm4gZXJyb3Igd2hlbiBkYXRhIGhhcyB2YW5pc2hlZCB1bmRlcm5lYXRo
IHVzICovCj4gLQkJaWYgKHVzZXItPnNlcSA8IGxvZ19maXJzdF9zZXEpCj4gKwkJaWYgKHVzZXIt
PnNlcSA8IHByYl9maXJzdF9zZXEocHJiKSkKPiAgCQkJcmV0ID0gRVBPTExJTnxFUE9MTFJETk9S
TXxFUE9MTEVSUnxFUE9MTFBSSTsKPiAgCQllbHNlCj4gIAkJCXJldCA9IEVQT0xMSU58RVBPTExS
RE5PUk07Cj4gQEAgLTEwMTcsOSArODc4LDE0IEBAIHN0YXRpYyBpbnQgZGV2a21zZ19vcGVuKHN0
cnVjdCBpbm9kZSAqaW5vZGUsIHN0cnVjdCBmaWxlICpmaWxlKQo+ICAKPiAgCW11dGV4X2luaXQo
JnVzZXItPmxvY2spOwo+ICAKPiArCXVzZXItPnJlY29yZC5pbmZvID0gJnVzZXItPmluZm87Cj4g
Kwl1c2VyLT5yZWNvcmQudGV4dF9idWYgPSAmdXNlci0+dGV4dF9idWZbMF07Cj4gKwl1c2VyLT5y
ZWNvcmQudGV4dF9idWZfc2l6ZSA9IHNpemVvZih1c2VyLT50ZXh0X2J1Zik7Cj4gKwl1c2VyLT5y
ZWNvcmQuZGljdF9idWYgPSAmdXNlci0+ZGljdF9idWZbMF07Cj4gKwl1c2VyLT5yZWNvcmQuZGlj
dF9idWZfc2l6ZSA9IHNpemVvZih1c2VyLT5kaWN0X2J1Zik7Cj4gKwo+ICAJbG9nYnVmX2xvY2tf
aXJxKCk7Cj4gLQl1c2VyLT5pZHggPSBsb2dfZmlyc3RfaWR4Owo+IC0JdXNlci0+c2VxID0gbG9n
X2ZpcnN0X3NlcTsKPiArCXVzZXItPnNlcSA9IHByYl9maXJzdF9zZXEocHJiKTsKPiAgCWxvZ2J1
Zl91bmxvY2tfaXJxKCk7Cj4gIAo+ICAJZmlsZS0+cHJpdmF0ZV9kYXRhID0gdXNlcjsKPiBAQCAt
MTA2MiwyMSArOTI4LDE2IEBAIHZvaWQgbG9nX2J1Zl92bWNvcmVpbmZvX3NldHVwKHZvaWQpCj4g
IHsKPiAgCVZNQ09SRUlORk9fU1lNQk9MKGxvZ19idWYpOwo+ICAJVk1DT1JFSU5GT19TWU1CT0wo
bG9nX2J1Zl9sZW4pOwoKSGksIEpvaG4gT2duZXNzCgpJIG5vdGljZSB0aGF0IHRoZSAicHJiIihw
cmludGsgdGIgc3RhdGljKSBzeW1ib2wgaXMgbm90IGV4cG9ydGVkIGludG8gdm1jb3JlaW5mbyBh
cyBmb2xsb3dzOgoKKwlWTUNPUkVJTkZPX1NZTUJPTChwcmIpOwoKU2hvdWxkIHRoZSAicHJiIihw
cmludGsgdGIgc3RhdGljKSBzeW1ib2wgYmUgZXhwb3J0ZWQgaW50byB2bWNvcmVpbmZvPyBPdGhl
cndpc2UsIGRvIHlvdQpoYXBwZW4gdG8ga25vdyBob3cgdG8gd2FsayB0aHJvdWdoIHRoZSBsb2df
YnVmIGFuZCBnZXQgYWxsIGtlcm5lbCBsb2dzIGZyb20gdm1jb3JlPwoKVGhhbmtzLgpMaWFuYm8K
Cj4gLQlWTUNPUkVJTkZPX1NZTUJPTChsb2dfZmlyc3RfaWR4KTsKPiAtCVZNQ09SRUlORk9fU1lN
Qk9MKGNsZWFyX2lkeCk7Cj4gLQlWTUNPUkVJTkZPX1NZTUJPTChsb2dfbmV4dF9pZHgpOwo+ICAJ
LyoKPiAtCSAqIEV4cG9ydCBzdHJ1Y3QgcHJpbnRrX2xvZyBzaXplIGFuZCBmaWVsZCBvZmZzZXRz
LiBVc2VyIHNwYWNlIHRvb2xzIGNhbgo+IC0JICogcGFyc2UgaXQgYW5kIGRldGVjdCBhbnkgY2hh
bmdlcyB0byBzdHJ1Y3R1cmUgZG93biB0aGUgbGluZS4KPiArCSAqIEV4cG9ydCBzdHJ1Y3QgcHJp
bnRrX2luZm8gc2l6ZSBhbmQgZmllbGQgb2Zmc2V0cy4gVXNlciBzcGFjZSB0b29scwo+ICsJICog
Y2FuIHBhcnNlIGl0IGFuZCBkZXRlY3QgYW55IGNoYW5nZXMgdG8gc3RydWN0dXJlIGRvd24gdGhl
IGxpbmUuCj4gIAkgKi8KPiAtCVZNQ09SRUlORk9fU1RSVUNUX1NJWkUocHJpbnRrX2xvZyk7Cj4g
LQlWTUNPUkVJTkZPX09GRlNFVChwcmludGtfbG9nLCB0c19uc2VjKTsKPiAtCVZNQ09SRUlORk9f
T0ZGU0VUKHByaW50a19sb2csIGxlbik7Cj4gLQlWTUNPUkVJTkZPX09GRlNFVChwcmludGtfbG9n
LCB0ZXh0X2xlbik7Cj4gLQlWTUNPUkVJTkZPX09GRlNFVChwcmludGtfbG9nLCBkaWN0X2xlbik7
Cj4gLSNpZmRlZiBDT05GSUdfUFJJTlRLX0NBTExFUgo+IC0JVk1DT1JFSU5GT19PRkZTRVQocHJp
bnRrX2xvZywgY2FsbGVyX2lkKTsKPiAtI2VuZGlmCj4gKwlWTUNPUkVJTkZPX1NUUlVDVF9TSVpF
KHByaW50a19pbmZvKTsKPiArCVZNQ09SRUlORk9fT0ZGU0VUKHByaW50a19pbmZvLCBzZXEpOwo+
ICsJVk1DT1JFSU5GT19PRkZTRVQocHJpbnRrX2luZm8sIHRzX25zZWMpOwo+ICsJVk1DT1JFSU5G
T19PRkZTRVQocHJpbnRrX2luZm8sIHRleHRfbGVuKTsKPiArCVZNQ09SRUlORk9fT0ZGU0VUKHBy
aW50a19pbmZvLCBkaWN0X2xlbik7Cj4gKwlWTUNPUkVJTkZPX09GRlNFVChwcmludGtfaW5mbywg
Y2FsbGVyX2lkKTsKPiAgfQo+ICAjZW5kaWYKPiAgCj4gQEAgLTExNDYsMTEgKzEwMDcsNTUgQEAg
c3RhdGljIHZvaWQgX19pbml0IGxvZ19idWZfYWRkX2NwdSh2b2lkKQo+ICBzdGF0aWMgaW5saW5l
IHZvaWQgbG9nX2J1Zl9hZGRfY3B1KHZvaWQpIHt9Cj4gICNlbmRpZiAvKiBDT05GSUdfU01QICov
Cj4gIAo+ICtzdGF0aWMgdW5zaWduZWQgaW50IF9faW5pdCBhZGRfdG9fcmIoc3RydWN0IHByaW50
a19yaW5nYnVmZmVyICpyYiwKPiArCQkJCSAgICAgc3RydWN0IHByaW50a19yZWNvcmQgKnIpCj4g
K3sKPiArCXN0cnVjdCBwcmludGtfaW5mbyBpbmZvOwo+ICsJc3RydWN0IHByaW50a19yZWNvcmQg
ZGVzdF9yID0gewo+ICsJCS5pbmZvID0gJmluZm8sCj4gKwkJLnRleHRfYnVmX3NpemUgPSByLT5p
bmZvLT50ZXh0X2xlbiwKPiArCQkuZGljdF9idWZfc2l6ZSA9IHItPmluZm8tPmRpY3RfbGVuLAo+
ICsJfTsKPiArCXN0cnVjdCBwcmJfcmVzZXJ2ZWRfZW50cnkgZTsKPiArCj4gKwlpZiAoIXByYl9y
ZXNlcnZlKCZlLCByYiwgJmRlc3RfcikpCj4gKwkJcmV0dXJuIDA7Cj4gKwo+ICsJbWVtY3B5KCZk
ZXN0X3IudGV4dF9idWZbMF0sICZyLT50ZXh0X2J1ZlswXSwgZGVzdF9yLnRleHRfYnVmX3NpemUp
Owo+ICsJaWYgKGRlc3Rfci5kaWN0X2J1Zikgewo+ICsJCW1lbWNweSgmZGVzdF9yLmRpY3RfYnVm
WzBdLCAmci0+ZGljdF9idWZbMF0sCj4gKwkJICAgICAgIGRlc3Rfci5kaWN0X2J1Zl9zaXplKTsK
PiArCX0KPiArCWRlc3Rfci5pbmZvLT5mYWNpbGl0eSA9IHItPmluZm8tPmZhY2lsaXR5Owo+ICsJ
ZGVzdF9yLmluZm8tPmxldmVsID0gci0+aW5mby0+bGV2ZWw7Cj4gKwlkZXN0X3IuaW5mby0+Zmxh
Z3MgPSByLT5pbmZvLT5mbGFnczsKPiArCWRlc3Rfci5pbmZvLT50c19uc2VjID0gci0+aW5mby0+
dHNfbnNlYzsKPiArCWRlc3Rfci5pbmZvLT5jYWxsZXJfaWQgPSByLT5pbmZvLT5jYWxsZXJfaWQ7
Cj4gKwo+ICsJcHJiX2NvbW1pdCgmZSk7Cj4gKwo+ICsJcmV0dXJuIHByYl9yZWNvcmRfdGV4dF9z
cGFjZSgmZSk7Cj4gK30KPiArCj4gK3N0YXRpYyBjaGFyIHNldHVwX3RleHRfYnVmW0NPTlNPTEVf
RVhUX0xPR19NQVhdIF9faW5pdGRhdGE7Cj4gK3N0YXRpYyBjaGFyIHNldHVwX2RpY3RfYnVmW0NP
TlNPTEVfRVhUX0xPR19NQVhdIF9faW5pdGRhdGE7Cj4gKwo+ICB2b2lkIF9faW5pdCBzZXR1cF9s
b2dfYnVmKGludCBlYXJseSkKPiAgewo+ICsJc3RydWN0IHByYl9kZXNjICpuZXdfZGVzY3M7Cj4g
KwlzdHJ1Y3QgcHJpbnRrX2luZm8gaW5mbzsKPiArCXN0cnVjdCBwcmludGtfcmVjb3JkIHIgPSB7
Cj4gKwkJLmluZm8gPSAmaW5mbywKPiArCQkudGV4dF9idWYgPSAmc2V0dXBfdGV4dF9idWZbMF0s
Cj4gKwkJLmRpY3RfYnVmID0gJnNldHVwX2RpY3RfYnVmWzBdLAo+ICsJCS50ZXh0X2J1Zl9zaXpl
ID0gc2l6ZW9mKHNldHVwX3RleHRfYnVmKSwKPiArCQkuZGljdF9idWZfc2l6ZSA9IHNpemVvZihz
ZXR1cF9kaWN0X2J1ZiksCj4gKwl9Owo+ICAJdW5zaWduZWQgbG9uZyBmbGFnczsKPiArCWNoYXIg
Km5ld19kaWN0X2J1ZjsKPiAgCWNoYXIgKm5ld19sb2dfYnVmOwo+ICAJdW5zaWduZWQgaW50IGZy
ZWU7Cj4gKwl1NjQgc2VxOwo+ICAKPiAgCWlmIChsb2dfYnVmICE9IF9fbG9nX2J1ZikKPiAgCQly
ZXR1cm47Cj4gQEAgLTExNjMsMTcgKzEwNjgsNDYgQEAgdm9pZCBfX2luaXQgc2V0dXBfbG9nX2J1
ZihpbnQgZWFybHkpCj4gIAo+ICAJbmV3X2xvZ19idWYgPSBtZW1ibG9ja19hbGxvYyhuZXdfbG9n
X2J1Zl9sZW4sIExPR19BTElHTik7Cj4gIAlpZiAodW5saWtlbHkoIW5ld19sb2dfYnVmKSkgewo+
IC0JCXByX2VycigibG9nX2J1Zl9sZW46ICVsdSBieXRlcyBub3QgYXZhaWxhYmxlXG4iLAo+ICsJ
CXByX2VycigibG9nX2J1Zl9sZW46ICVsdSB0ZXh0IGJ5dGVzIG5vdCBhdmFpbGFibGVcbiIsCj4g
IAkJCW5ld19sb2dfYnVmX2xlbik7Cj4gIAkJcmV0dXJuOwo+ICAJfQo+ICAKPiArCW5ld19kaWN0
X2J1ZiA9IG1lbWJsb2NrX2FsbG9jKG5ld19sb2dfYnVmX2xlbiwgTE9HX0FMSUdOKTsKPiArCWlm
ICh1bmxpa2VseSghbmV3X2RpY3RfYnVmKSkgewo+ICsJCS8qIGRpY3Rpb25hcnkgZmFpbHVyZSBp
cyBhbGxvd2VkICovCj4gKwkJcHJfZXJyKCJsb2dfYnVmX2xlbjogJWx1IGRpY3QgYnl0ZXMgbm90
IGF2YWlsYWJsZVxuIiwKPiArCQkJbmV3X2xvZ19idWZfbGVuKTsKPiArCX0KPiArCj4gKwluZXdf
ZGVzY3MgPSBtZW1ibG9ja19hbGxvYygobmV3X2xvZ19idWZfbGVuID4+IFBSQl9BVkdCSVRTKSAq
Cj4gKwkJCQkgICBzaXplb2Yoc3RydWN0IHByYl9kZXNjKSwgTE9HX0FMSUdOKTsKPiArCWlmICh1
bmxpa2VseSghbmV3X2Rlc2NzKSkgewo+ICsJCXByX2VycigibG9nX2J1Zl9sZW46ICVsdSBkZXNj
IGJ5dGVzIG5vdCBhdmFpbGFibGVcbiIsCj4gKwkJCW5ld19sb2dfYnVmX2xlbiA+PiBQUkJfQVZH
QklUUyk7Cj4gKwkJaWYgKG5ld19kaWN0X2J1ZikKPiArCQkJbWVtYmxvY2tfZnJlZShfX3BhKG5l
d19kaWN0X2J1ZiksIG5ld19sb2dfYnVmX2xlbik7Cj4gKwkJbWVtYmxvY2tfZnJlZShfX3BhKG5l
d19sb2dfYnVmKSwgbmV3X2xvZ19idWZfbGVuKTsKPiArCQlyZXR1cm47Cj4gKwl9Cj4gKwo+ICAJ
bG9nYnVmX2xvY2tfaXJxc2F2ZShmbGFncyk7Cj4gKwo+ICsJcHJiX2luaXQoJnByaW50a19yYl9k
eW5hbWljLAo+ICsJCSBuZXdfbG9nX2J1ZiwgYml0c19wZXIobmV3X2xvZ19idWZfbGVuKSAtIDEs
Cj4gKwkJIG5ld19kaWN0X2J1ZiwgYml0c19wZXIobmV3X2xvZ19idWZfbGVuKSAtIDEsCj4gKwkJ
IG5ld19kZXNjcywgKGJpdHNfcGVyKG5ld19sb2dfYnVmX2xlbikgLSAxKSAtIFBSQl9BVkdCSVRT
KTsKPiArCj4gIAlsb2dfYnVmX2xlbiA9IG5ld19sb2dfYnVmX2xlbjsKPiAgCWxvZ19idWYgPSBu
ZXdfbG9nX2J1ZjsKPiAgCW5ld19sb2dfYnVmX2xlbiA9IDA7Cj4gLQlmcmVlID0gX19MT0dfQlVG
X0xFTiAtIGxvZ19uZXh0X2lkeDsKPiAtCW1lbWNweShsb2dfYnVmLCBfX2xvZ19idWYsIF9fTE9H
X0JVRl9MRU4pOwo+ICsKPiArCWZyZWUgPSBfX0xPR19CVUZfTEVOOwo+ICsJcHJiX2Zvcl9lYWNo
X3JlY29yZCgwLCAmcHJpbnRrX3JiX3N0YXRpYywgc2VxLCAmcikKPiArCQlmcmVlIC09IGFkZF90
b19yYigmcHJpbnRrX3JiX2R5bmFtaWMsICZyKTsKPiArCj4gKwlwcmIgPSAmcHJpbnRrX3JiX2R5
bmFtaWM7Cj4gKwo+ICAJbG9nYnVmX3VubG9ja19pcnFyZXN0b3JlKGZsYWdzKTsKPiAgCj4gIAlw
cl9pbmZvKCJsb2dfYnVmX2xlbjogJXUgYnl0ZXNcbiIsIGxvZ19idWZfbGVuKTsKPiBAQCAtMTI4
NSwxOCArMTIxOSwxOCBAQCBzdGF0aWMgc2l6ZV90IHByaW50X2NhbGxlcih1MzIgaWQsIGNoYXIg
KmJ1ZikKPiAgI2RlZmluZSBwcmludF9jYWxsZXIoaWQsIGJ1ZikgMAo+ICAjZW5kaWYKPiAgCj4g
LXN0YXRpYyBzaXplX3QgcHJpbnRfcHJlZml4KGNvbnN0IHN0cnVjdCBwcmludGtfbG9nICptc2cs
IGJvb2wgc3lzbG9nLAo+IC0JCQkgICBib29sIHRpbWUsIGNoYXIgKmJ1ZikKPiArc3RhdGljIHNp
emVfdCBpbmZvX3ByaW50X3ByZWZpeChjb25zdCBzdHJ1Y3QgcHJpbnRrX2luZm8gICppbmZvLCBi
b29sIHN5c2xvZywKPiArCQkJCWJvb2wgdGltZSwgY2hhciAqYnVmKQo+ICB7Cj4gIAlzaXplX3Qg
bGVuID0gMDsKPiAgCj4gIAlpZiAoc3lzbG9nKQo+IC0JCWxlbiA9IHByaW50X3N5c2xvZygobXNn
LT5mYWNpbGl0eSA8PCAzKSB8IG1zZy0+bGV2ZWwsIGJ1Zik7Cj4gKwkJbGVuID0gcHJpbnRfc3lz
bG9nKChpbmZvLT5mYWNpbGl0eSA8PCAzKSB8IGluZm8tPmxldmVsLCBidWYpOwo+ICAKPiAgCWlm
ICh0aW1lKQo+IC0JCWxlbiArPSBwcmludF90aW1lKG1zZy0+dHNfbnNlYywgYnVmICsgbGVuKTsK
PiArCQlsZW4gKz0gcHJpbnRfdGltZShpbmZvLT50c19uc2VjLCBidWYgKyBsZW4pOwo+ICAKPiAt
CWxlbiArPSBwcmludF9jYWxsZXIobXNnLT5jYWxsZXJfaWQsIGJ1ZiArIGxlbik7Cj4gKwlsZW4g
Kz0gcHJpbnRfY2FsbGVyKGluZm8tPmNhbGxlcl9pZCwgYnVmICsgbGVuKTsKPiAgCj4gIAlpZiAo
SVNfRU5BQkxFRChDT05GSUdfUFJJTlRLX0NBTExFUikgfHwgdGltZSkgewo+ICAJCWJ1ZltsZW4r
K10gPSAnICc7Cj4gQEAgLTEzMDYsMTQgKzEyNDAsMTUgQEAgc3RhdGljIHNpemVfdCBwcmludF9w
cmVmaXgoY29uc3Qgc3RydWN0IHByaW50a19sb2cgKm1zZywgYm9vbCBzeXNsb2csCj4gIAlyZXR1
cm4gbGVuOwo+ICB9Cj4gIAo+IC1zdGF0aWMgc2l6ZV90IG1zZ19wcmludF90ZXh0KGNvbnN0IHN0
cnVjdCBwcmludGtfbG9nICptc2csIGJvb2wgc3lzbG9nLAo+IC0JCQkgICAgIGJvb2wgdGltZSwg
Y2hhciAqYnVmLCBzaXplX3Qgc2l6ZSkKPiArc3RhdGljIHNpemVfdCByZWNvcmRfcHJpbnRfdGV4
dChjb25zdCBzdHJ1Y3QgcHJpbnRrX3JlY29yZCAqciwgYm9vbCBzeXNsb2csCj4gKwkJCQlib29s
IHRpbWUsIGNoYXIgKmJ1Ziwgc2l6ZV90IHNpemUpCj4gIHsKPiAtCWNvbnN0IGNoYXIgKnRleHQg
PSBsb2dfdGV4dChtc2cpOwo+IC0Jc2l6ZV90IHRleHRfc2l6ZSA9IG1zZy0+dGV4dF9sZW47Cj4g
Kwljb25zdCBjaGFyICp0ZXh0ID0gJnItPnRleHRfYnVmWzBdOwo+ICsJc2l6ZV90IHRleHRfc2l6
ZSA9IHItPmluZm8tPnRleHRfbGVuOwo+ICAJc2l6ZV90IGxlbiA9IDA7Cj4gIAljaGFyIHByZWZp
eFtQUkVGSVhfTUFYXTsKPiAtCWNvbnN0IHNpemVfdCBwcmVmaXhfbGVuID0gcHJpbnRfcHJlZml4
KG1zZywgc3lzbG9nLCB0aW1lLCBwcmVmaXgpOwo+ICsJY29uc3Qgc2l6ZV90IHByZWZpeF9sZW4g
PSBpbmZvX3ByaW50X3ByZWZpeChyLT5pbmZvLCBzeXNsb2csIHRpbWUsCj4gKwkJCQkJCSAgICBw
cmVmaXgpOwo+ICAKPiAgCWRvIHsKPiAgCQljb25zdCBjaGFyICpuZXh0ID0gbWVtY2hyKHRleHQs
ICdcbicsIHRleHRfc2l6ZSk7Cj4gQEAgLTEzNDcsMTAgKzEyODIsOTQgQEAgc3RhdGljIHNpemVf
dCBtc2dfcHJpbnRfdGV4dChjb25zdCBzdHJ1Y3QgcHJpbnRrX2xvZyAqbXNnLCBib29sIHN5c2xv
ZywKPiAgCXJldHVybiBsZW47Cj4gIH0KPiAgCj4gK3N0YXRpYyBzaXplX3QgcmVjb3JkX3ByaW50
X3RleHRfaW5saW5lKHN0cnVjdCBwcmludGtfcmVjb3JkICpyLCBib29sIHN5c2xvZywKPiArCQkJ
CSAgICAgICBib29sIHRpbWUpCj4gK3sKPiArCXNpemVfdCB0ZXh0X2xlbiA9IHItPmluZm8tPnRl
eHRfbGVuOwo+ICsJc2l6ZV90IGJ1Zl9zaXplID0gci0+dGV4dF9idWZfc2l6ZTsKPiArCWNoYXIg
KnRleHQgPSByLT50ZXh0X2J1ZjsKPiArCWNoYXIgcHJlZml4W1BSRUZJWF9NQVhdOwo+ICsJYm9v
bCB0cnVuY2F0ZWQgPSBmYWxzZTsKPiArCXNpemVfdCBwcmVmaXhfbGVuOwo+ICsJc2l6ZV90IGxl
biA9IDA7Cj4gKwo+ICsJcHJlZml4X2xlbiA9IGluZm9fcHJpbnRfcHJlZml4KHItPmluZm8sIHN5
c2xvZywgdGltZSwgcHJlZml4KTsKPiArCj4gKwlpZiAoIXRleHQpIHsKPiArCQkvKiBTWVNMT0df
QUNUSU9OXyogYnVmZmVyIHNpemUgb25seSBjYWxjdWxhdGlvbiAqLwo+ICsJCXVuc2lnbmVkIGlu
dCBsaW5lX2NvdW50ID0gMTsKPiArCj4gKwkJaWYgKHItPnRleHRfbGluZV9jb3VudCkKPiArCQkJ
bGluZV9jb3VudCA9ICooci0+dGV4dF9saW5lX2NvdW50KTsKPiArCQkvKgo+ICsJCSAqIEVhY2gg
bGluZSB3aWxsIGJlIHByZWNlZGVkIHdpdGggYSBwcmVmaXguIFRoZSBpbnRlcm1lZGlhdGUKPiAr
CQkgKiBuZXdsaW5lcyBhcmUgYWxyZWFkeSB3aXRoaW4gdGhlIHRleHQsIGJ1dCBhIGZpbmFsIHRy
YWlsaW5nCj4gKwkJICogbmV3bGluZSB3aWxsIGJlIGFkZGVkLgo+ICsJCSAqLwo+ICsJCXJldHVy
biAoKHByZWZpeF9sZW4gKiBsaW5lX2NvdW50KSArIHItPmluZm8tPnRleHRfbGVuICsgMSk7Cj4g
Kwl9Cj4gKwo+ICsJLyoKPiArCSAqIEFkZCB0aGUgcHJlZml4IGZvciBlYWNoIGxpbmUgYnkgc2hp
ZnRpbmcgdGhlIHJlc3Qgb2YgdGhlIHRleHQgdG8KPiArCSAqIG1ha2Ugcm9vbSBmb3IgdGhlIHBy
ZWZpeC4gSWYgdGhlIGJ1ZmZlciBpcyBub3QgbGFyZ2UgZW5vdWdoIGZvciBhbGwKPiArCSAqIHRo
ZSBwcmVmaXhlcywgdGhlbiBkcm9wIHRoZSB0cmFpbGluZyB0ZXh0IGFuZCByZXBvcnQgdGhlIGxh
cmdlc3QKPiArCSAqIGxlbmd0aCB0aGF0IGluY2x1ZGVzIGZ1bGwgbGluZXMgd2l0aCB0aGVpciBw
cmVmaXhlcy4KPiArCSAqLwo+ICsJd2hpbGUgKHRleHRfbGVuKSB7Cj4gKwkJc2l6ZV90IGxpbmVf
bGVuOwo+ICsJCWNoYXIgKm5leHQ7Cj4gKwo+ICsJCW5leHQgPSBtZW1jaHIodGV4dCwgJ1xuJywg
dGV4dF9sZW4pOwo+ICsJCWlmIChuZXh0KSB7Cj4gKwkJCWxpbmVfbGVuID0gbmV4dCAtIHRleHQ7
Cj4gKwkJfSBlbHNlIHsKPiArCQkJLyoKPiArCQkJICogSWYgdGhlIHRleHQgaGFzIGJlZW4gdHJ1
bmNhdGVkLCBhc3N1bWUgdGhpcyBsaW5lCj4gKwkJCSAqIHdhcyB0cnVuY2F0ZWQgYW5kIGRvIG5v
dCBpbmNsdWRlIHRoaXMgdGV4dC4KPiArCQkJICovCj4gKwkJCWlmICh0cnVuY2F0ZWQpCj4gKwkJ
CQlicmVhazsKPiArCQkJbGluZV9sZW4gPSB0ZXh0X2xlbjsKPiArCQl9Cj4gKwo+ICsJCS8qCj4g
KwkJICogSXMgdGhlcmUgZW5vdWdoIGJ1ZmZlciBhdmFpbGFibGUgdG8gc2hpZnQgdGhpcyBsaW5l
Cj4gKwkJICogKGFuZCBhZGQgYSBuZXdsaW5lIGF0IHRoZSBlbmQpPwo+ICsJCSAqLwo+ICsJCWlm
IChsZW4gKyBwcmVmaXhfbGVuICsgbGluZV9sZW4gPj0gYnVmX3NpemUpCj4gKwkJCWJyZWFrOwo+
ICsKPiArCQkvKgo+ICsJCSAqIElzIHRoZXJlIGVub3VnaCBidWZmZXIgYXZhaWxhYmxlIHRvIHNo
aWZ0IGFsbCByZW1haW5pbmcKPiArCQkgKiB0ZXh0IChhbmQgYWRkIGEgbmV3bGluZSBhdCB0aGUg
ZW5kKT8KPiArCQkgKi8KPiArCQlpZiAobGVuICsgcHJlZml4X2xlbiArIHRleHRfbGVuID49IGJ1
Zl9zaXplKSB7Cj4gKwkJCXRleHRfbGVuID0gKGJ1Zl9zaXplIC0gbGVuKSAtIHByZWZpeF9sZW47
Cj4gKwkJCXRydW5jYXRlZCA9IHRydWU7Cj4gKwkJfQo+ICsKPiArCQltZW1tb3ZlKHRleHQgKyBw
cmVmaXhfbGVuLCB0ZXh0LCB0ZXh0X2xlbik7Cj4gKwkJbWVtY3B5KHRleHQsIHByZWZpeCwgcHJl
Zml4X2xlbik7Cj4gKwo+ICsJCXRleHQgKz0gcHJlZml4X2xlbiArIGxpbmVfbGVuOwo+ICsJCXRl
eHRfbGVuIC09IGxpbmVfbGVuOwo+ICsKPiArCQlpZiAodGV4dF9sZW4pIHsKPiArCQkJdGV4dF9s
ZW4tLTsKPiArCQkJdGV4dCsrOwo+ICsJCX0gZWxzZSB7Cj4gKwkJCSp0ZXh0ID0gJ1xuJzsKPiAr
CQl9Cj4gKwo+ICsJCWxlbiArPSBwcmVmaXhfbGVuICsgbGluZV9sZW4gKyAxOwo+ICsJfQo+ICsK
PiArCXJldHVybiBsZW47Cj4gK30KPiArCj4gIHN0YXRpYyBpbnQgc3lzbG9nX3ByaW50KGNoYXIg
X191c2VyICpidWYsIGludCBzaXplKQo+ICB7Cj4gIAljaGFyICp0ZXh0Owo+IC0Jc3RydWN0IHBy
aW50a19sb2cgKm1zZzsKPiAgCWludCBsZW4gPSAwOwo+ICAKPiAgCXRleHQgPSBrbWFsbG9jKExP
R19MSU5FX01BWCArIFBSRUZJWF9NQVgsIEdGUF9LRVJORUwpOwo+IEBAIC0xMzYyLDE2ICsxMzgx
LDE1IEBAIHN0YXRpYyBpbnQgc3lzbG9nX3ByaW50KGNoYXIgX191c2VyICpidWYsIGludCBzaXpl
KQo+ICAJCXNpemVfdCBza2lwOwo+ICAKPiAgCQlsb2didWZfbG9ja19pcnEoKTsKPiAtCQlpZiAo
c3lzbG9nX3NlcSA8IGxvZ19maXJzdF9zZXEpIHsKPiAtCQkJLyogbWVzc2FnZXMgYXJlIGdvbmUs
IG1vdmUgdG8gZmlyc3Qgb25lICovCj4gLQkJCXN5c2xvZ19zZXEgPSBsb2dfZmlyc3Rfc2VxOwo+
IC0JCQlzeXNsb2dfaWR4ID0gbG9nX2ZpcnN0X2lkeDsKPiAtCQkJc3lzbG9nX3BhcnRpYWwgPSAw
Owo+IC0JCX0KPiAtCQlpZiAoc3lzbG9nX3NlcSA9PSBsb2dfbmV4dF9zZXEpIHsKPiArCQlpZiAo
IXByYl9yZWFkX3ZhbGlkKHByYiwgc3lzbG9nX3NlcSwgJnN5c2xvZ19yZWNvcmQpKSB7Cj4gIAkJ
CWxvZ2J1Zl91bmxvY2tfaXJxKCk7Cj4gIAkJCWJyZWFrOwo+ICAJCX0KPiArCQlpZiAoc3lzbG9n
X3JlY29yZC5pbmZvLT5zZXEgIT0gc3lzbG9nX3NlcSkgewo+ICsJCQkvKiBtZXNzYWdlcyBhcmUg
Z29uZSwgbW92ZSB0byBmaXJzdCBvbmUgKi8KPiArCQkJc3lzbG9nX3NlcSA9IHN5c2xvZ19yZWNv
cmQuaW5mby0+c2VxOwo+ICsJCQlzeXNsb2dfcGFydGlhbCA9IDA7Cj4gKwkJfQo+ICAKPiAgCQkv
Kgo+ICAJCSAqIFRvIGtlZXAgcmVhZGluZy9jb3VudGluZyBwYXJ0aWFsIGxpbmUgY29uc2lzdGVu
dCwKPiBAQCAtMTM4MSwxMyArMTM5OSwxMSBAQCBzdGF0aWMgaW50IHN5c2xvZ19wcmludChjaGFy
IF9fdXNlciAqYnVmLCBpbnQgc2l6ZSkKPiAgCQkJc3lzbG9nX3RpbWUgPSBwcmludGtfdGltZTsK
PiAgCj4gIAkJc2tpcCA9IHN5c2xvZ19wYXJ0aWFsOwo+IC0JCW1zZyA9IGxvZ19mcm9tX2lkeChz
eXNsb2dfaWR4KTsKPiAtCQluID0gbXNnX3ByaW50X3RleHQobXNnLCB0cnVlLCBzeXNsb2dfdGlt
ZSwgdGV4dCwKPiAtCQkJCSAgIExPR19MSU5FX01BWCArIFBSRUZJWF9NQVgpOwo+ICsJCW4gPSBy
ZWNvcmRfcHJpbnRfdGV4dCgmc3lzbG9nX3JlY29yZCwgdHJ1ZSwgc3lzbG9nX3RpbWUsIHRleHQs
Cj4gKwkJCQkgICAgICBMT0dfTElORV9NQVggKyBQUkVGSVhfTUFYKTsKPiAgCQlpZiAobiAtIHN5
c2xvZ19wYXJ0aWFsIDw9IHNpemUpIHsKPiAgCQkJLyogbWVzc2FnZSBmaXRzIGludG8gYnVmZmVy
LCBtb3ZlIGZvcndhcmQgKi8KPiAtCQkJc3lzbG9nX2lkeCA9IGxvZ19uZXh0KHN5c2xvZ19pZHgp
Owo+IC0JCQlzeXNsb2dfc2VxKys7Cj4gKwkJCXN5c2xvZ19zZXEgPSBzeXNsb2dfcmVjb3JkLmlu
Zm8tPnNlcSArIDE7Cj4gIAkJCW4gLT0gc3lzbG9nX3BhcnRpYWw7Cj4gIAkJCXN5c2xvZ19wYXJ0
aWFsID0gMDsKPiAgCQl9IGVsc2UgaWYgKCFsZW4pewo+IEBAIC0xNDIwLDkgKzE0MzYsNyBAQCBz
dGF0aWMgaW50IHN5c2xvZ19wcmludF9hbGwoY2hhciBfX3VzZXIgKmJ1ZiwgaW50IHNpemUsIGJv
b2wgY2xlYXIpCj4gIHsKPiAgCWNoYXIgKnRleHQ7Cj4gIAlpbnQgbGVuID0gMDsKPiAtCXU2NCBu
ZXh0X3NlcTsKPiAgCXU2NCBzZXE7Cj4gLQl1MzIgaWR4Owo+ICAJYm9vbCB0aW1lOwo+ICAKPiAg
CXRleHQgPSBrbWFsbG9jKExPR19MSU5FX01BWCArIFBSRUZJWF9NQVgsIEdGUF9LRVJORUwpOwo+
IEBAIC0xNDM1LDM4ICsxNDQ5LDMwIEBAIHN0YXRpYyBpbnQgc3lzbG9nX3ByaW50X2FsbChjaGFy
IF9fdXNlciAqYnVmLCBpbnQgc2l6ZSwgYm9vbCBjbGVhcikKPiAgCSAqIEZpbmQgZmlyc3QgcmVj
b3JkIHRoYXQgZml0cywgaW5jbHVkaW5nIGFsbCBmb2xsb3dpbmcgcmVjb3JkcywKPiAgCSAqIGlu
dG8gdGhlIHVzZXItcHJvdmlkZWQgYnVmZmVyIGZvciB0aGlzIGR1bXAuCj4gIAkgKi8KPiAtCXNl
cSA9IGNsZWFyX3NlcTsKPiAtCWlkeCA9IGNsZWFyX2lkeDsKPiAtCXdoaWxlIChzZXEgPCBsb2df
bmV4dF9zZXEpIHsKPiAtCQlzdHJ1Y3QgcHJpbnRrX2xvZyAqbXNnID0gbG9nX2Zyb21faWR4KGlk
eCk7Cj4gLQo+IC0JCWxlbiArPSBtc2dfcHJpbnRfdGV4dChtc2csIHRydWUsIHRpbWUsIE5VTEws
IDApOwo+IC0JCWlkeCA9IGxvZ19uZXh0KGlkeCk7Cj4gLQkJc2VxKys7Cj4gLQl9Cj4gKwlwcmJf
Zm9yX2VhY2hfcmVjb3JkKGNsZWFyX3NlcSwgcHJiLCBzZXEsICZzeXNsb2dfcmVjb3JkKQo+ICsJ
CWxlbiArPSByZWNvcmRfcHJpbnRfdGV4dCgmc3lzbG9nX3JlY29yZCwgdHJ1ZSwgdGltZSwgTlVM
TCwgMCk7Cj4gIAo+ICAJLyogbW92ZSBmaXJzdCByZWNvcmQgZm9yd2FyZCB1bnRpbCBsZW5ndGgg
Zml0cyBpbnRvIHRoZSBidWZmZXIgKi8KPiAtCXNlcSA9IGNsZWFyX3NlcTsKPiAtCWlkeCA9IGNs
ZWFyX2lkeDsKPiAtCXdoaWxlIChsZW4gPiBzaXplICYmIHNlcSA8IGxvZ19uZXh0X3NlcSkgewo+
IC0JCXN0cnVjdCBwcmludGtfbG9nICptc2cgPSBsb2dfZnJvbV9pZHgoaWR4KTsKPiAtCj4gLQkJ
bGVuIC09IG1zZ19wcmludF90ZXh0KG1zZywgdHJ1ZSwgdGltZSwgTlVMTCwgMCk7Cj4gLQkJaWR4
ID0gbG9nX25leHQoaWR4KTsKPiAtCQlzZXErKzsKPiArCXByYl9mb3JfZWFjaF9yZWNvcmQoY2xl
YXJfc2VxLCBwcmIsIHNlcSwgJnN5c2xvZ19yZWNvcmQpIHsKPiArCQlpZiAobGVuIDw9IHNpemUp
Cj4gKwkJCWJyZWFrOwo+ICsJCWxlbiAtPSByZWNvcmRfcHJpbnRfdGV4dCgmc3lzbG9nX3JlY29y
ZCwgdHJ1ZSwgdGltZSwgTlVMTCwgMCk7Cj4gIAl9Cj4gIAo+IC0JLyogbGFzdCBtZXNzYWdlIGZp
dHRpbmcgaW50byB0aGlzIGR1bXAgKi8KPiAtCW5leHRfc2VxID0gbG9nX25leHRfc2VxOwo+IC0K
PiAgCWxlbiA9IDA7Cj4gLQl3aGlsZSAobGVuID49IDAgJiYgc2VxIDwgbmV4dF9zZXEpIHsKPiAt
CQlzdHJ1Y3QgcHJpbnRrX2xvZyAqbXNnID0gbG9nX2Zyb21faWR4KGlkeCk7Cj4gLQkJaW50IHRl
eHRsZW4gPSBtc2dfcHJpbnRfdGV4dChtc2csIHRydWUsIHRpbWUsIHRleHQsCj4gLQkJCQkJICAg
ICBMT0dfTElORV9NQVggKyBQUkVGSVhfTUFYKTsKPiArCXByYl9mb3JfZWFjaF9yZWNvcmQoc2Vx
LCBwcmIsIHNlcSwgJnN5c2xvZ19yZWNvcmQpIHsKPiArCQlpbnQgdGV4dGxlbjsKPiAgCj4gLQkJ
aWR4ID0gbG9nX25leHQoaWR4KTsKPiAtCQlzZXErKzsKPiArCQlpZiAobGVuIDwgMCkKPiArCQkJ
YnJlYWs7Cj4gKwo+ICsJCXRleHRsZW4gPSByZWNvcmRfcHJpbnRfdGV4dCgmc3lzbG9nX3JlY29y
ZCwgdHJ1ZSwgdGltZSwgdGV4dCwKPiArCQkJCQkgICAgTE9HX0xJTkVfTUFYICsgUFJFRklYX01B
WCk7Cj4gKwo+ICsJCWlmIChsZW4gKyB0ZXh0bGVuID4gc2l6ZSkgewo+ICsJCQlzZXEtLTsKPiAr
CQkJYnJlYWs7Cj4gKwkJfQo+ICAKPiAgCQlsb2didWZfdW5sb2NrX2lycSgpOwo+ICAJCWlmIChj
b3B5X3RvX3VzZXIoYnVmICsgbGVuLCB0ZXh0LCB0ZXh0bGVuKSkKPiBAQCAtMTQ3NCwxOCArMTQ4
MCwxMCBAQCBzdGF0aWMgaW50IHN5c2xvZ19wcmludF9hbGwoY2hhciBfX3VzZXIgKmJ1ZiwgaW50
IHNpemUsIGJvb2wgY2xlYXIpCj4gIAkJZWxzZQo+ICAJCQlsZW4gKz0gdGV4dGxlbjsKPiAgCQls
b2didWZfbG9ja19pcnEoKTsKPiAtCj4gLQkJaWYgKHNlcSA8IGxvZ19maXJzdF9zZXEpIHsKPiAt
CQkJLyogbWVzc2FnZXMgYXJlIGdvbmUsIG1vdmUgdG8gbmV4dCBvbmUgKi8KPiAtCQkJc2VxID0g
bG9nX2ZpcnN0X3NlcTsKPiAtCQkJaWR4ID0gbG9nX2ZpcnN0X2lkeDsKPiAtCQl9Cj4gIAl9Cj4g
IAo+IC0JaWYgKGNsZWFyKSB7Cj4gLQkJY2xlYXJfc2VxID0gbG9nX25leHRfc2VxOwo+IC0JCWNs
ZWFyX2lkeCA9IGxvZ19uZXh0X2lkeDsKPiAtCX0KPiArCWlmIChjbGVhcikKPiArCQljbGVhcl9z
ZXEgPSBzZXE7Cj4gIAlsb2didWZfdW5sb2NrX2lycSgpOwo+ICAKPiAgCWtmcmVlKHRleHQpOwo+
IEBAIC0xNDk1LDggKzE0OTMsNyBAQCBzdGF0aWMgaW50IHN5c2xvZ19wcmludF9hbGwoY2hhciBf
X3VzZXIgKmJ1ZiwgaW50IHNpemUsIGJvb2wgY2xlYXIpCj4gIHN0YXRpYyB2b2lkIHN5c2xvZ19j
bGVhcih2b2lkKQo+ICB7Cj4gIAlsb2didWZfbG9ja19pcnEoKTsKPiAtCWNsZWFyX3NlcSA9IGxv
Z19uZXh0X3NlcTsKPiAtCWNsZWFyX2lkeCA9IGxvZ19uZXh0X2lkeDsKPiArCWNsZWFyX3NlcSA9
IHByYl9uZXh0X3NlcShwcmIpOwo+ICAJbG9nYnVmX3VubG9ja19pcnEoKTsKPiAgfQo+ICAKPiBA
QCAtMTUyMyw3ICsxNTIwLDcgQEAgaW50IGRvX3N5c2xvZyhpbnQgdHlwZSwgY2hhciBfX3VzZXIg
KmJ1ZiwgaW50IGxlbiwgaW50IHNvdXJjZSkKPiAgCQlpZiAoIWFjY2Vzc19vayhidWYsIGxlbikp
Cj4gIAkJCXJldHVybiAtRUZBVUxUOwo+ICAJCWVycm9yID0gd2FpdF9ldmVudF9pbnRlcnJ1cHRp
YmxlKGxvZ193YWl0LAo+IC0JCQkJCQkgc3lzbG9nX3NlcSAhPSBsb2dfbmV4dF9zZXEpOwo+ICsJ
CQkJcHJiX3JlYWRfdmFsaWQocHJiLCBzeXNsb2dfc2VxLCBOVUxMKSk7Cj4gIAkJaWYgKGVycm9y
KQo+ICAJCQlyZXR1cm4gZXJyb3I7Cj4gIAkJZXJyb3IgPSBzeXNsb2dfcHJpbnQoYnVmLCBsZW4p
Owo+IEBAIC0xNTcyLDEwICsxNTY5LDkgQEAgaW50IGRvX3N5c2xvZyhpbnQgdHlwZSwgY2hhciBf
X3VzZXIgKmJ1ZiwgaW50IGxlbiwgaW50IHNvdXJjZSkKPiAgCS8qIE51bWJlciBvZiBjaGFycyBp
biB0aGUgbG9nIGJ1ZmZlciAqLwo+ICAJY2FzZSBTWVNMT0dfQUNUSU9OX1NJWkVfVU5SRUFEOgo+
ICAJCWxvZ2J1Zl9sb2NrX2lycSgpOwo+IC0JCWlmIChzeXNsb2dfc2VxIDwgbG9nX2ZpcnN0X3Nl
cSkgewo+ICsJCWlmIChzeXNsb2dfc2VxIDwgcHJiX2ZpcnN0X3NlcShwcmIpKSB7Cj4gIAkJCS8q
IG1lc3NhZ2VzIGFyZSBnb25lLCBtb3ZlIHRvIGZpcnN0IG9uZSAqLwo+IC0JCQlzeXNsb2dfc2Vx
ID0gbG9nX2ZpcnN0X3NlcTsKPiAtCQkJc3lzbG9nX2lkeCA9IGxvZ19maXJzdF9pZHg7Cj4gKwkJ
CXN5c2xvZ19zZXEgPSBwcmJfZmlyc3Rfc2VxKHByYik7Cj4gIAkJCXN5c2xvZ19wYXJ0aWFsID0g
MDsKPiAgCQl9Cj4gIAkJaWYgKHNvdXJjZSA9PSBTWVNMT0dfRlJPTV9QUk9DKSB7Cj4gQEAgLTE1
ODQsMjAgKzE1ODAsMTcgQEAgaW50IGRvX3N5c2xvZyhpbnQgdHlwZSwgY2hhciBfX3VzZXIgKmJ1
ZiwgaW50IGxlbiwgaW50IHNvdXJjZSkKPiAgCQkJICogZm9yIHBlbmRpbmcgZGF0YSwgbm90IHRo
ZSBzaXplOyByZXR1cm4gdGhlIGNvdW50IG9mCj4gIAkJCSAqIHJlY29yZHMsIG5vdCB0aGUgbGVu
Z3RoLgo+ICAJCQkgKi8KPiAtCQkJZXJyb3IgPSBsb2dfbmV4dF9zZXEgLSBzeXNsb2dfc2VxOwo+
ICsJCQllcnJvciA9IHByYl9uZXh0X3NlcShwcmIpIC0gc3lzbG9nX3NlcTsKPiAgCQl9IGVsc2Ug
ewo+IC0JCQl1NjQgc2VxID0gc3lzbG9nX3NlcTsKPiAtCQkJdTMyIGlkeCA9IHN5c2xvZ19pZHg7
Cj4gIAkJCWJvb2wgdGltZSA9IHN5c2xvZ19wYXJ0aWFsID8gc3lzbG9nX3RpbWUgOiBwcmludGtf
dGltZTsKPiArCQkJdTY0IHNlcTsKPiAgCj4gLQkJCXdoaWxlIChzZXEgPCBsb2dfbmV4dF9zZXEp
IHsKPiAtCQkJCXN0cnVjdCBwcmludGtfbG9nICptc2cgPSBsb2dfZnJvbV9pZHgoaWR4KTsKPiAt
Cj4gLQkJCQllcnJvciArPSBtc2dfcHJpbnRfdGV4dChtc2csIHRydWUsIHRpbWUsIE5VTEwsCj4g
LQkJCQkJCQkwKTsKPiArCQkJcHJiX2Zvcl9lYWNoX3JlY29yZChzeXNsb2dfc2VxLCBwcmIsIHNl
cSwKPiArCQkJCQkgICAgJnN5c2xvZ19yZWNvcmQpIHsKPiArCQkJCWVycm9yICs9IHJlY29yZF9w
cmludF90ZXh0KCZzeXNsb2dfcmVjb3JkLAo+ICsJCQkJCQkJICAgdHJ1ZSwgdGltZSwKPiArCQkJ
CQkJCSAgIE5VTEwsIDApOwo+ICAJCQkJdGltZSA9IHByaW50a190aW1lOwo+IC0JCQkJaWR4ID0g
bG9nX25leHQoaWR4KTsKPiAtCQkJCXNlcSsrOwo+ICAJCQl9Cj4gIAkJCWVycm9yIC09IHN5c2xv
Z19wYXJ0aWFsOwo+ICAJCX0KPiBAQCAtMTk1OCw3ICsxOTUxLDYgQEAgYXNtbGlua2FnZSBpbnQg
dnByaW50a19lbWl0KGludCBmYWNpbGl0eSwgaW50IGxldmVsLAo+ICAJaW50IHByaW50ZWRfbGVu
Owo+ICAJYm9vbCBpbl9zY2hlZCA9IGZhbHNlLCBwZW5kaW5nX291dHB1dDsKPiAgCXVuc2lnbmVk
IGxvbmcgZmxhZ3M7Cj4gLQl1NjQgY3Vycl9sb2dfc2VxOwo+ICAKPiAgCS8qIFN1cHByZXNzIHVu
aW1wb3J0YW50IG1lc3NhZ2VzIGFmdGVyIHBhbmljIGhhcHBlbnMgKi8KPiAgCWlmICh1bmxpa2Vs
eShzdXBwcmVzc19wcmludGspKQo+IEBAIC0xOTc0LDkgKzE5NjYsOSBAQCBhc21saW5rYWdlIGlu
dCB2cHJpbnRrX2VtaXQoaW50IGZhY2lsaXR5LCBpbnQgbGV2ZWwsCj4gIAo+ICAJLyogVGhpcyBz
dG9wcyB0aGUgaG9sZGVyIG9mIGNvbnNvbGVfc2VtIGp1c3Qgd2hlcmUgd2Ugd2FudCBoaW0gKi8K
PiAgCWxvZ2J1Zl9sb2NrX2lycXNhdmUoZmxhZ3MpOwo+IC0JY3Vycl9sb2dfc2VxID0gbG9nX25l
eHRfc2VxOwo+ICsJcGVuZGluZ19vdXRwdXQgPSAhcHJiX3JlYWRfdmFsaWQocHJiLCBjb25zb2xl
X3NlcSwgTlVMTCk7Cj4gIAlwcmludGVkX2xlbiA9IHZwcmludGtfc3RvcmUoZmFjaWxpdHksIGxl
dmVsLCBkaWN0LCBkaWN0bGVuLCBmbXQsIGFyZ3MpOwo+IC0JcGVuZGluZ19vdXRwdXQgPSAoY3Vy
cl9sb2dfc2VxICE9IGxvZ19uZXh0X3NlcSk7Cj4gKwlwZW5kaW5nX291dHB1dCAmPSBwcmJfcmVh
ZF92YWxpZChwcmIsIGNvbnNvbGVfc2VxLCBOVUxMKTsKPiAgCWxvZ2J1Zl91bmxvY2tfaXJxcmVz
dG9yZShmbGFncyk7Cj4gIAo+ICAJLyogSWYgY2FsbGVkIGZyb20gdGhlIHNjaGVkdWxlciwgd2Ug
Y2FuIG5vdCBjYWxsIHVwKCkuICovCj4gQEAgLTIwNjYsMjEgKzIwNTgsMzAgQEAgRVhQT1JUX1NZ
TUJPTChwcmludGspOwo+ICAjZGVmaW5lIFBSRUZJWF9NQVgJCTAKPiAgI2RlZmluZSBwcmludGtf
dGltZQkJZmFsc2UKPiAgCj4gKyNkZWZpbmUgcHJiX3JlYWRfdmFsaWQocmIsIHNlcSwgcikJZmFs
c2UKPiArI2RlZmluZSBwcmJfZmlyc3Rfc2VxKHJiKQkJMAo+ICsKPiAgc3RhdGljIHU2NCBzeXNs
b2dfc2VxOwo+IC1zdGF0aWMgdTMyIHN5c2xvZ19pZHg7Cj4gIHN0YXRpYyB1NjQgY29uc29sZV9z
ZXE7Cj4gLXN0YXRpYyB1MzIgY29uc29sZV9pZHg7Cj4gIHN0YXRpYyB1NjQgZXhjbHVzaXZlX2Nv
bnNvbGVfc3RvcF9zZXE7Cj4gLXN0YXRpYyB1NjQgbG9nX2ZpcnN0X3NlcTsKPiAtc3RhdGljIHUz
MiBsb2dfZmlyc3RfaWR4Owo+IC1zdGF0aWMgdTY0IGxvZ19uZXh0X3NlcTsKPiAtc3RhdGljIGNo
YXIgKmxvZ190ZXh0KGNvbnN0IHN0cnVjdCBwcmludGtfbG9nICptc2cpIHsgcmV0dXJuIE5VTEw7
IH0KPiAtc3RhdGljIGNoYXIgKmxvZ19kaWN0KGNvbnN0IHN0cnVjdCBwcmludGtfbG9nICptc2cp
IHsgcmV0dXJuIE5VTEw7IH0KPiAtc3RhdGljIHN0cnVjdCBwcmludGtfbG9nICpsb2dfZnJvbV9p
ZHgodTMyIGlkeCkgeyByZXR1cm4gTlVMTDsgfQo+IC1zdGF0aWMgdTMyIGxvZ19uZXh0KHUzMiBp
ZHgpIHsgcmV0dXJuIDA7IH0KPiAtc3RhdGljIHNzaXplX3QgbXNnX3ByaW50X2V4dF9oZWFkZXIo
Y2hhciAqYnVmLCBzaXplX3Qgc2l6ZSwKPiAtCQkJCSAgICBzdHJ1Y3QgcHJpbnRrX2xvZyAqbXNn
LAo+IC0JCQkJICAgIHU2NCBzZXEpIHsgcmV0dXJuIDA7IH0KPiArc3RydWN0IHByaW50a19yZWNv
cmQgY29uc29sZV9yZWNvcmQ7Cj4gKwo+ICtzdGF0aWMgc2l6ZV90IHJlY29yZF9wcmludF90ZXh0
KGNvbnN0IHN0cnVjdCBwcmludGtfcmVjb3JkICpyLCBib29sIHN5c2xvZywKPiArCQkJCWJvb2wg
dGltZSwgY2hhciAqYnVmLAo+ICsJCQkJc2l6ZV90IHNpemUpCj4gK3sKPiArCXJldHVybiAwOwo+
ICt9Cj4gK3N0YXRpYyBzaXplX3QgcmVjb3JkX3ByaW50X3RleHRfaW5saW5lKGNvbnN0IHN0cnVj
dCBwcmludGtfcmVjb3JkICpyLAo+ICsJCQkJICAgICAgIGJvb2wgc3lzbG9nLCBib29sIHRpbWUp
Cj4gK3sKPiArCXJldHVybiAwOwo+ICt9Cj4gK3N0YXRpYyBzc2l6ZV90IGluZm9fcHJpbnRfZXh0
X2hlYWRlcihjaGFyICpidWYsIHNpemVfdCBzaXplLAo+ICsJCQkJICAgICBzdHJ1Y3QgcHJpbnRr
X2luZm8gKmluZm8pCj4gK3sKPiArCXJldHVybiAwOwo+ICt9Cj4gIHN0YXRpYyBzc2l6ZV90IG1z
Z19wcmludF9leHRfYm9keShjaGFyICpidWYsIHNpemVfdCBzaXplLAo+ICAJCQkJICBjaGFyICpk
aWN0LCBzaXplX3QgZGljdF9sZW4sCj4gIAkJCQkgIGNoYXIgKnRleHQsIHNpemVfdCB0ZXh0X2xl
bikgeyByZXR1cm4gMDsgfQo+IEBAIC0yMDg4LDggKzIwODksNiBAQCBzdGF0aWMgdm9pZCBjb25z
b2xlX2xvY2tfc3Bpbm5pbmdfZW5hYmxlKHZvaWQpIHsgfQo+ICBzdGF0aWMgaW50IGNvbnNvbGVf
bG9ja19zcGlubmluZ19kaXNhYmxlX2FuZF9jaGVjayh2b2lkKSB7IHJldHVybiAwOyB9Cj4gIHN0
YXRpYyB2b2lkIGNhbGxfY29uc29sZV9kcml2ZXJzKGNvbnN0IGNoYXIgKmV4dF90ZXh0LCBzaXpl
X3QgZXh0X2xlbiwKPiAgCQkJCSBjb25zdCBjaGFyICp0ZXh0LCBzaXplX3QgbGVuKSB7fQo+IC1z
dGF0aWMgc2l6ZV90IG1zZ19wcmludF90ZXh0KGNvbnN0IHN0cnVjdCBwcmludGtfbG9nICptc2cs
IGJvb2wgc3lzbG9nLAo+IC0JCQkgICAgIGJvb2wgdGltZSwgY2hhciAqYnVmLCBzaXplX3Qgc2l6
ZSkgeyByZXR1cm4gMDsgfQo+ICBzdGF0aWMgYm9vbCBzdXBwcmVzc19tZXNzYWdlX3ByaW50aW5n
KGludCBsZXZlbCkgeyByZXR1cm4gZmFsc2U7IH0KPiAgCj4gICNlbmRpZiAvKiBDT05GSUdfUFJJ
TlRLICovCj4gQEAgLTI0MDYsMzUgKzI0MDUsMjggQEAgdm9pZCBjb25zb2xlX3VubG9jayh2b2lk
KQo+ICAJfQo+ICAKPiAgCWZvciAoOzspIHsKPiAtCQlzdHJ1Y3QgcHJpbnRrX2xvZyAqbXNnOwo+
ICAJCXNpemVfdCBleHRfbGVuID0gMDsKPiAtCQlzaXplX3QgbGVuOwo+ICsJCXNpemVfdCBsZW4g
PSAwOwo+ICAKPiAgCQlwcmludGtfc2FmZV9lbnRlcl9pcnFzYXZlKGZsYWdzKTsKPiAgCQlyYXdf
c3Bpbl9sb2NrKCZsb2didWZfbG9jayk7Cj4gLQkJaWYgKGNvbnNvbGVfc2VxIDwgbG9nX2ZpcnN0
X3NlcSkgewo+ICtza2lwOgo+ICsJCWlmICghcHJiX3JlYWRfdmFsaWQocHJiLCBjb25zb2xlX3Nl
cSwgJmNvbnNvbGVfcmVjb3JkKSkKPiArCQkJYnJlYWs7Cj4gKwo+ICsJCWlmIChjb25zb2xlX3Nl
cSA8IGNvbnNvbGVfcmVjb3JkLmluZm8tPnNlcSkgewo+ICAJCQlsZW4gPSBzcHJpbnRmKHRleHQs
Cj4gIAkJCQkgICAgICAiKiogJWxsdSBwcmludGsgbWVzc2FnZXMgZHJvcHBlZCAqKlxuIiwKPiAt
CQkJCSAgICAgIGxvZ19maXJzdF9zZXEgLSBjb25zb2xlX3NlcSk7Cj4gLQo+IC0JCQkvKiBtZXNz
YWdlcyBhcmUgZ29uZSwgbW92ZSB0byBmaXJzdCBvbmUgKi8KPiAtCQkJY29uc29sZV9zZXEgPSBs
b2dfZmlyc3Rfc2VxOwo+IC0JCQljb25zb2xlX2lkeCA9IGxvZ19maXJzdF9pZHg7Cj4gLQkJfSBl
bHNlIHsKPiAtCQkJbGVuID0gMDsKPiArCQkJCSAgICAgIGNvbnNvbGVfcmVjb3JkLmluZm8tPnNl
cSAtIGNvbnNvbGVfc2VxKTsKPiAgCQl9Cj4gLXNraXA6Cj4gLQkJaWYgKGNvbnNvbGVfc2VxID09
IGxvZ19uZXh0X3NlcSkKPiAtCQkJYnJlYWs7Cj4gKwkJY29uc29sZV9zZXEgPSBjb25zb2xlX3Jl
Y29yZC5pbmZvLT5zZXE7Cj4gIAo+IC0JCW1zZyA9IGxvZ19mcm9tX2lkeChjb25zb2xlX2lkeCk7
Cj4gLQkJaWYgKHN1cHByZXNzX21lc3NhZ2VfcHJpbnRpbmcobXNnLT5sZXZlbCkpIHsKPiArCQlp
ZiAoc3VwcHJlc3NfbWVzc2FnZV9wcmludGluZyhjb25zb2xlX3JlY29yZC5pbmZvLT5sZXZlbCkp
IHsKPiAgCQkJLyoKPiAgCQkJICogU2tpcCByZWNvcmQgd2UgaGF2ZSBidWZmZXJlZCBhbmQgYWxy
ZWFkeSBwcmludGVkCj4gIAkJCSAqIGRpcmVjdGx5IHRvIHRoZSBjb25zb2xlIHdoZW4gd2UgcmVj
ZWl2ZWQgaXQsIGFuZAo+ICAJCQkgKiByZWNvcmQgdGhhdCBoYXMgbGV2ZWwgYWJvdmUgdGhlIGNv
bnNvbGUgbG9nbGV2ZWwuCj4gIAkJCSAqLwo+IC0JCQljb25zb2xlX2lkeCA9IGxvZ19uZXh0KGNv
bnNvbGVfaWR4KTsKPiAgCQkJY29uc29sZV9zZXErKzsKPiAgCQkJZ290byBza2lwOwo+ICAJCX0K
PiBAQCAtMjQ0NSwxOSArMjQzNywyMCBAQCB2b2lkIGNvbnNvbGVfdW5sb2NrKHZvaWQpCj4gIAkJ
CWV4Y2x1c2l2ZV9jb25zb2xlID0gTlVMTDsKPiAgCQl9Cj4gIAo+IC0JCWxlbiArPSBtc2dfcHJp
bnRfdGV4dChtc2csCj4gKwkJbGVuICs9IHJlY29yZF9wcmludF90ZXh0KCZjb25zb2xlX3JlY29y
ZCwKPiAgCQkJCWNvbnNvbGVfbXNnX2Zvcm1hdCAmIE1TR19GT1JNQVRfU1lTTE9HLAo+ICAJCQkJ
cHJpbnRrX3RpbWUsIHRleHQgKyBsZW4sIHNpemVvZih0ZXh0KSAtIGxlbik7Cj4gIAkJaWYgKG5y
X2V4dF9jb25zb2xlX2RyaXZlcnMpIHsKPiAtCQkJZXh0X2xlbiA9IG1zZ19wcmludF9leHRfaGVh
ZGVyKGV4dF90ZXh0LAo+ICsJCQlleHRfbGVuID0gaW5mb19wcmludF9leHRfaGVhZGVyKGV4dF90
ZXh0LAo+ICAJCQkJCQlzaXplb2YoZXh0X3RleHQpLAo+IC0JCQkJCQltc2csIGNvbnNvbGVfc2Vx
KTsKPiArCQkJCQkJY29uc29sZV9yZWNvcmQuaW5mbyk7Cj4gIAkJCWV4dF9sZW4gKz0gbXNnX3By
aW50X2V4dF9ib2R5KGV4dF90ZXh0ICsgZXh0X2xlbiwKPiAgCQkJCQkJc2l6ZW9mKGV4dF90ZXh0
KSAtIGV4dF9sZW4sCj4gLQkJCQkJCWxvZ19kaWN0KG1zZyksIG1zZy0+ZGljdF9sZW4sCj4gLQkJ
CQkJCWxvZ190ZXh0KG1zZyksIG1zZy0+dGV4dF9sZW4pOwo+ICsJCQkJCQkmY29uc29sZV9yZWNv
cmQuZGljdF9idWZbMF0sCj4gKwkJCQkJCWNvbnNvbGVfcmVjb3JkLmluZm8tPmRpY3RfbGVuLAo+
ICsJCQkJCQkmY29uc29sZV9yZWNvcmQudGV4dF9idWZbMF0sCj4gKwkJCQkJCWNvbnNvbGVfcmVj
b3JkLmluZm8tPnRleHRfbGVuKTsKPiAgCQl9Cj4gLQkJY29uc29sZV9pZHggPSBsb2dfbmV4dChj
b25zb2xlX2lkeCk7Cj4gIAkJY29uc29sZV9zZXErKzsKPiAgCQlyYXdfc3Bpbl91bmxvY2soJmxv
Z2J1Zl9sb2NrKTsKPiAgCj4gQEAgLTI0OTcsNyArMjQ5MCw3IEBAIHZvaWQgY29uc29sZV91bmxv
Y2sodm9pZCkKPiAgCSAqIGZsdXNoLCBubyB3b3JyaWVzLgo+ICAJICovCj4gIAlyYXdfc3Bpbl9s
b2NrKCZsb2didWZfbG9jayk7Cj4gLQlyZXRyeSA9IGNvbnNvbGVfc2VxICE9IGxvZ19uZXh0X3Nl
cTsKPiArCXJldHJ5ID0gcHJiX3JlYWRfdmFsaWQocHJiLCBjb25zb2xlX3NlcSwgTlVMTCk7Cj4g
IAlyYXdfc3Bpbl91bmxvY2soJmxvZ2J1Zl9sb2NrKTsKPiAgCXByaW50a19zYWZlX2V4aXRfaXJx
cmVzdG9yZShmbGFncyk7Cj4gIAo+IEBAIC0yNTY2LDggKzI1NTksNyBAQCB2b2lkIGNvbnNvbGVf
Zmx1c2hfb25fcGFuaWMoZW51bSBjb25fZmx1c2hfbW9kZSBtb2RlKQo+ICAJCXVuc2lnbmVkIGxv
bmcgZmxhZ3M7Cj4gIAo+ICAJCWxvZ2J1Zl9sb2NrX2lycXNhdmUoZmxhZ3MpOwo+IC0JCWNvbnNv
bGVfc2VxID0gbG9nX2ZpcnN0X3NlcTsKPiAtCQljb25zb2xlX2lkeCA9IGxvZ19maXJzdF9pZHg7
Cj4gKwkJY29uc29sZV9zZXEgPSBwcmJfZmlyc3Rfc2VxKHByYik7Cj4gIAkJbG9nYnVmX3VubG9j
a19pcnFyZXN0b3JlKGZsYWdzKTsKPiAgCX0KPiAgCWNvbnNvbGVfdW5sb2NrKCk7Cj4gQEAgLTI3
NzAsOCArMjc2Miw2IEBAIHZvaWQgcmVnaXN0ZXJfY29uc29sZShzdHJ1Y3QgY29uc29sZSAqbmV3
Y29uKQo+ICAJCSAqIGZvciB1cy4KPiAgCQkgKi8KPiAgCQlsb2didWZfbG9ja19pcnFzYXZlKGZs
YWdzKTsKPiAtCQljb25zb2xlX3NlcSA9IHN5c2xvZ19zZXE7Cj4gLQkJY29uc29sZV9pZHggPSBz
eXNsb2dfaWR4Owo+ICAJCS8qCj4gIAkJICogV2UncmUgYWJvdXQgdG8gcmVwbGF5IHRoZSBsb2cg
YnVmZmVyLiAgT25seSBkbyB0aGlzIHRvIHRoZQo+ICAJCSAqIGp1c3QtcmVnaXN0ZXJlZCBjb25z
b2xlIHRvIGF2b2lkIGV4Y2Vzc2l2ZSBtZXNzYWdlIHNwYW0gdG8KPiBAQCAtMjc4Myw2ICsyNzcz
LDcgQEAgdm9pZCByZWdpc3Rlcl9jb25zb2xlKHN0cnVjdCBjb25zb2xlICpuZXdjb24pCj4gIAkJ
ICovCj4gIAkJZXhjbHVzaXZlX2NvbnNvbGUgPSBuZXdjb247Cj4gIAkJZXhjbHVzaXZlX2NvbnNv
bGVfc3RvcF9zZXEgPSBjb25zb2xlX3NlcTsKPiArCQljb25zb2xlX3NlcSA9IHN5c2xvZ19zZXE7
Cj4gIAkJbG9nYnVmX3VubG9ja19pcnFyZXN0b3JlKGZsYWdzKTsKPiAgCX0KPiAgCWNvbnNvbGVf
dW5sb2NrKCk7Cj4gQEAgLTMxMjcsOSArMzExOCw3IEBAIHZvaWQga21zZ19kdW1wKGVudW0ga21z
Z19kdW1wX3JlYXNvbiByZWFzb24pCj4gIAo+ICAJCWxvZ2J1Zl9sb2NrX2lycXNhdmUoZmxhZ3Mp
Owo+ICAJCWR1bXBlci0+Y3VyX3NlcSA9IGNsZWFyX3NlcTsKPiAtCQlkdW1wZXItPmN1cl9pZHgg
PSBjbGVhcl9pZHg7Cj4gLQkJZHVtcGVyLT5uZXh0X3NlcSA9IGxvZ19uZXh0X3NlcTsKPiAtCQlk
dW1wZXItPm5leHRfaWR4ID0gbG9nX25leHRfaWR4Owo+ICsJCWR1bXBlci0+bmV4dF9zZXEgPSBw
cmJfbmV4dF9zZXEocHJiKTsKPiAgCQlsb2didWZfdW5sb2NrX2lycXJlc3RvcmUoZmxhZ3MpOwo+
ICAKPiAgCQkvKiBpbnZva2UgZHVtcGVyIHdoaWNoIHdpbGwgaXRlcmF0ZSBvdmVyIHJlY29yZHMg
Ki8KPiBAQCAtMzE2MywyOCArMzE1MiwyOSBAQCB2b2lkIGttc2dfZHVtcChlbnVtIGttc2dfZHVt
cF9yZWFzb24gcmVhc29uKQo+ICBib29sIGttc2dfZHVtcF9nZXRfbGluZV9ub2xvY2soc3RydWN0
IGttc2dfZHVtcGVyICpkdW1wZXIsIGJvb2wgc3lzbG9nLAo+ICAJCQkgICAgICAgY2hhciAqbGlu
ZSwgc2l6ZV90IHNpemUsIHNpemVfdCAqbGVuKQo+ICB7Cj4gLQlzdHJ1Y3QgcHJpbnRrX2xvZyAq
bXNnOwo+ICsJc3RydWN0IHByaW50a19pbmZvIGluZm87Cj4gKwlzdHJ1Y3QgcHJpbnRrX3JlY29y
ZCByID0gewo+ICsJCS5pbmZvID0gJmluZm8sCj4gKwkJLnRleHRfYnVmID0gbGluZSwKPiArCQku
dGV4dF9idWZfc2l6ZSA9IHNpemUsCj4gKwl9Owo+ICsJdW5zaWduZWQgaW50IGxpbmVfY291bnQ7
Cj4gIAlzaXplX3QgbCA9IDA7Cj4gIAlib29sIHJldCA9IGZhbHNlOwo+ICAKPiAgCWlmICghZHVt
cGVyLT5hY3RpdmUpCj4gIAkJZ290byBvdXQ7Cj4gIAo+IC0JaWYgKGR1bXBlci0+Y3VyX3NlcSA8
IGxvZ19maXJzdF9zZXEpIHsKPiAtCQkvKiBtZXNzYWdlcyBhcmUgZ29uZSwgbW92ZSB0byBmaXJz
dCBhdmFpbGFibGUgb25lICovCj4gLQkJZHVtcGVyLT5jdXJfc2VxID0gbG9nX2ZpcnN0X3NlcTsK
PiAtCQlkdW1wZXItPmN1cl9pZHggPSBsb2dfZmlyc3RfaWR4Owo+IC0JfQo+ICsJLyogQ291bnQg
dGV4dCBsaW5lcyBpbnN0ZWFkIG9mIHJlYWRpbmcgdGV4dD8gKi8KPiArCWlmICghbGluZSkKPiAr
CQlyLnRleHRfbGluZV9jb3VudCA9ICZsaW5lX2NvdW50Owo+ICAKPiAtCS8qIGxhc3QgZW50cnkg
Ki8KPiAtCWlmIChkdW1wZXItPmN1cl9zZXEgPj0gbG9nX25leHRfc2VxKQo+ICsJaWYgKCFwcmJf
cmVhZF92YWxpZChwcmIsIGR1bXBlci0+Y3VyX3NlcSwgJnIpKQo+ICAJCWdvdG8gb3V0Owo+ICAK
PiAtCW1zZyA9IGxvZ19mcm9tX2lkeChkdW1wZXItPmN1cl9pZHgpOwo+IC0JbCA9IG1zZ19wcmlu
dF90ZXh0KG1zZywgc3lzbG9nLCBwcmludGtfdGltZSwgbGluZSwgc2l6ZSk7Cj4gKwlsID0gcmVj
b3JkX3ByaW50X3RleHRfaW5saW5lKCZyLCBzeXNsb2csIHByaW50a190aW1lKTsKPiAgCj4gLQlk
dW1wZXItPmN1cl9pZHggPSBsb2dfbmV4dChkdW1wZXItPmN1cl9pZHgpOwo+IC0JZHVtcGVyLT5j
dXJfc2VxKys7Cj4gKwlkdW1wZXItPmN1cl9zZXEgPSByLmluZm8tPnNlcSArIDE7Cj4gIAlyZXQg
PSB0cnVlOwo+ICBvdXQ6Cj4gIAlpZiAobGVuKQo+IEBAIC0zMjQ1LDIzICszMjM1LDI3IEBAIEVY
UE9SVF9TWU1CT0xfR1BMKGttc2dfZHVtcF9nZXRfbGluZSk7Cj4gIGJvb2wga21zZ19kdW1wX2dl
dF9idWZmZXIoc3RydWN0IGttc2dfZHVtcGVyICpkdW1wZXIsIGJvb2wgc3lzbG9nLAo+ICAJCQkg
IGNoYXIgKmJ1Ziwgc2l6ZV90IHNpemUsIHNpemVfdCAqbGVuKQo+ICB7Cj4gKwlzdHJ1Y3QgcHJp
bnRrX2luZm8gaW5mbzsKPiArCXVuc2lnbmVkIGludCBsaW5lX2NvdW50Owo+ICsJLyogaW5pdGlh
bGx5LCBvbmx5IGNvdW50IHRleHQgbGluZXMgKi8KPiArCXN0cnVjdCBwcmludGtfcmVjb3JkIHIg
PSB7Cj4gKwkJLmluZm8gPSAmaW5mbywKPiArCQkudGV4dF9saW5lX2NvdW50ID0gJmxpbmVfY291
bnQsCj4gKwl9Owo+ICAJdW5zaWduZWQgbG9uZyBmbGFnczsKPiAgCXU2NCBzZXE7Cj4gLQl1MzIg
aWR4Owo+ICAJdTY0IG5leHRfc2VxOwo+IC0JdTMyIG5leHRfaWR4Owo+ICAJc2l6ZV90IGwgPSAw
Owo+ICAJYm9vbCByZXQgPSBmYWxzZTsKPiAgCWJvb2wgdGltZSA9IHByaW50a190aW1lOwo+ICAK
PiAtCWlmICghZHVtcGVyLT5hY3RpdmUpCj4gKwlpZiAoIWR1bXBlci0+YWN0aXZlIHx8ICFidWYg
fHwgIXNpemUpCj4gIAkJZ290byBvdXQ7Cj4gIAo+ICAJbG9nYnVmX2xvY2tfaXJxc2F2ZShmbGFn
cyk7Cj4gLQlpZiAoZHVtcGVyLT5jdXJfc2VxIDwgbG9nX2ZpcnN0X3NlcSkgewo+ICsJaWYgKGR1
bXBlci0+Y3VyX3NlcSA8IHByYl9maXJzdF9zZXEocHJiKSkgewo+ICAJCS8qIG1lc3NhZ2VzIGFy
ZSBnb25lLCBtb3ZlIHRvIGZpcnN0IGF2YWlsYWJsZSBvbmUgKi8KPiAtCQlkdW1wZXItPmN1cl9z
ZXEgPSBsb2dfZmlyc3Rfc2VxOwo+IC0JCWR1bXBlci0+Y3VyX2lkeCA9IGxvZ19maXJzdF9pZHg7
Cj4gKwkJZHVtcGVyLT5jdXJfc2VxID0gcHJiX2ZpcnN0X3NlcShwcmIpOwo+ICAJfQo+ICAKPiAg
CS8qIGxhc3QgZW50cnkgKi8KPiBAQCAtMzI3Miw0MSArMzI2Niw0MyBAQCBib29sIGttc2dfZHVt
cF9nZXRfYnVmZmVyKHN0cnVjdCBrbXNnX2R1bXBlciAqZHVtcGVyLCBib29sIHN5c2xvZywKPiAg
Cj4gIAkvKiBjYWxjdWxhdGUgbGVuZ3RoIG9mIGVudGlyZSBidWZmZXIgKi8KPiAgCXNlcSA9IGR1
bXBlci0+Y3VyX3NlcTsKPiAtCWlkeCA9IGR1bXBlci0+Y3VyX2lkeDsKPiAtCXdoaWxlIChzZXEg
PCBkdW1wZXItPm5leHRfc2VxKSB7Cj4gLQkJc3RydWN0IHByaW50a19sb2cgKm1zZyA9IGxvZ19m
cm9tX2lkeChpZHgpOwo+IC0KPiAtCQlsICs9IG1zZ19wcmludF90ZXh0KG1zZywgdHJ1ZSwgdGlt
ZSwgTlVMTCwgMCk7Cj4gLQkJaWR4ID0gbG9nX25leHQoaWR4KTsKPiAtCQlzZXErKzsKPiArCXdo
aWxlIChwcmJfcmVhZF92YWxpZChwcmIsIHNlcSwgJnIpKSB7Cj4gKwkJaWYgKHIuaW5mby0+c2Vx
ID49IGR1bXBlci0+bmV4dF9zZXEpCj4gKwkJCWJyZWFrOwo+ICsJCWwgKz0gcmVjb3JkX3ByaW50
X3RleHRfaW5saW5lKCZyLCB0cnVlLCB0aW1lKTsKPiArCQlzZXEgPSByLmluZm8tPnNlcSArIDE7
Cj4gIAl9Cj4gIAo+ICAJLyogbW92ZSBmaXJzdCByZWNvcmQgZm9yd2FyZCB1bnRpbCBsZW5ndGgg
Zml0cyBpbnRvIHRoZSBidWZmZXIgKi8KPiAgCXNlcSA9IGR1bXBlci0+Y3VyX3NlcTsKPiAtCWlk
eCA9IGR1bXBlci0+Y3VyX2lkeDsKPiAtCXdoaWxlIChsID49IHNpemUgJiYgc2VxIDwgZHVtcGVy
LT5uZXh0X3NlcSkgewo+IC0JCXN0cnVjdCBwcmludGtfbG9nICptc2cgPSBsb2dfZnJvbV9pZHgo
aWR4KTsKPiAtCj4gLQkJbCAtPSBtc2dfcHJpbnRfdGV4dChtc2csIHRydWUsIHRpbWUsIE5VTEws
IDApOwo+IC0JCWlkeCA9IGxvZ19uZXh0KGlkeCk7Cj4gLQkJc2VxKys7Cj4gKwl3aGlsZSAobCA+
PSBzaXplICYmIHByYl9yZWFkX3ZhbGlkKHByYiwgc2VxLCAmcikpIHsKPiArCQlpZiAoci5pbmZv
LT5zZXEgPj0gZHVtcGVyLT5uZXh0X3NlcSkKPiArCQkJYnJlYWs7Cj4gKwkJbCAtPSByZWNvcmRf
cHJpbnRfdGV4dF9pbmxpbmUoJnIsIHRydWUsIHRpbWUpOwo+ICsJCXNlcSA9IHIuaW5mby0+c2Vx
ICsgMTsKPiAgCX0KPiAgCj4gIAkvKiBsYXN0IG1lc3NhZ2UgaW4gbmV4dCBpbnRlcmF0aW9uICov
Cj4gIAluZXh0X3NlcSA9IHNlcTsKPiAtCW5leHRfaWR4ID0gaWR4Owo+ICsKPiArCS8qIGFjdHVh
bGx5IHJlYWQgZGF0YSBpbnRvIHRoZSBidWZmZXIgbm93ICovCj4gKwlyLnRleHRfYnVmID0gYnVm
Owo+ICsJci50ZXh0X2J1Zl9zaXplID0gc2l6ZTsKPiArCXIudGV4dF9saW5lX2NvdW50ID0gTlVM
TDsKPiAgCj4gIAlsID0gMDsKPiAtCXdoaWxlIChzZXEgPCBkdW1wZXItPm5leHRfc2VxKSB7Cj4g
LQkJc3RydWN0IHByaW50a19sb2cgKm1zZyA9IGxvZ19mcm9tX2lkeChpZHgpOwo+ICsJd2hpbGUg
KHByYl9yZWFkX3ZhbGlkKHByYiwgc2VxLCAmcikpIHsKPiArCQlpZiAoci5pbmZvLT5zZXEgPj0g
ZHVtcGVyLT5uZXh0X3NlcSkKPiArCQkJYnJlYWs7Cj4gKwo+ICsJCWwgKz0gcmVjb3JkX3ByaW50
X3RleHRfaW5saW5lKCZyLCBzeXNsb2csIHRpbWUpOwo+ICsJCXIudGV4dF9idWYgPSBidWYgKyBs
Owo+ICsJCXIudGV4dF9idWZfc2l6ZSA9IHNpemUgLSBsOwo+ICAKPiAtCQlsICs9IG1zZ19wcmlu
dF90ZXh0KG1zZywgc3lzbG9nLCB0aW1lLCBidWYgKyBsLCBzaXplIC0gbCk7Cj4gLQkJaWR4ID0g
bG9nX25leHQoaWR4KTsKPiAtCQlzZXErKzsKPiArCQlzZXEgPSByLmluZm8tPnNlcSArIDE7Cj4g
IAl9Cj4gIAo+ICAJZHVtcGVyLT5uZXh0X3NlcSA9IG5leHRfc2VxOwo+IC0JZHVtcGVyLT5uZXh0
X2lkeCA9IG5leHRfaWR4Owo+ICAJcmV0ID0gdHJ1ZTsKPiAgCWxvZ2J1Zl91bmxvY2tfaXJxcmVz
dG9yZShmbGFncyk7Cj4gIG91dDoKPiBAQCAtMzMyOSw5ICszMzI1LDcgQEAgRVhQT1JUX1NZTUJP
TF9HUEwoa21zZ19kdW1wX2dldF9idWZmZXIpOwo+ICB2b2lkIGttc2dfZHVtcF9yZXdpbmRfbm9s
b2NrKHN0cnVjdCBrbXNnX2R1bXBlciAqZHVtcGVyKQo+ICB7Cj4gIAlkdW1wZXItPmN1cl9zZXEg
PSBjbGVhcl9zZXE7Cj4gLQlkdW1wZXItPmN1cl9pZHggPSBjbGVhcl9pZHg7Cj4gLQlkdW1wZXIt
Pm5leHRfc2VxID0gbG9nX25leHRfc2VxOwo+IC0JZHVtcGVyLT5uZXh0X2lkeCA9IGxvZ19uZXh0
X2lkeDsKPiArCWR1bXBlci0+bmV4dF9zZXEgPSBwcmJfbmV4dF9zZXEocHJiKTsKPiAgfQo+ICAK
PiAgLyoqCj4gCgoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X18Ka2V4ZWMgbWFpbGluZyBsaXN0CmtleGVjQGxpc3RzLmluZnJhZGVhZC5vcmcKaHR0cDovL2xp
c3RzLmluZnJhZGVhZC5vcmcvbWFpbG1hbi9saXN0aW5mby9rZXhlYwo=
