Return-Path: <kexec-bounces+lists+kexec=lfdr.de@lists.infradead.org>
X-Original-To: lists+kexec@lfdr.de
Delivered-To: lists+kexec@lfdr.de
Received: from bombadil.infradead.org (bombadil.infradead.org [IPv6:2607:7c80:54:e::133])
	by mail.lfdr.de (Postfix) with ESMTPS id 729D961CCA
	for <lists+kexec@lfdr.de>; Mon,  8 Jul 2019 12:13:49 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed;
	d=lists.infradead.org; s=bombadil.20170209; h=Sender:Content-Type:
	Content-Transfer-Encoding:Cc:List-Subscribe:List-Help:List-Post:List-Archive:
	List-Unsubscribe:List-Id:In-Reply-To:MIME-Version:Date:Message-ID:From:
	References:To:Subject:Reply-To:Content-ID:Content-Description:Resent-Date:
	Resent-From:Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:List-Owner;
	 bh=kgc/C7sJgMuTasZLlW90trAfjtrXjR4HVZnmH62ekPQ=; b=t67FSzEJApSo4dlMU4+MQwxBj
	ShJCmLGJYJLjp1MGyzu+t03t494wvLBdB74Mnu7AQYn34IVmvvxOQk8V1HrbeKYB9z4BF9O1YfNVm
	54pEOxzl6kcbRyZ9ak8l04HarLmf3MfUwOUgshkaPXpQIvBM5jD7siKo4zJ2dFBb9d/R2Cb+wFe3v
	7Y4hN1SJkaDUMdRONcP3NO38jp/+mgHTxz5ybDc5hU1b55xg6pBnBwZdTS8C2Ahs0W1JNzyAUaWB/
	UINfQuL0lODtU7XDUBnyIHRba6YtSrtjXJEShyd/P15nbXi1Bt+DqoW7si8T4hAWiK+bXzT//lsgf
	i3p55U9PQ==;
Received: from localhost ([127.0.0.1] helo=bombadil.infradead.org)
	by bombadil.infradead.org with esmtp (Exim 4.92 #3 (Red Hat Linux))
	id 1hkQeS-0008Jm-Tc; Mon, 08 Jul 2019 10:13:41 +0000
Received: from pegase1.c-s.fr ([93.17.236.30])
 by bombadil.infradead.org with esmtps (Exim 4.92 #3 (Red Hat Linux))
 id 1hkQdX-0007gX-KF
 for kexec@lists.infradead.org; Mon, 08 Jul 2019 10:12:49 +0000
Received: from localhost (mailhub1-int [192.168.12.234])
 by localhost (Postfix) with ESMTP id 45j1Tx1QNtz9tyfQ;
 Mon,  8 Jul 2019 12:12:37 +0200 (CEST)
Authentication-Results: localhost; dkim=pass
 reason="1024-bit key; insecure key"
 header.d=c-s.fr header.i=@c-s.fr header.b=btJn8zuB; dkim-adsp=pass;
 dkim-atps=neutral
X-Virus-Scanned: Debian amavisd-new at c-s.fr
Received: from pegase1.c-s.fr ([192.168.12.234])
 by localhost (pegase1.c-s.fr [192.168.12.234]) (amavisd-new, port 10024)
 with ESMTP id Y1_KcXBwghpP; Mon,  8 Jul 2019 12:12:37 +0200 (CEST)
Received: from messagerie.si.c-s.fr (messagerie.si.c-s.fr [192.168.25.192])
 by pegase1.c-s.fr (Postfix) with ESMTP id 45j1Tx02cqz9tyfM;
 Mon,  8 Jul 2019 12:12:37 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=c-s.fr; s=mail;
 t=1562580757; bh=qSKmKHjun4qbOuItLf4AdPoVO0ECB9qzFCnJdQrm4n0=;
 h=Subject:To:Cc:References:From:Date:In-Reply-To:From;
 b=btJn8zuBSPYUdWrE501v7mj8uZqOtCSF3bu6K43wZ3fGPODqu5Fa2VddZgbWu8hAi
 LISZx1AN8F1nJrGd+YriruJRH0NgoYa6rvOL45Sp/ttY0s3LA7PpXfkITHZ/A9wvx+
 i/376LvGV5DlRNClXXNoFu5dG3dwUXuOBOY5xwXc=
Received: from localhost (localhost [127.0.0.1])
 by messagerie.si.c-s.fr (Postfix) with ESMTP id 988FE8B79B;
 Mon,  8 Jul 2019 12:12:41 +0200 (CEST)
X-Virus-Scanned: amavisd-new at c-s.fr
Received: from messagerie.si.c-s.fr ([127.0.0.1])
 by localhost (messagerie.si.c-s.fr [127.0.0.1]) (amavisd-new, port 10023)
 with ESMTP id Q73DoBKY15xx; Mon,  8 Jul 2019 12:12:41 +0200 (CEST)
Received: from [172.25.230.102] (po15451.idsi0.si.c-s.fr [172.25.230.102])
 by messagerie.si.c-s.fr (Postfix) with ESMTP id 4C8028B76F;
 Mon,  8 Jul 2019 12:12:41 +0200 (CEST)
Subject: Re: [PATCH] kexec: add generic support for elf kernel images
To: Sven Schnelle <svens@stackframe.org>, kexec@lists.infradead.org
References: <20190707192153.7821-1-svens@stackframe.org>
From: Christophe Leroy <christophe.leroy@c-s.fr>
Message-ID: <73174513-95c7-05c1-4c81-b1fab17e03e1@c-s.fr>
Date: Mon, 8 Jul 2019 12:12:41 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:60.0) Gecko/20100101
 Thunderbird/60.7.2
MIME-Version: 1.0
In-Reply-To: <20190707192153.7821-1-svens@stackframe.org>
Content-Language: fr
X-CRM114-Version: 20100106-BlameMichelson ( TRE 0.8.0 (BSD) ) MR-646709E3 
X-CRM114-CacheID: sfid-20190708_031244_219351_41DBC25E 
X-CRM114-Status: GOOD (  24.91  )
X-Spam-Score: -0.2 (/)
X-Spam-Report: SpamAssassin version 3.4.2 on bombadil.infradead.org summary:
 Content analysis details:   (-0.2 points)
 pts rule name              description
 ---- ---------------------- --------------------------------------------------
 -0.0 RCVD_IN_DNSWL_NONE     RBL: Sender listed at https://www.dnswl.org/,
 no trust [93.17.236.30 listed in list.dnswl.org]
 0.0 SPF_HELO_NONE          SPF: HELO does not publish an SPF Record
 -0.0 SPF_PASS               SPF: sender matches SPF record
 0.1 DKIM_SIGNED            Message has a DKIM or DK signature, not necessarily
 valid
 -0.1 DKIM_VALID_AU          Message has a valid DKIM or DK signature from
 author's domain
 -0.1 DKIM_VALID_EF          Message has a valid DKIM or DK signature from
 envelope-from domain
 -0.1 DKIM_VALID Message has at least one valid DKIM or DK signature
X-BeenThere: kexec@lists.infradead.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <kexec.lists.infradead.org>
List-Unsubscribe: <http://lists.infradead.org/mailman/options/kexec>,
 <mailto:kexec-request@lists.infradead.org?subject=unsubscribe>
List-Archive: <http://lists.infradead.org/pipermail/kexec/>
List-Post: <mailto:kexec@lists.infradead.org>
List-Help: <mailto:kexec-request@lists.infradead.org?subject=help>
List-Subscribe: <http://lists.infradead.org/mailman/listinfo/kexec>,
 <mailto:kexec-request@lists.infradead.org?subject=subscribe>
Cc: deller@gmx.de, linuxppc-dev@lists.ozlabs.org
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Sender: "kexec" <kexec-bounces@lists.infradead.org>
Errors-To: kexec-bounces+lists+kexec=lfdr.de@lists.infradead.org

CgpMZSAwNy8wNy8yMDE5IMOgIDIxOjIxLCBTdmVuIFNjaG5lbGxlIGEgw6ljcml0wqA6Cj4gU2ln
bmVkLW9mZi1ieTogU3ZlbiBTY2huZWxsZSA8c3ZlbnNAc3RhY2tmcmFtZS5vcmc+Cj4gLS0tCgpQ
bGVhc2UgYWRkIGhlcmUgYSBkZXNjcmlwdGlvbiBvZiB0aGUgY2hhbmdlcyBkb25lIHNpbmNlIFJG
Qy4KCj4gICBhcmNoL0tjb25maWcgICAgICAgICAgICAgICAgICAgICAgIHwgICAzICsKPiAgIGFy
Y2gvcG93ZXJwYy9LY29uZmlnICAgICAgICAgICAgICAgfCAgIDEgKwo+ICAgYXJjaC9wb3dlcnBj
L2tlcm5lbC9rZXhlY19lbGZfNjQuYyB8IDU0NyArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LQo+ICAgaW5jbHVkZS9saW51eC9rZXhlYy5oICAgICAgICAgICAgICB8ICAzNSArKwo+ICAga2Vy
bmVsL01ha2VmaWxlICAgICAgICAgICAgICAgICAgICB8ICAgMSArCj4gICBrZXJuZWwva2V4ZWNf
ZWxmLmMgICAgICAgICAgICAgICAgIHwgNTQwICsrKysrKysrKysrKysrKysrKysrKysrKysrKysK
PiAgIDYgZmlsZXMgY2hhbmdlZCwgNTg4IGluc2VydGlvbnMoKyksIDUzOSBkZWxldGlvbnMoLSkK
PiAgIGNyZWF0ZSBtb2RlIDEwMDY0NCBrZXJuZWwva2V4ZWNfZWxmLmMKCmtlcm5lbC9rZXhlY19l
bGYuYyBpcyBhIG1vZGlmaWVkIGNvcHkgb2YgYXJjaC9wb3dlcnBjL2tlcm5lbC9rZXhlY19lbGZf
NjQuYy4KWW91IHNob3VsZCBnZW5lcmF0ZSB5b3VyIHBhdGNoIHVzaWduICdnaXQgZm9ybWF0LXBh
dGNoIC1DJyBpbiBvcmRlciB0byAKbGV0IGdpdCBpZGVudGlmeSB0aGUgY29weSBhbmQgdGhlIGNo
YW5nZXMgdG8gdGhlIGNvcHkuClRoYXQgd291bGQgZWFzZSB0aGUgcmV2aWV3LiBJIGhhdmUgcmVn
ZW5lcmF0ZWQgeW91ciBwYXRjaCB3aXRoIC1DIGFuZCAKcmVzZW50IGl0LgoKQ2hyaXN0b3BoZQoK
PiAKPiBkaWZmIC0tZ2l0IGEvYXJjaC9LY29uZmlnIGIvYXJjaC9LY29uZmlnCj4gaW5kZXggYzQ3
YjMyOGVhZGEwLi4zMDY5NGFjYTQzMTYgMTAwNjQ0Cj4gLS0tIGEvYXJjaC9LY29uZmlnCj4gKysr
IGIvYXJjaC9LY29uZmlnCj4gQEAgLTE4LDYgKzE4LDkgQEAgY29uZmlnIEtFWEVDX0NPUkUKPiAg
IAlzZWxlY3QgQ1JBU0hfQ09SRQo+ICAgCWJvb2wKPiAgIAo+ICtjb25maWcgS0VYRUNfRUxGCj4g
Kwlib29sCj4gKwo+ICAgY29uZmlnIEhBVkVfSU1BX0tFWEVDCj4gICAJYm9vbAo+ICAgCj4gZGlm
ZiAtLWdpdCBhL2FyY2gvcG93ZXJwYy9LY29uZmlnIGIvYXJjaC9wb3dlcnBjL0tjb25maWcKPiBp
bmRleCA4YzFjNjM2MzA4YzguLjk3YWE4MTYyMjQ1MiAxMDA2NDQKPiAtLS0gYS9hcmNoL3Bvd2Vy
cGMvS2NvbmZpZwo+ICsrKyBiL2FyY2gvcG93ZXJwYy9LY29uZmlnCj4gQEAgLTUwMiw2ICs1MDIs
NyBAQCBjb25maWcgS0VYRUNfRklMRQo+ICAgCXNlbGVjdCBLRVhFQ19DT1JFCj4gICAJc2VsZWN0
IEhBVkVfSU1BX0tFWEVDCj4gICAJc2VsZWN0IEJVSUxEX0JJTjJDCj4gKwlzZWxlY3QgS0VYRUNf
RUxGCj4gICAJZGVwZW5kcyBvbiBQUEM2NAo+ICAgCWRlcGVuZHMgb24gQ1JZUFRPPXkKPiAgIAlk
ZXBlbmRzIG9uIENSWVBUT19TSEEyNTY9eQo+IGRpZmYgLS1naXQgYS9hcmNoL3Bvd2VycGMva2Vy
bmVsL2tleGVjX2VsZl82NC5jIGIvYXJjaC9wb3dlcnBjL2tlcm5lbC9rZXhlY19lbGZfNjQuYwo+
IGluZGV4IGJhNGYxOGE0M2VlOC4uZDA2MmM1OTkxNzIyIDEwMDY0NAo+IC0tLSBhL2FyY2gvcG93
ZXJwYy9rZXJuZWwva2V4ZWNfZWxmXzY0LmMKPiArKysgYi9hcmNoL3Bvd2VycGMva2VybmVsL2tl
eGVjX2VsZl82NC5jCj4gQEAgLTMxLDUzOSArMzEsNyBAQAo+ICAgI2luY2x1ZGUgPGxpbnV4L3Ns
YWIuaD4KPiAgICNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgo+ICAgCj4gLSNkZWZpbmUgUFVSR0FU
T1JZX1NUQUNLX1NJWkUJKDE2ICogMTAyNCkKPiAtCj4gLSNkZWZpbmUgZWxmX2FkZHJfdG9fY3B1
CWVsZjY0X3RvX2NwdQo+IC0KPiAtI2lmbmRlZiBFbGZfUmVsCj4gLSNkZWZpbmUgRWxmX1JlbAkJ
RWxmNjRfUmVsCj4gLSNlbmRpZiAvKiBFbGZfUmVsICovCj4gLQo+IC1zdHJ1Y3QgZWxmX2luZm8g
ewo+IC0JLyoKPiAtCSAqIFdoZXJlIHRoZSBFTEYgYmluYXJ5IGNvbnRlbnRzIGFyZSBrZXB0Lgo+
IC0JICogTWVtb3J5IG1hbmFnZWQgYnkgdGhlIHVzZXIgb2YgdGhlIHN0cnVjdC4KPiAtCSAqLwo+
IC0JY29uc3QgY2hhciAqYnVmZmVyOwo+IC0KPiAtCWNvbnN0IHN0cnVjdCBlbGZoZHIgKmVoZHI7
Cj4gLQljb25zdCBzdHJ1Y3QgZWxmX3BoZHIgKnByb2doZHJzOwo+IC0Jc3RydWN0IGVsZl9zaGRy
ICpzZWNoZHJzOwo+IC19Owo+IC0KPiAtc3RhdGljIGlubGluZSBib29sIGVsZl9pc19lbGZfZmls
ZShjb25zdCBzdHJ1Y3QgZWxmaGRyICplaGRyKQo+IC17Cj4gLSAgICAgICByZXR1cm4gbWVtY21w
KGVoZHItPmVfaWRlbnQsIEVMRk1BRywgU0VMRk1BRykgPT0gMDsKPiAtfQo+IC0KPiAtc3RhdGlj
IHVpbnQ2NF90IGVsZjY0X3RvX2NwdShjb25zdCBzdHJ1Y3QgZWxmaGRyICplaGRyLCB1aW50NjRf
dCB2YWx1ZSkKPiAtewo+IC0JaWYgKGVoZHItPmVfaWRlbnRbRUlfREFUQV0gPT0gRUxGREFUQTJM
U0IpCj4gLQkJdmFsdWUgPSBsZTY0X3RvX2NwdSh2YWx1ZSk7Cj4gLQllbHNlIGlmIChlaGRyLT5l
X2lkZW50W0VJX0RBVEFdID09IEVMRkRBVEEyTVNCKQo+IC0JCXZhbHVlID0gYmU2NF90b19jcHUo
dmFsdWUpOwo+IC0KPiAtCXJldHVybiB2YWx1ZTsKPiAtfQo+IC0KPiAtc3RhdGljIHVpbnQxNl90
IGVsZjE2X3RvX2NwdShjb25zdCBzdHJ1Y3QgZWxmaGRyICplaGRyLCB1aW50MTZfdCB2YWx1ZSkK
PiAtewo+IC0JaWYgKGVoZHItPmVfaWRlbnRbRUlfREFUQV0gPT0gRUxGREFUQTJMU0IpCj4gLQkJ
dmFsdWUgPSBsZTE2X3RvX2NwdSh2YWx1ZSk7Cj4gLQllbHNlIGlmIChlaGRyLT5lX2lkZW50W0VJ
X0RBVEFdID09IEVMRkRBVEEyTVNCKQo+IC0JCXZhbHVlID0gYmUxNl90b19jcHUodmFsdWUpOwo+
IC0KPiAtCXJldHVybiB2YWx1ZTsKPiAtfQo+IC0KPiAtc3RhdGljIHVpbnQzMl90IGVsZjMyX3Rv
X2NwdShjb25zdCBzdHJ1Y3QgZWxmaGRyICplaGRyLCB1aW50MzJfdCB2YWx1ZSkKPiAtewo+IC0J
aWYgKGVoZHItPmVfaWRlbnRbRUlfREFUQV0gPT0gRUxGREFUQTJMU0IpCj4gLQkJdmFsdWUgPSBs
ZTMyX3RvX2NwdSh2YWx1ZSk7Cj4gLQllbHNlIGlmIChlaGRyLT5lX2lkZW50W0VJX0RBVEFdID09
IEVMRkRBVEEyTVNCKQo+IC0JCXZhbHVlID0gYmUzMl90b19jcHUodmFsdWUpOwo+IC0KPiAtCXJl
dHVybiB2YWx1ZTsKPiAtfQo+IC0KPiAtLyoqCj4gLSAqIGVsZl9pc19laGRyX3NhbmUgLSBjaGVj
ayB0aGF0IGl0IGlzIHNhZmUgdG8gdXNlIHRoZSBFTEYgaGVhZGVyCj4gLSAqIEBidWZfbGVuOglz
aXplIG9mIHRoZSBidWZmZXIgaW4gd2hpY2ggdGhlIEVMRiBmaWxlIGlzIGxvYWRlZC4KPiAtICov
Cj4gLXN0YXRpYyBib29sIGVsZl9pc19laGRyX3NhbmUoY29uc3Qgc3RydWN0IGVsZmhkciAqZWhk
ciwgc2l6ZV90IGJ1Zl9sZW4pCj4gLXsKPiAtCWlmIChlaGRyLT5lX3BobnVtID4gMCAmJiBlaGRy
LT5lX3BoZW50c2l6ZSAhPSBzaXplb2Yoc3RydWN0IGVsZl9waGRyKSkgewo+IC0JCXByX2RlYnVn
KCJCYWQgcHJvZ3JhbSBoZWFkZXIgc2l6ZS5cbiIpOwo+IC0JCXJldHVybiBmYWxzZTsKPiAtCX0g
ZWxzZSBpZiAoZWhkci0+ZV9zaG51bSA+IDAgJiYKPiAtCQkgICBlaGRyLT5lX3NoZW50c2l6ZSAh
PSBzaXplb2Yoc3RydWN0IGVsZl9zaGRyKSkgewo+IC0JCXByX2RlYnVnKCJCYWQgc2VjdGlvbiBo
ZWFkZXIgc2l6ZS5cbiIpOwo+IC0JCXJldHVybiBmYWxzZTsKPiAtCX0gZWxzZSBpZiAoZWhkci0+
ZV9pZGVudFtFSV9WRVJTSU9OXSAhPSBFVl9DVVJSRU5UIHx8Cj4gLQkJICAgZWhkci0+ZV92ZXJz
aW9uICE9IEVWX0NVUlJFTlQpIHsKPiAtCQlwcl9kZWJ1ZygiVW5rbm93biBFTEYgdmVyc2lvbi5c
biIpOwo+IC0JCXJldHVybiBmYWxzZTsKPiAtCX0KPiAtCj4gLQlpZiAoZWhkci0+ZV9waG9mZiA+
IDAgJiYgZWhkci0+ZV9waG51bSA+IDApIHsKPiAtCQlzaXplX3QgcGhkcl9zaXplOwo+IC0KPiAt
CQkvKgo+IC0JCSAqIGVfcGhudW0gaXMgYXQgbW9zdCA2NTUzNSBzbyBjYWxjdWxhdGluZyB0aGUg
c2l6ZSBvZiB0aGUKPiAtCQkgKiBwcm9ncmFtIGhlYWRlciBjYW5ub3Qgb3ZlcmZsb3cuCj4gLQkJ
ICovCj4gLQkJcGhkcl9zaXplID0gc2l6ZW9mKHN0cnVjdCBlbGZfcGhkcikgKiBlaGRyLT5lX3Bo
bnVtOwo+IC0KPiAtCQkvKiBTYW5pdHkgY2hlY2sgdGhlIHByb2dyYW0gaGVhZGVyIHRhYmxlIGxv
Y2F0aW9uLiAqLwo+IC0JCWlmIChlaGRyLT5lX3Bob2ZmICsgcGhkcl9zaXplIDwgZWhkci0+ZV9w
aG9mZikgewo+IC0JCQlwcl9kZWJ1ZygiUHJvZ3JhbSBoZWFkZXJzIGF0IGludmFsaWQgbG9jYXRp
b24uXG4iKTsKPiAtCQkJcmV0dXJuIGZhbHNlOwo+IC0JCX0gZWxzZSBpZiAoZWhkci0+ZV9waG9m
ZiArIHBoZHJfc2l6ZSA+IGJ1Zl9sZW4pIHsKPiAtCQkJcHJfZGVidWcoIlByb2dyYW0gaGVhZGVy
cyB0cnVuY2F0ZWQuXG4iKTsKPiAtCQkJcmV0dXJuIGZhbHNlOwo+IC0JCX0KPiAtCX0KPiAtCj4g
LQlpZiAoZWhkci0+ZV9zaG9mZiA+IDAgJiYgZWhkci0+ZV9zaG51bSA+IDApIHsKPiAtCQlzaXpl
X3Qgc2hkcl9zaXplOwo+IC0KPiAtCQkvKgo+IC0JCSAqIGVfc2hudW0gaXMgYXQgbW9zdCA2NTUz
NiBzbyBjYWxjdWxhdGluZwo+IC0JCSAqIHRoZSBzaXplIG9mIHRoZSBzZWN0aW9uIGhlYWRlciBj
YW5ub3Qgb3ZlcmZsb3cuCj4gLQkJICovCj4gLQkJc2hkcl9zaXplID0gc2l6ZW9mKHN0cnVjdCBl
bGZfc2hkcikgKiBlaGRyLT5lX3NobnVtOwo+IC0KPiAtCQkvKiBTYW5pdHkgY2hlY2sgdGhlIHNl
Y3Rpb24gaGVhZGVyIHRhYmxlIGxvY2F0aW9uLiAqLwo+IC0JCWlmIChlaGRyLT5lX3Nob2ZmICsg
c2hkcl9zaXplIDwgZWhkci0+ZV9zaG9mZikgewo+IC0JCQlwcl9kZWJ1ZygiU2VjdGlvbiBoZWFk
ZXJzIGF0IGludmFsaWQgbG9jYXRpb24uXG4iKTsKPiAtCQkJcmV0dXJuIGZhbHNlOwo+IC0JCX0g
ZWxzZSBpZiAoZWhkci0+ZV9zaG9mZiArIHNoZHJfc2l6ZSA+IGJ1Zl9sZW4pIHsKPiAtCQkJcHJf
ZGVidWcoIlNlY3Rpb24gaGVhZGVycyB0cnVuY2F0ZWQuXG4iKTsKPiAtCQkJcmV0dXJuIGZhbHNl
Owo+IC0JCX0KPiAtCX0KPiAtCj4gLQlyZXR1cm4gdHJ1ZTsKPiAtfQo+IC0KPiAtc3RhdGljIGlu
dCBlbGZfcmVhZF9laGRyKGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbiwgc3RydWN0IGVsZmhk
ciAqZWhkcikKPiAtewo+IC0Jc3RydWN0IGVsZmhkciAqYnVmX2VoZHI7Cj4gLQo+IC0JaWYgKGxl
biA8IHNpemVvZigqYnVmX2VoZHIpKSB7Cj4gLQkJcHJfZGVidWcoIkJ1ZmZlciBpcyB0b28gc21h
bGwgdG8gaG9sZCBFTEYgaGVhZGVyLlxuIik7Cj4gLQkJcmV0dXJuIC1FTk9FWEVDOwo+IC0JfQo+
IC0KPiAtCW1lbXNldChlaGRyLCAwLCBzaXplb2YoKmVoZHIpKTsKPiAtCW1lbWNweShlaGRyLT5l
X2lkZW50LCBidWYsIHNpemVvZihlaGRyLT5lX2lkZW50KSk7Cj4gLQlpZiAoIWVsZl9pc19lbGZf
ZmlsZShlaGRyKSkgewo+IC0JCXByX2RlYnVnKCJObyBFTEYgaGVhZGVyIG1hZ2ljLlxuIik7Cj4g
LQkJcmV0dXJuIC1FTk9FWEVDOwo+IC0JfQo+IC0KPiAtCWlmIChlaGRyLT5lX2lkZW50W0VJX0NM
QVNTXSAhPSBFTEZfQ0xBU1MpIHsKPiAtCQlwcl9kZWJ1ZygiTm90IGEgc3VwcG9ydGVkIEVMRiBj
bGFzcy5cbiIpOwo+IC0JCXJldHVybiAtRU5PRVhFQzsKPiAtCX0gZWxzZSAgaWYgKGVoZHItPmVf
aWRlbnRbRUlfREFUQV0gIT0gRUxGREFUQTJMU0IgJiYKPiAtCQllaGRyLT5lX2lkZW50W0VJX0RB
VEFdICE9IEVMRkRBVEEyTVNCKSB7Cj4gLQkJcHJfZGVidWcoIk5vdCBhIHN1cHBvcnRlZCBFTEYg
ZGF0YSBmb3JtYXQuXG4iKTsKPiAtCQlyZXR1cm4gLUVOT0VYRUM7Cj4gLQl9Cj4gLQo+IC0JYnVm
X2VoZHIgPSAoc3RydWN0IGVsZmhkciAqKSBidWY7Cj4gLQlpZiAoZWxmMTZfdG9fY3B1KGVoZHIs
IGJ1Zl9laGRyLT5lX2Voc2l6ZSkgIT0gc2l6ZW9mKCpidWZfZWhkcikpIHsKPiAtCQlwcl9kZWJ1
ZygiQmFkIEVMRiBoZWFkZXIgc2l6ZS5cbiIpOwo+IC0JCXJldHVybiAtRU5PRVhFQzsKPiAtCX0K
PiAtCj4gLQllaGRyLT5lX3R5cGUgICAgICA9IGVsZjE2X3RvX2NwdShlaGRyLCBidWZfZWhkci0+
ZV90eXBlKTsKPiAtCWVoZHItPmVfbWFjaGluZSAgID0gZWxmMTZfdG9fY3B1KGVoZHIsIGJ1Zl9l
aGRyLT5lX21hY2hpbmUpOwo+IC0JZWhkci0+ZV92ZXJzaW9uICAgPSBlbGYzMl90b19jcHUoZWhk
ciwgYnVmX2VoZHItPmVfdmVyc2lvbik7Cj4gLQllaGRyLT5lX2VudHJ5ICAgICA9IGVsZl9hZGRy
X3RvX2NwdShlaGRyLCBidWZfZWhkci0+ZV9lbnRyeSk7Cj4gLQllaGRyLT5lX3Bob2ZmICAgICA9
IGVsZl9hZGRyX3RvX2NwdShlaGRyLCBidWZfZWhkci0+ZV9waG9mZik7Cj4gLQllaGRyLT5lX3No
b2ZmICAgICA9IGVsZl9hZGRyX3RvX2NwdShlaGRyLCBidWZfZWhkci0+ZV9zaG9mZik7Cj4gLQll
aGRyLT5lX2ZsYWdzICAgICA9IGVsZjMyX3RvX2NwdShlaGRyLCBidWZfZWhkci0+ZV9mbGFncyk7
Cj4gLQllaGRyLT5lX3BoZW50c2l6ZSA9IGVsZjE2X3RvX2NwdShlaGRyLCBidWZfZWhkci0+ZV9w
aGVudHNpemUpOwo+IC0JZWhkci0+ZV9waG51bSAgICAgPSBlbGYxNl90b19jcHUoZWhkciwgYnVm
X2VoZHItPmVfcGhudW0pOwo+IC0JZWhkci0+ZV9zaGVudHNpemUgPSBlbGYxNl90b19jcHUoZWhk
ciwgYnVmX2VoZHItPmVfc2hlbnRzaXplKTsKPiAtCWVoZHItPmVfc2hudW0gICAgID0gZWxmMTZf
dG9fY3B1KGVoZHIsIGJ1Zl9laGRyLT5lX3NobnVtKTsKPiAtCWVoZHItPmVfc2hzdHJuZHggID0g
ZWxmMTZfdG9fY3B1KGVoZHIsIGJ1Zl9laGRyLT5lX3Noc3RybmR4KTsKPiAtCj4gLQlyZXR1cm4g
ZWxmX2lzX2VoZHJfc2FuZShlaGRyLCBsZW4pID8gMCA6IC1FTk9FWEVDOwo+IC19Cj4gLQo+IC0v
KioKPiAtICogZWxmX2lzX3BoZHJfc2FuZSAtIGNoZWNrIHRoYXQgaXQgaXMgc2FmZSB0byB1c2Ug
dGhlIHByb2dyYW0gaGVhZGVyCj4gLSAqIEBidWZfbGVuOglzaXplIG9mIHRoZSBidWZmZXIgaW4g
d2hpY2ggdGhlIEVMRiBmaWxlIGlzIGxvYWRlZC4KPiAtICovCj4gLXN0YXRpYyBib29sIGVsZl9p
c19waGRyX3NhbmUoY29uc3Qgc3RydWN0IGVsZl9waGRyICpwaGRyLCBzaXplX3QgYnVmX2xlbikK
PiAtewo+IC0KPiAtCWlmIChwaGRyLT5wX29mZnNldCArIHBoZHItPnBfZmlsZXN6IDwgcGhkci0+
cF9vZmZzZXQpIHsKPiAtCQlwcl9kZWJ1ZygiRUxGIHNlZ21lbnQgbG9jYXRpb24gd3JhcHMgYXJv
dW5kLlxuIik7Cj4gLQkJcmV0dXJuIGZhbHNlOwo+IC0JfSBlbHNlIGlmIChwaGRyLT5wX29mZnNl
dCArIHBoZHItPnBfZmlsZXN6ID4gYnVmX2xlbikgewo+IC0JCXByX2RlYnVnKCJFTEYgc2VnbWVu
dCBub3QgaW4gZmlsZS5cbiIpOwo+IC0JCXJldHVybiBmYWxzZTsKPiAtCX0gZWxzZSBpZiAocGhk
ci0+cF9wYWRkciArIHBoZHItPnBfbWVtc3ogPCBwaGRyLT5wX3BhZGRyKSB7Cj4gLQkJcHJfZGVi
dWcoIkVMRiBzZWdtZW50IGFkZHJlc3Mgd3JhcHMgYXJvdW5kLlxuIik7Cj4gLQkJcmV0dXJuIGZh
bHNlOwo+IC0JfQo+IC0KPiAtCXJldHVybiB0cnVlOwo+IC19Cj4gLQo+IC1zdGF0aWMgaW50IGVs
Zl9yZWFkX3BoZHIoY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuLCBzdHJ1Y3QgZWxmX2luZm8g
KmVsZl9pbmZvLAo+IC0JCQkgaW50IGlkeCkKPiAtewo+IC0JLyogT3ZlcnJpZGUgdGhlIGNvbnN0
IGluIHByb2doZHJzLCB3ZSBhcmUgdGhlIG9uZXMgZG9pbmcgdGhlIGxvYWRpbmcuICovCj4gLQlz
dHJ1Y3QgZWxmX3BoZHIgKnBoZHIgPSAoc3RydWN0IGVsZl9waGRyICopICZlbGZfaW5mby0+cHJv
Z2hkcnNbaWR4XTsKPiAtCWNvbnN0IGNoYXIgKnBidWY7Cj4gLQlzdHJ1Y3QgZWxmX3BoZHIgKmJ1
Zl9waGRyOwo+IC0KPiAtCXBidWYgPSBidWYgKyBlbGZfaW5mby0+ZWhkci0+ZV9waG9mZiArIChp
ZHggKiBzaXplb2YoKmJ1Zl9waGRyKSk7Cj4gLQlidWZfcGhkciA9IChzdHJ1Y3QgZWxmX3BoZHIg
KikgcGJ1ZjsKPiAtCj4gLQlwaGRyLT5wX3R5cGUgICA9IGVsZjMyX3RvX2NwdShlbGZfaW5mby0+
ZWhkciwgYnVmX3BoZHItPnBfdHlwZSk7Cj4gLQlwaGRyLT5wX29mZnNldCA9IGVsZl9hZGRyX3Rv
X2NwdShlbGZfaW5mby0+ZWhkciwgYnVmX3BoZHItPnBfb2Zmc2V0KTsKPiAtCXBoZHItPnBfcGFk
ZHIgID0gZWxmX2FkZHJfdG9fY3B1KGVsZl9pbmZvLT5laGRyLCBidWZfcGhkci0+cF9wYWRkcik7
Cj4gLQlwaGRyLT5wX3ZhZGRyICA9IGVsZl9hZGRyX3RvX2NwdShlbGZfaW5mby0+ZWhkciwgYnVm
X3BoZHItPnBfdmFkZHIpOwo+IC0JcGhkci0+cF9mbGFncyAgPSBlbGYzMl90b19jcHUoZWxmX2lu
Zm8tPmVoZHIsIGJ1Zl9waGRyLT5wX2ZsYWdzKTsKPiAtCj4gLQkvKgo+IC0JICogVGhlIGZvbGxv
d2luZyBmaWVsZHMgaGF2ZSBhIHR5cGUgZXF1aXZhbGVudCB0byBFbGZfQWRkcgo+IC0JICogYm90
aCBpbiAzMiBiaXQgYW5kIDY0IGJpdCBFTEYuCj4gLQkgKi8KPiAtCXBoZHItPnBfZmlsZXN6ID0g
ZWxmX2FkZHJfdG9fY3B1KGVsZl9pbmZvLT5laGRyLCBidWZfcGhkci0+cF9maWxlc3opOwo+IC0J
cGhkci0+cF9tZW1zeiAgPSBlbGZfYWRkcl90b19jcHUoZWxmX2luZm8tPmVoZHIsIGJ1Zl9waGRy
LT5wX21lbXN6KTsKPiAtCXBoZHItPnBfYWxpZ24gID0gZWxmX2FkZHJfdG9fY3B1KGVsZl9pbmZv
LT5laGRyLCBidWZfcGhkci0+cF9hbGlnbik7Cj4gLQo+IC0JcmV0dXJuIGVsZl9pc19waGRyX3Nh
bmUocGhkciwgbGVuKSA/IDAgOiAtRU5PRVhFQzsKPiAtfQo+IC0KPiAtLyoqCj4gLSAqIGVsZl9y
ZWFkX3BoZHJzIC0gcmVhZCB0aGUgcHJvZ3JhbSBoZWFkZXJzIGZyb20gdGhlIGJ1ZmZlcgo+IC0g
Kgo+IC0gKiBUaGlzIGZ1bmN0aW9uIGFzc3VtZXMgdGhhdCB0aGUgcHJvZ3JhbSBoZWFkZXIgdGFi
bGUgd2FzIGNoZWNrZWQgZm9yIHNhbml0eS4KPiAtICogVXNlIGVsZl9pc19laGRyX3NhbmUoKSBp
ZiBpdCB3YXNuJ3QuCj4gLSAqLwo+IC1zdGF0aWMgaW50IGVsZl9yZWFkX3BoZHJzKGNvbnN0IGNo
YXIgKmJ1Ziwgc2l6ZV90IGxlbiwKPiAtCQkJICBzdHJ1Y3QgZWxmX2luZm8gKmVsZl9pbmZvKQo+
IC17Cj4gLQlzaXplX3QgcGhkcl9zaXplLCBpOwo+IC0JY29uc3Qgc3RydWN0IGVsZmhkciAqZWhk
ciA9IGVsZl9pbmZvLT5laGRyOwo+IC0KPiAtCS8qCj4gLQkgKiBlX3BobnVtIGlzIGF0IG1vc3Qg
NjU1MzUgc28gY2FsY3VsYXRpbmcgdGhlIHNpemUgb2YgdGhlCj4gLQkgKiBwcm9ncmFtIGhlYWRl
ciBjYW5ub3Qgb3ZlcmZsb3cuCj4gLQkgKi8KPiAtCXBoZHJfc2l6ZSA9IHNpemVvZihzdHJ1Y3Qg
ZWxmX3BoZHIpICogZWhkci0+ZV9waG51bTsKPiAtCj4gLQllbGZfaW5mby0+cHJvZ2hkcnMgPSBr
emFsbG9jKHBoZHJfc2l6ZSwgR0ZQX0tFUk5FTCk7Cj4gLQlpZiAoIWVsZl9pbmZvLT5wcm9naGRy
cykKPiAtCQlyZXR1cm4gLUVOT01FTTsKPiAtCj4gLQlmb3IgKGkgPSAwOyBpIDwgZWhkci0+ZV9w
aG51bTsgaSsrKSB7Cj4gLQkJaW50IHJldDsKPiAtCj4gLQkJcmV0ID0gZWxmX3JlYWRfcGhkcihi
dWYsIGxlbiwgZWxmX2luZm8sIGkpOwo+IC0JCWlmIChyZXQpIHsKPiAtCQkJa2ZyZWUoZWxmX2lu
Zm8tPnByb2doZHJzKTsKPiAtCQkJZWxmX2luZm8tPnByb2doZHJzID0gTlVMTDsKPiAtCQkJcmV0
dXJuIHJldDsKPiAtCQl9Cj4gLQl9Cj4gLQo+IC0JcmV0dXJuIDA7Cj4gLX0KPiAtCj4gLS8qKgo+
IC0gKiBlbGZfaXNfc2hkcl9zYW5lIC0gY2hlY2sgdGhhdCBpdCBpcyBzYWZlIHRvIHVzZSB0aGUg
c2VjdGlvbiBoZWFkZXIKPiAtICogQGJ1Zl9sZW46CXNpemUgb2YgdGhlIGJ1ZmZlciBpbiB3aGlj
aCB0aGUgRUxGIGZpbGUgaXMgbG9hZGVkLgo+IC0gKi8KPiAtc3RhdGljIGJvb2wgZWxmX2lzX3No
ZHJfc2FuZShjb25zdCBzdHJ1Y3QgZWxmX3NoZHIgKnNoZHIsIHNpemVfdCBidWZfbGVuKQo+IC17
Cj4gLQlib29sIHNpemVfb2s7Cj4gLQo+IC0JLyogU0hUX05VTEwgaGVhZGVycyBoYXZlIHVuZGVm
aW5lZCB2YWx1ZXMsIHNvIHdlIGNhbid0IGNoZWNrIHRoZW0uICovCj4gLQlpZiAoc2hkci0+c2hf
dHlwZSA9PSBTSFRfTlVMTCkKPiAtCQlyZXR1cm4gdHJ1ZTsKPiAtCj4gLQkvKiBOb3cgdmVyaWZ5
IHNoX2VudHNpemUgKi8KPiAtCXN3aXRjaCAoc2hkci0+c2hfdHlwZSkgewo+IC0JY2FzZSBTSFRf
U1lNVEFCOgo+IC0JCXNpemVfb2sgPSBzaGRyLT5zaF9lbnRzaXplID09IHNpemVvZihFbGZfU3lt
KTsKPiAtCQlicmVhazsKPiAtCWNhc2UgU0hUX1JFTEE6Cj4gLQkJc2l6ZV9vayA9IHNoZHItPnNo
X2VudHNpemUgPT0gc2l6ZW9mKEVsZl9SZWxhKTsKPiAtCQlicmVhazsKPiAtCWNhc2UgU0hUX0RZ
TkFNSUM6Cj4gLQkJc2l6ZV9vayA9IHNoZHItPnNoX2VudHNpemUgPT0gc2l6ZW9mKEVsZl9EeW4p
Owo+IC0JCWJyZWFrOwo+IC0JY2FzZSBTSFRfUkVMOgo+IC0JCXNpemVfb2sgPSBzaGRyLT5zaF9l
bnRzaXplID09IHNpemVvZihFbGZfUmVsKTsKPiAtCQlicmVhazsKPiAtCWNhc2UgU0hUX05PVEU6
Cj4gLQljYXNlIFNIVF9QUk9HQklUUzoKPiAtCWNhc2UgU0hUX0hBU0g6Cj4gLQljYXNlIFNIVF9O
T0JJVFM6Cj4gLQlkZWZhdWx0Ogo+IC0JCS8qCj4gLQkJICogVGhpcyBpcyBhIHNlY3Rpb24gd2hv
c2UgZW50c2l6ZSByZXF1aXJlbWVudHMKPiAtCQkgKiBJIGRvbid0IGNhcmUgYWJvdXQuICBJZiBJ
IGRvbid0IGtub3cgYWJvdXQKPiAtCQkgKiB0aGUgc2VjdGlvbiBJIGNhbid0IGNhcmUgYWJvdXQg
aXQncyBlbnRzaXplCj4gLQkJICogcmVxdWlyZW1lbnRzLgo+IC0JCSAqLwo+IC0JCXNpemVfb2sg
PSB0cnVlOwo+IC0JCWJyZWFrOwo+IC0JfQo+IC0KPiAtCWlmICghc2l6ZV9vaykgewo+IC0JCXBy
X2RlYnVnKCJFTEYgc2VjdGlvbiB3aXRoIHdyb25nIGVudHJ5IHNpemUuXG4iKTsKPiAtCQlyZXR1
cm4gZmFsc2U7Cj4gLQl9IGVsc2UgaWYgKHNoZHItPnNoX2FkZHIgKyBzaGRyLT5zaF9zaXplIDwg
c2hkci0+c2hfYWRkcikgewo+IC0JCXByX2RlYnVnKCJFTEYgc2VjdGlvbiBhZGRyZXNzIHdyYXBz
IGFyb3VuZC5cbiIpOwo+IC0JCXJldHVybiBmYWxzZTsKPiAtCX0KPiAtCj4gLQlpZiAoc2hkci0+
c2hfdHlwZSAhPSBTSFRfTk9CSVRTKSB7Cj4gLQkJaWYgKHNoZHItPnNoX29mZnNldCArIHNoZHIt
PnNoX3NpemUgPCBzaGRyLT5zaF9vZmZzZXQpIHsKPiAtCQkJcHJfZGVidWcoIkVMRiBzZWN0aW9u
IGxvY2F0aW9uIHdyYXBzIGFyb3VuZC5cbiIpOwo+IC0JCQlyZXR1cm4gZmFsc2U7Cj4gLQkJfSBl
bHNlIGlmIChzaGRyLT5zaF9vZmZzZXQgKyBzaGRyLT5zaF9zaXplID4gYnVmX2xlbikgewo+IC0J
CQlwcl9kZWJ1ZygiRUxGIHNlY3Rpb24gbm90IGluIGZpbGUuXG4iKTsKPiAtCQkJcmV0dXJuIGZh
bHNlOwo+IC0JCX0KPiAtCX0KPiAtCj4gLQlyZXR1cm4gdHJ1ZTsKPiAtfQo+IC0KPiAtc3RhdGlj
IGludCBlbGZfcmVhZF9zaGRyKGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbiwgc3RydWN0IGVs
Zl9pbmZvICplbGZfaW5mbywKPiAtCQkJIGludCBpZHgpCj4gLXsKPiAtCXN0cnVjdCBlbGZfc2hk
ciAqc2hkciA9ICZlbGZfaW5mby0+c2VjaGRyc1tpZHhdOwo+IC0JY29uc3Qgc3RydWN0IGVsZmhk
ciAqZWhkciA9IGVsZl9pbmZvLT5laGRyOwo+IC0JY29uc3QgY2hhciAqc2J1ZjsKPiAtCXN0cnVj
dCBlbGZfc2hkciAqYnVmX3NoZHI7Cj4gLQo+IC0Jc2J1ZiA9IGJ1ZiArIGVoZHItPmVfc2hvZmYg
KyBpZHggKiBzaXplb2YoKmJ1Zl9zaGRyKTsKPiAtCWJ1Zl9zaGRyID0gKHN0cnVjdCBlbGZfc2hk
ciAqKSBzYnVmOwo+IC0KPiAtCXNoZHItPnNoX25hbWUgICAgICA9IGVsZjMyX3RvX2NwdShlaGRy
LCBidWZfc2hkci0+c2hfbmFtZSk7Cj4gLQlzaGRyLT5zaF90eXBlICAgICAgPSBlbGYzMl90b19j
cHUoZWhkciwgYnVmX3NoZHItPnNoX3R5cGUpOwo+IC0Jc2hkci0+c2hfYWRkciAgICAgID0gZWxm
X2FkZHJfdG9fY3B1KGVoZHIsIGJ1Zl9zaGRyLT5zaF9hZGRyKTsKPiAtCXNoZHItPnNoX29mZnNl
dCAgICA9IGVsZl9hZGRyX3RvX2NwdShlaGRyLCBidWZfc2hkci0+c2hfb2Zmc2V0KTsKPiAtCXNo
ZHItPnNoX2xpbmsgICAgICA9IGVsZjMyX3RvX2NwdShlaGRyLCBidWZfc2hkci0+c2hfbGluayk7
Cj4gLQlzaGRyLT5zaF9pbmZvICAgICAgPSBlbGYzMl90b19jcHUoZWhkciwgYnVmX3NoZHItPnNo
X2luZm8pOwo+IC0KPiAtCS8qCj4gLQkgKiBUaGUgZm9sbG93aW5nIGZpZWxkcyBoYXZlIGEgdHlw
ZSBlcXVpdmFsZW50IHRvIEVsZl9BZGRyCj4gLQkgKiBib3RoIGluIDMyIGJpdCBhbmQgNjQgYml0
IEVMRi4KPiAtCSAqLwo+IC0Jc2hkci0+c2hfZmxhZ3MgICAgID0gZWxmX2FkZHJfdG9fY3B1KGVo
ZHIsIGJ1Zl9zaGRyLT5zaF9mbGFncyk7Cj4gLQlzaGRyLT5zaF9zaXplICAgICAgPSBlbGZfYWRk
cl90b19jcHUoZWhkciwgYnVmX3NoZHItPnNoX3NpemUpOwo+IC0Jc2hkci0+c2hfYWRkcmFsaWdu
ID0gZWxmX2FkZHJfdG9fY3B1KGVoZHIsIGJ1Zl9zaGRyLT5zaF9hZGRyYWxpZ24pOwo+IC0Jc2hk
ci0+c2hfZW50c2l6ZSAgID0gZWxmX2FkZHJfdG9fY3B1KGVoZHIsIGJ1Zl9zaGRyLT5zaF9lbnRz
aXplKTsKPiAtCj4gLQlyZXR1cm4gZWxmX2lzX3NoZHJfc2FuZShzaGRyLCBsZW4pID8gMCA6IC1F
Tk9FWEVDOwo+IC19Cj4gLQo+IC0vKioKPiAtICogZWxmX3JlYWRfc2hkcnMgLSByZWFkIHRoZSBz
ZWN0aW9uIGhlYWRlcnMgZnJvbSB0aGUgYnVmZmVyCj4gLSAqCj4gLSAqIFRoaXMgZnVuY3Rpb24g
YXNzdW1lcyB0aGF0IHRoZSBzZWN0aW9uIGhlYWRlciB0YWJsZSB3YXMgY2hlY2tlZCBmb3Igc2Fu
aXR5Lgo+IC0gKiBVc2UgZWxmX2lzX2VoZHJfc2FuZSgpIGlmIGl0IHdhc24ndC4KPiAtICovCj4g
LXN0YXRpYyBpbnQgZWxmX3JlYWRfc2hkcnMoY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuLAo+
IC0JCQkgIHN0cnVjdCBlbGZfaW5mbyAqZWxmX2luZm8pCj4gLXsKPiAtCXNpemVfdCBzaGRyX3Np
emUsIGk7Cj4gLQo+IC0JLyoKPiAtCSAqIGVfc2hudW0gaXMgYXQgbW9zdCA2NTUzNiBzbyBjYWxj
dWxhdGluZwo+IC0JICogdGhlIHNpemUgb2YgdGhlIHNlY3Rpb24gaGVhZGVyIGNhbm5vdCBvdmVy
Zmxvdy4KPiAtCSAqLwo+IC0Jc2hkcl9zaXplID0gc2l6ZW9mKHN0cnVjdCBlbGZfc2hkcikgKiBl
bGZfaW5mby0+ZWhkci0+ZV9zaG51bTsKPiAtCj4gLQllbGZfaW5mby0+c2VjaGRycyA9IGt6YWxs
b2Moc2hkcl9zaXplLCBHRlBfS0VSTkVMKTsKPiAtCWlmICghZWxmX2luZm8tPnNlY2hkcnMpCj4g
LQkJcmV0dXJuIC1FTk9NRU07Cj4gLQo+IC0JZm9yIChpID0gMDsgaSA8IGVsZl9pbmZvLT5laGRy
LT5lX3NobnVtOyBpKyspIHsKPiAtCQlpbnQgcmV0Owo+IC0KPiAtCQlyZXQgPSBlbGZfcmVhZF9z
aGRyKGJ1ZiwgbGVuLCBlbGZfaW5mbywgaSk7Cj4gLQkJaWYgKHJldCkgewo+IC0JCQlrZnJlZShl
bGZfaW5mby0+c2VjaGRycyk7Cj4gLQkJCWVsZl9pbmZvLT5zZWNoZHJzID0gTlVMTDsKPiAtCQkJ
cmV0dXJuIHJldDsKPiAtCQl9Cj4gLQl9Cj4gLQo+IC0JcmV0dXJuIDA7Cj4gLX0KPiAtCj4gLS8q
Kgo+IC0gKiBlbGZfcmVhZF9mcm9tX2J1ZmZlciAtIHJlYWQgRUxGIGZpbGUgYW5kIHNldHMgdXAg
RUxGIGhlYWRlciBhbmQgRUxGIGluZm8KPiAtICogQGJ1ZjoJQnVmZmVyIHRvIHJlYWQgRUxGIGZp
bGUgZnJvbS4KPiAtICogQGxlbjoJU2l6ZSBvZiBAYnVmLgo+IC0gKiBAZWhkcjoJUG9pbnRlciB0
byBleGlzdGluZyBzdHJ1Y3Qgd2hpY2ggd2lsbCBiZSBwb3B1bGF0ZWQuCj4gLSAqIEBlbGZfaW5m
bzoJUG9pbnRlciB0byBleGlzdGluZyBzdHJ1Y3Qgd2hpY2ggd2lsbCBiZSBwb3B1bGF0ZWQuCj4g
LSAqCj4gLSAqIFRoaXMgZnVuY3Rpb24gYWxsb3dzIHJlYWRpbmcgRUxGIGZpbGVzIHdpdGggZGlm
ZmVyZW50IGJ5dGUgb3JkZXIgdGhhbgo+IC0gKiB0aGUga2VybmVsLCBieXRlLXN3YXBwaW5nIHRo
ZSBmaWVsZHMgYXMgbmVlZGVkLgo+IC0gKgo+IC0gKiBSZXR1cm46Cj4gLSAqIE9uIHN1Y2Nlc3Mg
cmV0dXJucyAwLCBhbmQgdGhlIGNhbGxlciBzaG91bGQgY2FsbCBlbGZfZnJlZV9pbmZvKGVsZl9p
bmZvKSB0bwo+IC0gKiBmcmVlIHRoZSBtZW1vcnkgYWxsb2NhdGVkIGZvciB0aGUgc2VjdGlvbiBh
bmQgcHJvZ3JhbSBoZWFkZXJzLgo+IC0gKi8KPiAtaW50IGVsZl9yZWFkX2Zyb21fYnVmZmVyKGNv
bnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbiwgc3RydWN0IGVsZmhkciAqZWhkciwKPiAtCQkJIHN0
cnVjdCBlbGZfaW5mbyAqZWxmX2luZm8pCj4gLXsKPiAtCWludCByZXQ7Cj4gLQo+IC0JcmV0ID0g
ZWxmX3JlYWRfZWhkcihidWYsIGxlbiwgZWhkcik7Cj4gLQlpZiAocmV0KQo+IC0JCXJldHVybiBy
ZXQ7Cj4gLQo+IC0JZWxmX2luZm8tPmJ1ZmZlciA9IGJ1ZjsKPiAtCWVsZl9pbmZvLT5laGRyID0g
ZWhkcjsKPiAtCWlmIChlaGRyLT5lX3Bob2ZmID4gMCAmJiBlaGRyLT5lX3BobnVtID4gMCkgewo+
IC0JCXJldCA9IGVsZl9yZWFkX3BoZHJzKGJ1ZiwgbGVuLCBlbGZfaW5mbyk7Cj4gLQkJaWYgKHJl
dCkKPiAtCQkJcmV0dXJuIHJldDsKPiAtCX0KPiAtCWlmIChlaGRyLT5lX3Nob2ZmID4gMCAmJiBl
aGRyLT5lX3NobnVtID4gMCkgewo+IC0JCXJldCA9IGVsZl9yZWFkX3NoZHJzKGJ1ZiwgbGVuLCBl
bGZfaW5mbyk7Cj4gLQkJaWYgKHJldCkgewo+IC0JCQlrZnJlZShlbGZfaW5mby0+cHJvZ2hkcnMp
Owo+IC0JCQlyZXR1cm4gcmV0Owo+IC0JCX0KPiAtCX0KPiAtCj4gLQlyZXR1cm4gMDsKPiAtfQo+
IC0KPiAtLyoqCj4gLSAqIGVsZl9mcmVlX2luZm8gLSBmcmVlIG1lbW9yeSBhbGxvY2F0ZWQgYnkg
ZWxmX3JlYWRfZnJvbV9idWZmZXIKPiAtICovCj4gLXZvaWQgZWxmX2ZyZWVfaW5mbyhzdHJ1Y3Qg
ZWxmX2luZm8gKmVsZl9pbmZvKQo+IC17Cj4gLQlrZnJlZShlbGZfaW5mby0+cHJvZ2hkcnMpOwo+
IC0Ja2ZyZWUoZWxmX2luZm8tPnNlY2hkcnMpOwo+IC0JbWVtc2V0KGVsZl9pbmZvLCAwLCBzaXpl
b2YoKmVsZl9pbmZvKSk7Cj4gLX0KPiAtLyoqCj4gLSAqIGJ1aWxkX2VsZl9leGVjX2luZm8gLSBy
ZWFkIEVMRiBleGVjdXRhYmxlIGFuZCBjaGVjayB0aGF0IHdlIGNhbiB1c2UgaXQKPiAtICovCj4g
LXN0YXRpYyBpbnQgYnVpbGRfZWxmX2V4ZWNfaW5mbyhjb25zdCBjaGFyICpidWYsIHNpemVfdCBs
ZW4sIHN0cnVjdCBlbGZoZHIgKmVoZHIsCj4gLQkJCSAgICAgICBzdHJ1Y3QgZWxmX2luZm8gKmVs
Zl9pbmZvKQo+IC17Cj4gLQlpbnQgaTsKPiAtCWludCByZXQ7Cj4gLQo+IC0JcmV0ID0gZWxmX3Jl
YWRfZnJvbV9idWZmZXIoYnVmLCBsZW4sIGVoZHIsIGVsZl9pbmZvKTsKPiAtCWlmIChyZXQpCj4g
LQkJcmV0dXJuIHJldDsKPiAtCj4gLQkvKiBCaWcgZW5kaWFuIHZtbGludXggaGFzIHR5cGUgRVRf
RFlOLiAqLwo+IC0JaWYgKGVoZHItPmVfdHlwZSAhPSBFVF9FWEVDICYmIGVoZHItPmVfdHlwZSAh
PSBFVF9EWU4pIHsKPiAtCQlwcl9lcnIoIk5vdCBhbiBFTEYgZXhlY3V0YWJsZS5cbiIpOwo+IC0J
CWdvdG8gZXJyb3I7Cj4gLQl9IGVsc2UgaWYgKCFlbGZfaW5mby0+cHJvZ2hkcnMpIHsKPiAtCQlw
cl9lcnIoIk5vIEVMRiBwcm9ncmFtIGhlYWRlci5cbiIpOwo+IC0JCWdvdG8gZXJyb3I7Cj4gLQl9
Cj4gLQo+IC0JZm9yIChpID0gMDsgaSA8IGVoZHItPmVfcGhudW07IGkrKykgewo+IC0JCS8qCj4g
LQkJICogS2V4ZWMgZG9lcyBub3Qgc3VwcG9ydCBsb2FkaW5nIGludGVycHJldGVycy4KPiAtCQkg
KiBJbiBhZGRpdGlvbiB0aGlzIGNoZWNrIGtlZXBzIHVzIGZyb20gYXR0ZW1wdGluZwo+IC0JCSAq
IHRvIGtleGVjIG9yZGluYXkgZXhlY3V0YWJsZXMuCj4gLQkJICovCj4gLQkJaWYgKGVsZl9pbmZv
LT5wcm9naGRyc1tpXS5wX3R5cGUgPT0gUFRfSU5URVJQKSB7Cj4gLQkJCXByX2VycigiUmVxdWly
ZXMgYW4gRUxGIGludGVycHJldGVyLlxuIik7Cj4gLQkJCWdvdG8gZXJyb3I7Cj4gLQkJfQo+IC0J
fQo+IC0KPiAtCXJldHVybiAwOwo+IC1lcnJvcjoKPiAtCWVsZl9mcmVlX2luZm8oZWxmX2luZm8p
Owo+IC0JcmV0dXJuIC1FTk9FWEVDOwo+IC19Cj4gLQo+IC1zdGF0aWMgaW50IGVsZjY0X3Byb2Jl
KGNvbnN0IGNoYXIgKmJ1ZiwgdW5zaWduZWQgbG9uZyBsZW4pCj4gLXsKPiAtCXN0cnVjdCBlbGZo
ZHIgZWhkcjsKPiAtCXN0cnVjdCBlbGZfaW5mbyBlbGZfaW5mbzsKPiAtCWludCByZXQ7Cj4gLQo+
IC0JcmV0ID0gYnVpbGRfZWxmX2V4ZWNfaW5mbyhidWYsIGxlbiwgJmVoZHIsICZlbGZfaW5mbyk7
Cj4gLQlpZiAocmV0KQo+IC0JCXJldHVybiByZXQ7Cj4gLQo+IC0JZWxmX2ZyZWVfaW5mbygmZWxm
X2luZm8pOwo+IC0KPiAtCXJldHVybiBlbGZfY2hlY2tfYXJjaCgmZWhkcikgPyAwIDogLUVOT0VY
RUM7Cj4gLX0KPiAtCj4gLS8qKgo+IC0gKiBlbGZfZXhlY19sb2FkIC0gbG9hZCBFTEYgZXhlY3V0
YWJsZSBpbWFnZQo+IC0gKiBAbG93ZXN0X2xvYWRfYWRkcjoJT24gcmV0dXJuLCB3aWxsIGJlIHRo
ZSBhZGRyZXNzIHdoZXJlIHRoZSBmaXJzdCBQVF9MT0FECj4gLSAqCQkJc2VjdGlvbiB3aWxsIGJl
IGxvYWRlZCBpbiBtZW1vcnkuCj4gLSAqCj4gLSAqIFJldHVybjoKPiAtICogMCBvbiBzdWNjZXNz
LCBuZWdhdGl2ZSB2YWx1ZSBvbiBmYWlsdXJlLgo+IC0gKi8KPiAtc3RhdGljIGludCBlbGZfZXhl
Y19sb2FkKHN0cnVjdCBraW1hZ2UgKmltYWdlLCBzdHJ1Y3QgZWxmaGRyICplaGRyLAo+IC0JCQkg
c3RydWN0IGVsZl9pbmZvICplbGZfaW5mbywKPiAtCQkJIHVuc2lnbmVkIGxvbmcgKmxvd2VzdF9s
b2FkX2FkZHIpCj4gLXsKPiAtCXVuc2lnbmVkIGxvbmcgYmFzZSA9IDAsIGxvd2VzdF9hZGRyID0g
VUlOVF9NQVg7Cj4gLQlpbnQgcmV0Owo+IC0Jc2l6ZV90IGk7Cj4gLQlzdHJ1Y3Qga2V4ZWNfYnVm
IGtidWYgPSB7IC5pbWFnZSA9IGltYWdlLCAuYnVmX21heCA9IHBwYzY0X3JtYV9zaXplLAo+IC0J
CQkJICAudG9wX2Rvd24gPSBmYWxzZSB9Owo+IC0KPiAtCS8qIFJlYWQgaW4gdGhlIFBUX0xPQUQg
c2VnbWVudHMuICovCj4gLQlmb3IgKGkgPSAwOyBpIDwgZWhkci0+ZV9waG51bTsgaSsrKSB7Cj4g
LQkJdW5zaWduZWQgbG9uZyBsb2FkX2FkZHI7Cj4gLQkJc2l6ZV90IHNpemU7Cj4gLQkJY29uc3Qg
c3RydWN0IGVsZl9waGRyICpwaGRyOwo+IC0KPiAtCQlwaGRyID0gJmVsZl9pbmZvLT5wcm9naGRy
c1tpXTsKPiAtCQlpZiAocGhkci0+cF90eXBlICE9IFBUX0xPQUQpCj4gLQkJCWNvbnRpbnVlOwo+
IC0KPiAtCQlzaXplID0gcGhkci0+cF9maWxlc3o7Cj4gLQkJaWYgKHNpemUgPiBwaGRyLT5wX21l
bXN6KQo+IC0JCQlzaXplID0gcGhkci0+cF9tZW1zejsKPiAtCj4gLQkJa2J1Zi5idWZmZXIgPSAo
dm9pZCAqKSBlbGZfaW5mby0+YnVmZmVyICsgcGhkci0+cF9vZmZzZXQ7Cj4gLQkJa2J1Zi5idWZz
eiA9IHNpemU7Cj4gLQkJa2J1Zi5tZW1zeiA9IHBoZHItPnBfbWVtc3o7Cj4gLQkJa2J1Zi5idWZf
YWxpZ24gPSBwaGRyLT5wX2FsaWduOwo+IC0JCWtidWYuYnVmX21pbiA9IHBoZHItPnBfcGFkZHIg
KyBiYXNlOwo+IC0JCXJldCA9IGtleGVjX2FkZF9idWZmZXIoJmtidWYpOwo+IC0JCWlmIChyZXQp
Cj4gLQkJCWdvdG8gb3V0Owo+IC0JCWxvYWRfYWRkciA9IGtidWYubWVtOwo+IC0KPiAtCQlpZiAo
bG9hZF9hZGRyIDwgbG93ZXN0X2FkZHIpCj4gLQkJCWxvd2VzdF9hZGRyID0gbG9hZF9hZGRyOwo+
IC0JfQo+IC0KPiAtCS8qIFVwZGF0ZSBlbnRyeSBwb2ludCB0byByZWZsZWN0IG5ldyBsb2FkIGFk
ZHJlc3MuICovCj4gLQllaGRyLT5lX2VudHJ5ICs9IGJhc2U7Cj4gLQo+IC0JKmxvd2VzdF9sb2Fk
X2FkZHIgPSBsb3dlc3RfYWRkcjsKPiAtCXJldCA9IDA7Cj4gLSBvdXQ6Cj4gLQlyZXR1cm4gcmV0
Owo+IC19Cj4gKyNkZWZpbmUgUFVSR0FUT1JZX1NUQUNLX1NJWkUgKDE2ICogMTAyNCkKPiAgIAo+
ICAgc3RhdGljIHZvaWQgKmVsZjY0X2xvYWQoc3RydWN0IGtpbWFnZSAqaW1hZ2UsIGNoYXIgKmtl
cm5lbF9idWYsCj4gICAJCQl1bnNpZ25lZCBsb25nIGtlcm5lbF9sZW4sIGNoYXIgKmluaXRyZCwK
PiBAQCAtNTc3LDE3ICs0NSwxNyBAQCBzdGF0aWMgdm9pZCAqZWxmNjRfbG9hZChzdHJ1Y3Qga2lt
YWdlICppbWFnZSwgY2hhciAqa2VybmVsX2J1ZiwKPiAgIAl2b2lkICpmZHQ7Cj4gICAJY29uc3Qg
dm9pZCAqc2xhdmVfY29kZTsKPiAgIAlzdHJ1Y3QgZWxmaGRyIGVoZHI7Cj4gLQlzdHJ1Y3QgZWxm
X2luZm8gZWxmX2luZm87Cj4gKwlzdHJ1Y3Qga2V4ZWNfZWxmX2luZm8gZWxmX2luZm87Cj4gICAJ
c3RydWN0IGtleGVjX2J1ZiBrYnVmID0geyAuaW1hZ2UgPSBpbWFnZSwgLmJ1Zl9taW4gPSAwLAo+
ICAgCQkJCSAgLmJ1Zl9tYXggPSBwcGM2NF9ybWFfc2l6ZSB9Owo+ICAgCXN0cnVjdCBrZXhlY19i
dWYgcGJ1ZiA9IHsgLmltYWdlID0gaW1hZ2UsIC5idWZfbWluID0gMCwKPiAgIAkJCQkgIC5idWZf
bWF4ID0gcHBjNjRfcm1hX3NpemUsIC50b3BfZG93biA9IHRydWUgfTsKPiAgIAo+IC0JcmV0ID0g
YnVpbGRfZWxmX2V4ZWNfaW5mbyhrZXJuZWxfYnVmLCBrZXJuZWxfbGVuLCAmZWhkciwgJmVsZl9p
bmZvKTsKPiArCXJldCA9IGtleGVjX2J1aWxkX2VsZl9pbmZvKGtlcm5lbF9idWYsIGtlcm5lbF9s
ZW4sICZlaGRyLCAmZWxmX2luZm8pOwo+ICAgCWlmIChyZXQpCj4gICAJCWdvdG8gb3V0Owo+ICAg
Cj4gLQlyZXQgPSBlbGZfZXhlY19sb2FkKGltYWdlLCAmZWhkciwgJmVsZl9pbmZvLCAma2VybmVs
X2xvYWRfYWRkcik7Cj4gKwlyZXQgPSBrZXhlY19lbGZfbG9hZChpbWFnZSwgJmVoZHIsICZlbGZf
aW5mbywgJmtidWYsICZrZXJuZWxfbG9hZF9hZGRyKTsKPiAgIAlpZiAocmV0KQo+ICAgCQlnb3Rv
IG91dDsKPiAgIAo+IEBAIC02MDYsNiArNzQsNyBAQCBzdGF0aWMgdm9pZCAqZWxmNjRfbG9hZChz
dHJ1Y3Qga2ltYWdlICppbWFnZSwgY2hhciAqa2VybmVsX2J1ZiwKPiAgIAkJa2J1Zi5idWZzeiA9
IGtidWYubWVtc3ogPSBpbml0cmRfbGVuOwo+ICAgCQlrYnVmLmJ1Zl9hbGlnbiA9IFBBR0VfU0la
RTsKPiAgIAkJa2J1Zi50b3BfZG93biA9IGZhbHNlOwo+ICsJCWtidWYubWVtID0gS0VYRUNfQlVG
X01FTV9VTktOT1dOOwo+ICAgCQlyZXQgPSBrZXhlY19hZGRfYnVmZmVyKCZrYnVmKTsKPiAgIAkJ
aWYgKHJldCkKPiAgIAkJCWdvdG8gb3V0Owo+IEBAIC02MzgsNiArMTA3LDcgQEAgc3RhdGljIHZv
aWQgKmVsZjY0X2xvYWQoc3RydWN0IGtpbWFnZSAqaW1hZ2UsIGNoYXIgKmtlcm5lbF9idWYsCj4g
ICAJa2J1Zi5idWZzeiA9IGtidWYubWVtc3ogPSBmZHRfc2l6ZTsKPiAgIAlrYnVmLmJ1Zl9hbGln
biA9IFBBR0VfU0laRTsKPiAgIAlrYnVmLnRvcF9kb3duID0gdHJ1ZTsKPiArCWtidWYubWVtID0g
S0VYRUNfQlVGX01FTV9VTktOT1dOOwo+ICAgCXJldCA9IGtleGVjX2FkZF9idWZmZXIoJmtidWYp
Owo+ICAgCWlmIChyZXQpCj4gICAJCWdvdG8gb3V0Owo+IEBAIC02NTIsMTMgKzEyMiwxMiBAQCBz
dGF0aWMgdm9pZCAqZWxmNjRfbG9hZChzdHJ1Y3Qga2ltYWdlICppbWFnZSwgY2hhciAqa2VybmVs
X2J1ZiwKPiAgIAkJcHJfZXJyKCJFcnJvciBzZXR0aW5nIHVwIHRoZSBwdXJnYXRvcnkuXG4iKTsK
PiAgIAo+ICAgb3V0Ogo+IC0JZWxmX2ZyZWVfaW5mbygmZWxmX2luZm8pOwo+IC0KPiArCWtleGVj
X2ZyZWVfZWxmX2luZm8oJmVsZl9pbmZvKTsKPiAgIAkvKiBNYWtlIGtpbWFnZV9maWxlX3Bvc3Rf
bG9hZF9jbGVhbnVwIGZyZWUgdGhlIGZkdCBidWZmZXIgZm9yIHVzLiAqLwo+ICAgCXJldHVybiBy
ZXQgPyBFUlJfUFRSKHJldCkgOiBmZHQ7Cj4gICB9Cj4gICAKPiAgIGNvbnN0IHN0cnVjdCBrZXhl
Y19maWxlX29wcyBrZXhlY19lbGY2NF9vcHMgPSB7Cj4gLQkucHJvYmUgPSBlbGY2NF9wcm9iZSwK
PiArCS5wcm9iZSA9IGtleGVjX2VsZl9wcm9iZSwKPiAgIAkubG9hZCA9IGVsZjY0X2xvYWQsCj4g
ICB9Owo+IGRpZmYgLS1naXQgYS9pbmNsdWRlL2xpbnV4L2tleGVjLmggYi9pbmNsdWRlL2xpbnV4
L2tleGVjLmgKPiBpbmRleCBiOWIxYmM1Zjk2NjkuLjcyNjQ4YjE4Yjc3OCAxMDA2NDQKPiAtLS0g
YS9pbmNsdWRlL2xpbnV4L2tleGVjLmgKPiArKysgYi9pbmNsdWRlL2xpbnV4L2tleGVjLmgKPiBA
QCAtMjE2LDYgKzIxNiw0MSBAQCBleHRlcm4gaW50IGNyYXNoX3ByZXBhcmVfZWxmNjRfaGVhZGVy
cyhzdHJ1Y3QgY3Jhc2hfbWVtICptZW0sIGludCBrZXJuZWxfbWFwLAo+ICAgCQkJCSAgICAgICB2
b2lkICoqYWRkciwgdW5zaWduZWQgbG9uZyAqc3opOwo+ICAgI2VuZGlmIC8qIENPTkZJR19LRVhF
Q19GSUxFICovCj4gICAKPiArI2lmZGVmIENPTkZJR19LRVhFQ19FTEYKPiArCj4gK3N0cnVjdCBr
ZXhlY19lbGZfaW5mbyB7Cj4gKwkvKgo+ICsJICogV2hlcmUgdGhlIEVMRiBiaW5hcnkgY29udGVu
dHMgYXJlIGtlcHQuCj4gKwkgKiBNZW1vcnkgbWFuYWdlZCBieSB0aGUgdXNlciBvZiB0aGUgc3Ry
dWN0Lgo+ICsJICovCj4gKwljb25zdCBjaGFyICpidWZmZXI7Cj4gKwo+ICsJY29uc3Qgc3RydWN0
IGVsZmhkciAqZWhkcjsKPiArCWNvbnN0IHN0cnVjdCBlbGZfcGhkciAqcHJvZ2hkcnM7Cj4gKwlz
dHJ1Y3QgZWxmX3NoZHIgKnNlY2hkcnM7Cj4gK307Cj4gKwo+ICt2b2lkIGtleGVjX2ZyZWVfZWxm
X2luZm8oc3RydWN0IGtleGVjX2VsZl9pbmZvICplbGZfaW5mbyk7Cj4gKwo+ICtpbnQga2V4ZWNf
YnVpbGRfZWxmX2luZm8oY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuLCBzdHJ1Y3QgZWxmaGRy
ICplaGRyLAo+ICsJCQkgIHN0cnVjdCBrZXhlY19lbGZfaW5mbyAqZWxmX2luZm8pOwo+ICsKPiAr
aW50IGtleGVjX2VsZl9rZXJuZWxfbG9hZChzdHJ1Y3Qga2ltYWdlICppbWFnZSwgc3RydWN0IGtl
eGVjX2J1ZiAqa2J1ZiwKPiArCQkJICBjaGFyICprZXJuZWxfYnVmLCB1bnNpZ25lZCBsb25nIGtl
cm5lbF9sZW4sCj4gKwkJCSAgdW5zaWduZWQgbG9uZyAqa2VybmVsX2xvYWRfYWRkcik7Cj4gKwo+
ICtpbnQga2V4ZWNfZWxmX3Byb2JlKGNvbnN0IGNoYXIgKmJ1ZiwgdW5zaWduZWQgbG9uZyBsZW4p
Owo+ICsKPiAraW50IGtleGVjX2VsZl9sb2FkKHN0cnVjdCBraW1hZ2UgKmltYWdlLCBzdHJ1Y3Qg
ZWxmaGRyICplaGRyLAo+ICsJCQkgc3RydWN0IGtleGVjX2VsZl9pbmZvICplbGZfaW5mbywKPiAr
CQkJIHN0cnVjdCBrZXhlY19idWYgKmtidWYsCj4gKwkJCSB1bnNpZ25lZCBsb25nICpsb3dlc3Rf
bG9hZF9hZGRyKTsKPiArCj4gK2ludCBrZXhlY19lbGZfbG9hZChzdHJ1Y3Qga2ltYWdlICppbWFn
ZSwgc3RydWN0IGVsZmhkciAqZWhkciwKPiArCQkJIHN0cnVjdCBrZXhlY19lbGZfaW5mbyAqZWxm
X2luZm8sCj4gKwkJCSBzdHJ1Y3Qga2V4ZWNfYnVmICprYnVmLAo+ICsJCQkgdW5zaWduZWQgbG9u
ZyAqbG93ZXN0X2xvYWRfYWRkcik7Cj4gKyNlbmRpZgo+ICAgc3RydWN0IGtpbWFnZSB7Cj4gICAJ
a2ltYWdlX2VudHJ5X3QgaGVhZDsKPiAgIAlraW1hZ2VfZW50cnlfdCAqZW50cnk7Cj4gZGlmZiAt
LWdpdCBhL2tlcm5lbC9NYWtlZmlsZSBiL2tlcm5lbC9NYWtlZmlsZQo+IGluZGV4IDMzODI0ZjAz
ODViMy4uNzA2MjMwNmRlOWI3IDEwMDY0NAo+IC0tLSBhL2tlcm5lbC9NYWtlZmlsZQo+ICsrKyBi
L2tlcm5lbC9NYWtlZmlsZQo+IEBAIC02NCw2ICs2NCw3IEBAIG9iai0kKENPTkZJR19DUkFTSF9D
T1JFKSArPSBjcmFzaF9jb3JlLm8KPiAgIG9iai0kKENPTkZJR19LRVhFQ19DT1JFKSArPSBrZXhl
Y19jb3JlLm8KPiAgIG9iai0kKENPTkZJR19LRVhFQykgKz0ga2V4ZWMubwo+ICAgb2JqLSQoQ09O
RklHX0tFWEVDX0ZJTEUpICs9IGtleGVjX2ZpbGUubwo+ICtvYmotJChDT05GSUdfS0VYRUNfRUxG
KSArPSBrZXhlY19lbGYubwo+ICAgb2JqLSQoQ09ORklHX0JBQ0tUUkFDRV9TRUxGX1RFU1QpICs9
IGJhY2t0cmFjZXRlc3Qubwo+ICAgb2JqLSQoQ09ORklHX0NPTVBBVCkgKz0gY29tcGF0Lm8KPiAg
IG9iai0kKENPTkZJR19DR1JPVVBTKSArPSBjZ3JvdXAvCj4gZGlmZiAtLWdpdCBhL2tlcm5lbC9r
ZXhlY19lbGYuYyBiL2tlcm5lbC9rZXhlY19lbGYuYwo+IG5ldyBmaWxlIG1vZGUgMTAwNjQ0Cj4g
aW5kZXggMDAwMDAwMDAwMDAwLi4wN2U1YmNjNzliYmEKPiAtLS0gL2Rldi9udWxsCj4gKysrIGIv
a2VybmVsL2tleGVjX2VsZi5jCj4gQEAgLTAsMCArMSw1NDAgQEAKPiArLy8gU1BEWC1MaWNlbnNl
LUlkZW50aWZpZXI6IEdQTC0yLjAKPiArCj4gKyNkZWZpbmUgcHJfZm10KGZtdCkJImtleGVjX2Vs
ZjogIiBmbXQKPiArCj4gKyNpbmNsdWRlIDxsaW51eC9lbGYuaD4KPiArI2luY2x1ZGUgPGxpbnV4
L2tleGVjLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9tb2R1bGUuaD4KPiArI2luY2x1ZGUgPGxpbnV4
L3NsYWIuaD4KPiArI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+Cj4gKwo+ICsKPiArc3RhdGljIGlu
bGluZSBib29sIGVsZl9pc19lbGZfZmlsZShjb25zdCBzdHJ1Y3QgZWxmaGRyICplaGRyKQo+ICt7
Cj4gKyAgICAgICByZXR1cm4gbWVtY21wKGVoZHItPmVfaWRlbnQsIEVMRk1BRywgU0VMRk1BRykg
PT0gMDsKPiArfQo+ICsKPiArc3RhdGljIHVpbnQ2NF90IGVsZjY0X3RvX2NwdShjb25zdCBzdHJ1
Y3QgZWxmaGRyICplaGRyLCB1aW50NjRfdCB2YWx1ZSkKPiArewo+ICsJaWYgKGVoZHItPmVfaWRl
bnRbRUlfREFUQV0gPT0gRUxGREFUQTJMU0IpCj4gKwkJdmFsdWUgPSBsZTY0X3RvX2NwdSh2YWx1
ZSk7Cj4gKwllbHNlIGlmIChlaGRyLT5lX2lkZW50W0VJX0RBVEFdID09IEVMRkRBVEEyTVNCKQo+
ICsJCXZhbHVlID0gYmU2NF90b19jcHUodmFsdWUpOwo+ICsKPiArCXJldHVybiB2YWx1ZTsKPiAr
fQo+ICsKPiArc3RhdGljIHVpbnQzMl90IGVsZjMyX3RvX2NwdShjb25zdCBzdHJ1Y3QgZWxmaGRy
ICplaGRyLCB1aW50MzJfdCB2YWx1ZSkKPiArewo+ICsJaWYgKGVoZHItPmVfaWRlbnRbRUlfREFU
QV0gPT0gRUxGREFUQTJMU0IpCj4gKwkJdmFsdWUgPSBsZTMyX3RvX2NwdSh2YWx1ZSk7Cj4gKwll
bHNlIGlmIChlaGRyLT5lX2lkZW50W0VJX0RBVEFdID09IEVMRkRBVEEyTVNCKQo+ICsJCXZhbHVl
ID0gYmUzMl90b19jcHUodmFsdWUpOwo+ICsKPiArCXJldHVybiB2YWx1ZTsKPiArfQo+ICsKPiAr
c3RhdGljIHVpbnQxNl90IGVsZjE2X3RvX2NwdShjb25zdCBzdHJ1Y3QgZWxmaGRyICplaGRyLCB1
aW50MTZfdCB2YWx1ZSkKPiArewo+ICsJaWYgKGVoZHItPmVfaWRlbnRbRUlfREFUQV0gPT0gRUxG
REFUQTJMU0IpCj4gKwkJdmFsdWUgPSBsZTE2X3RvX2NwdSh2YWx1ZSk7Cj4gKwllbHNlIGlmIChl
aGRyLT5lX2lkZW50W0VJX0RBVEFdID09IEVMRkRBVEEyTVNCKQo+ICsJCXZhbHVlID0gYmUxNl90
b19jcHUodmFsdWUpOwo+ICsKPiArCXJldHVybiB2YWx1ZTsKPiArfQo+ICsKPiArLyoqCj4gKyAq
IGVsZl9pc19laGRyX3NhbmUgLSBjaGVjayB0aGF0IGl0IGlzIHNhZmUgdG8gdXNlIHRoZSBFTEYg
aGVhZGVyCj4gKyAqIEBidWZfbGVuOglzaXplIG9mIHRoZSBidWZmZXIgaW4gd2hpY2ggdGhlIEVM
RiBmaWxlIGlzIGxvYWRlZC4KPiArICovCj4gK3N0YXRpYyBib29sIGVsZl9pc19laGRyX3NhbmUo
Y29uc3Qgc3RydWN0IGVsZmhkciAqZWhkciwgc2l6ZV90IGJ1Zl9sZW4pCj4gK3sKPiArCWlmIChl
aGRyLT5lX3BobnVtID4gMCAmJiBlaGRyLT5lX3BoZW50c2l6ZSAhPSBzaXplb2Yoc3RydWN0IGVs
Zl9waGRyKSkgewo+ICsJCXByX2RlYnVnKCJCYWQgcHJvZ3JhbSBoZWFkZXIgc2l6ZS5cbiIpOwo+
ICsJCXJldHVybiBmYWxzZTsKPiArCX0gZWxzZSBpZiAoZWhkci0+ZV9zaG51bSA+IDAgJiYKPiAr
CQkgICBlaGRyLT5lX3NoZW50c2l6ZSAhPSBzaXplb2Yoc3RydWN0IGVsZl9zaGRyKSkgewo+ICsJ
CXByX2RlYnVnKCJCYWQgc2VjdGlvbiBoZWFkZXIgc2l6ZS5cbiIpOwo+ICsJCXJldHVybiBmYWxz
ZTsKPiArCX0gZWxzZSBpZiAoZWhkci0+ZV9pZGVudFtFSV9WRVJTSU9OXSAhPSBFVl9DVVJSRU5U
IHx8Cj4gKwkJICAgZWhkci0+ZV92ZXJzaW9uICE9IEVWX0NVUlJFTlQpIHsKPiArCQlwcl9kZWJ1
ZygiVW5rbm93biBFTEYgdmVyc2lvbi5cbiIpOwo+ICsJCXJldHVybiBmYWxzZTsKPiArCX0KPiAr
Cj4gKwlpZiAoZWhkci0+ZV9waG9mZiA+IDAgJiYgZWhkci0+ZV9waG51bSA+IDApIHsKPiArCQlz
aXplX3QgcGhkcl9zaXplOwo+ICsKPiArCQkvKgo+ICsJCSAqIGVfcGhudW0gaXMgYXQgbW9zdCA2
NTUzNSBzbyBjYWxjdWxhdGluZyB0aGUgc2l6ZSBvZiB0aGUKPiArCQkgKiBwcm9ncmFtIGhlYWRl
ciBjYW5ub3Qgb3ZlcmZsb3cuCj4gKwkJICovCj4gKwkJcGhkcl9zaXplID0gc2l6ZW9mKHN0cnVj
dCBlbGZfcGhkcikgKiBlaGRyLT5lX3BobnVtOwo+ICsKPiArCQkvKiBTYW5pdHkgY2hlY2sgdGhl
IHByb2dyYW0gaGVhZGVyIHRhYmxlIGxvY2F0aW9uLiAqLwo+ICsJCWlmIChlaGRyLT5lX3Bob2Zm
ICsgcGhkcl9zaXplIDwgZWhkci0+ZV9waG9mZikgewo+ICsJCQlwcl9kZWJ1ZygiUHJvZ3JhbSBo
ZWFkZXJzIGF0IGludmFsaWQgbG9jYXRpb24uXG4iKTsKPiArCQkJcmV0dXJuIGZhbHNlOwo+ICsJ
CX0gZWxzZSBpZiAoZWhkci0+ZV9waG9mZiArIHBoZHJfc2l6ZSA+IGJ1Zl9sZW4pIHsKPiArCQkJ
cHJfZGVidWcoIlByb2dyYW0gaGVhZGVycyB0cnVuY2F0ZWQuXG4iKTsKPiArCQkJcmV0dXJuIGZh
bHNlOwo+ICsJCX0KPiArCX0KPiArCj4gKwlpZiAoZWhkci0+ZV9zaG9mZiA+IDAgJiYgZWhkci0+
ZV9zaG51bSA+IDApIHsKPiArCQlzaXplX3Qgc2hkcl9zaXplOwo+ICsKPiArCQkvKgo+ICsJCSAq
IGVfc2hudW0gaXMgYXQgbW9zdCA2NTUzNiBzbyBjYWxjdWxhdGluZwo+ICsJCSAqIHRoZSBzaXpl
IG9mIHRoZSBzZWN0aW9uIGhlYWRlciBjYW5ub3Qgb3ZlcmZsb3cuCj4gKwkJICovCj4gKwkJc2hk
cl9zaXplID0gc2l6ZW9mKHN0cnVjdCBlbGZfc2hkcikgKiBlaGRyLT5lX3NobnVtOwo+ICsKPiAr
CQkvKiBTYW5pdHkgY2hlY2sgdGhlIHNlY3Rpb24gaGVhZGVyIHRhYmxlIGxvY2F0aW9uLiAqLwo+
ICsJCWlmIChlaGRyLT5lX3Nob2ZmICsgc2hkcl9zaXplIDwgZWhkci0+ZV9zaG9mZikgewo+ICsJ
CQlwcl9kZWJ1ZygiU2VjdGlvbiBoZWFkZXJzIGF0IGludmFsaWQgbG9jYXRpb24uXG4iKTsKPiAr
CQkJcmV0dXJuIGZhbHNlOwo+ICsJCX0gZWxzZSBpZiAoZWhkci0+ZV9zaG9mZiArIHNoZHJfc2l6
ZSA+IGJ1Zl9sZW4pIHsKPiArCQkJcHJfZGVidWcoIlNlY3Rpb24gaGVhZGVycyB0cnVuY2F0ZWQu
XG4iKTsKPiArCQkJcmV0dXJuIGZhbHNlOwo+ICsJCX0KPiArCX0KPiArCj4gKwlyZXR1cm4gdHJ1
ZTsKPiArfQo+ICsKPiArc3RhdGljIGludCBlbGZfcmVhZF9laGRyKGNvbnN0IGNoYXIgKmJ1Ziwg
c2l6ZV90IGxlbiwgc3RydWN0IGVsZmhkciAqZWhkcikKPiArewo+ICsJc3RydWN0IGVsZmhkciAq
YnVmX2VoZHI7Cj4gKwo+ICsJaWYgKGxlbiA8IHNpemVvZigqYnVmX2VoZHIpKSB7Cj4gKwkJcHJf
ZGVidWcoIkJ1ZmZlciBpcyB0b28gc21hbGwgdG8gaG9sZCBFTEYgaGVhZGVyLlxuIik7Cj4gKwkJ
cmV0dXJuIC1FTk9FWEVDOwo+ICsJfQo+ICsKPiArCW1lbXNldChlaGRyLCAwLCBzaXplb2YoKmVo
ZHIpKTsKPiArCW1lbWNweShlaGRyLT5lX2lkZW50LCBidWYsIHNpemVvZihlaGRyLT5lX2lkZW50
KSk7Cj4gKwlpZiAoIWVsZl9pc19lbGZfZmlsZShlaGRyKSkgewo+ICsJCXByX2RlYnVnKCJObyBF
TEYgaGVhZGVyIG1hZ2ljLlxuIik7Cj4gKwkJcmV0dXJuIC1FTk9FWEVDOwo+ICsJfQo+ICsKPiAr
CWlmIChlaGRyLT5lX2lkZW50W0VJX0NMQVNTXSAhPSBFTEZfQ0xBU1MpIHsKPiArCQlwcl9kZWJ1
ZygiTm90IGEgc3VwcG9ydGVkIEVMRiBjbGFzcy5cbiIpOwo+ICsJCXJldHVybiAtRU5PRVhFQzsK
PiArCX0gZWxzZSAgaWYgKGVoZHItPmVfaWRlbnRbRUlfREFUQV0gIT0gRUxGREFUQTJMU0IgJiYK
PiArCQllaGRyLT5lX2lkZW50W0VJX0RBVEFdICE9IEVMRkRBVEEyTVNCKSB7Cj4gKwkJcHJfZGVi
dWcoIk5vdCBhIHN1cHBvcnRlZCBFTEYgZGF0YSBmb3JtYXQuXG4iKTsKPiArCQlyZXR1cm4gLUVO
T0VYRUM7Cj4gKwl9Cj4gKwo+ICsJYnVmX2VoZHIgPSAoc3RydWN0IGVsZmhkciAqKSBidWY7Cj4g
KwlpZiAoZWxmMTZfdG9fY3B1KGVoZHIsIGJ1Zl9laGRyLT5lX2Voc2l6ZSkgIT0gc2l6ZW9mKCpi
dWZfZWhkcikpIHsKPiArCQlwcl9kZWJ1ZygiQmFkIEVMRiBoZWFkZXIgc2l6ZS5cbiIpOwo+ICsJ
CXJldHVybiAtRU5PRVhFQzsKPiArCX0KPiArCj4gKwllaGRyLT5lX3R5cGUgICAgICA9IGVsZjE2
X3RvX2NwdShlaGRyLCBidWZfZWhkci0+ZV90eXBlKTsKPiArCWVoZHItPmVfbWFjaGluZSAgID0g
ZWxmMTZfdG9fY3B1KGVoZHIsIGJ1Zl9laGRyLT5lX21hY2hpbmUpOwo+ICsJZWhkci0+ZV92ZXJz
aW9uICAgPSBlbGYzMl90b19jcHUoZWhkciwgYnVmX2VoZHItPmVfdmVyc2lvbik7Cj4gKwllaGRy
LT5lX2VudHJ5ICAgICA9IGVsZjY0X3RvX2NwdShlaGRyLCBidWZfZWhkci0+ZV9lbnRyeSk7Cj4g
KwllaGRyLT5lX3Bob2ZmICAgICA9IGVsZjY0X3RvX2NwdShlaGRyLCBidWZfZWhkci0+ZV9waG9m
Zik7Cj4gKwllaGRyLT5lX3Nob2ZmICAgICA9IGVsZjY0X3RvX2NwdShlaGRyLCBidWZfZWhkci0+
ZV9zaG9mZik7Cj4gKwllaGRyLT5lX2ZsYWdzICAgICA9IGVsZjMyX3RvX2NwdShlaGRyLCBidWZf
ZWhkci0+ZV9mbGFncyk7Cj4gKwllaGRyLT5lX3BoZW50c2l6ZSA9IGVsZjE2X3RvX2NwdShlaGRy
LCBidWZfZWhkci0+ZV9waGVudHNpemUpOwo+ICsJZWhkci0+ZV9waG51bSAgICAgPSBlbGYxNl90
b19jcHUoZWhkciwgYnVmX2VoZHItPmVfcGhudW0pOwo+ICsJZWhkci0+ZV9zaGVudHNpemUgPSBl
bGYxNl90b19jcHUoZWhkciwgYnVmX2VoZHItPmVfc2hlbnRzaXplKTsKPiArCWVoZHItPmVfc2hu
dW0gICAgID0gZWxmMTZfdG9fY3B1KGVoZHIsIGJ1Zl9laGRyLT5lX3NobnVtKTsKPiArCWVoZHIt
PmVfc2hzdHJuZHggID0gZWxmMTZfdG9fY3B1KGVoZHIsIGJ1Zl9laGRyLT5lX3Noc3RybmR4KTsK
PiArCj4gKwlyZXR1cm4gZWxmX2lzX2VoZHJfc2FuZShlaGRyLCBsZW4pID8gMCA6IC1FTk9FWEVD
Owo+ICt9Cj4gKwo+ICsvKioKPiArICogZWxmX2lzX3BoZHJfc2FuZSAtIGNoZWNrIHRoYXQgaXQg
aXMgc2FmZSB0byB1c2UgdGhlIHByb2dyYW0gaGVhZGVyCj4gKyAqIEBidWZfbGVuOglzaXplIG9m
IHRoZSBidWZmZXIgaW4gd2hpY2ggdGhlIEVMRiBmaWxlIGlzIGxvYWRlZC4KPiArICovCj4gK3N0
YXRpYyBib29sIGVsZl9pc19waGRyX3NhbmUoY29uc3Qgc3RydWN0IGVsZl9waGRyICpwaGRyLCBz
aXplX3QgYnVmX2xlbikKPiArewo+ICsKPiArCWlmIChwaGRyLT5wX29mZnNldCArIHBoZHItPnBf
ZmlsZXN6IDwgcGhkci0+cF9vZmZzZXQpIHsKPiArCQlwcl9kZWJ1ZygiRUxGIHNlZ21lbnQgbG9j
YXRpb24gd3JhcHMgYXJvdW5kLlxuIik7Cj4gKwkJcmV0dXJuIGZhbHNlOwo+ICsJfSBlbHNlIGlm
IChwaGRyLT5wX29mZnNldCArIHBoZHItPnBfZmlsZXN6ID4gYnVmX2xlbikgewo+ICsJCXByX2Rl
YnVnKCJFTEYgc2VnbWVudCBub3QgaW4gZmlsZS5cbiIpOwo+ICsJCXJldHVybiBmYWxzZTsKPiAr
CX0gZWxzZSBpZiAocGhkci0+cF9wYWRkciArIHBoZHItPnBfbWVtc3ogPCBwaGRyLT5wX3BhZGRy
KSB7Cj4gKwkJcHJfZGVidWcoIkVMRiBzZWdtZW50IGFkZHJlc3Mgd3JhcHMgYXJvdW5kLlxuIik7
Cj4gKwkJcmV0dXJuIGZhbHNlOwo+ICsJfQo+ICsKPiArCXJldHVybiB0cnVlOwo+ICt9Cj4gKwo+
ICtzdGF0aWMgaW50IGVsZl9yZWFkX3BoZHIoY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuLCBz
dHJ1Y3Qga2V4ZWNfZWxmX2luZm8gKmVsZl9pbmZvLAo+ICsJCQkgaW50IGlkeCkKPiArewo+ICsJ
LyogT3ZlcnJpZGUgdGhlIGNvbnN0IGluIHByb2doZHJzLCB3ZSBhcmUgdGhlIG9uZXMgZG9pbmcg
dGhlIGxvYWRpbmcuICovCj4gKwlzdHJ1Y3QgZWxmX3BoZHIgKnBoZHIgPSAoc3RydWN0IGVsZl9w
aGRyICopICZlbGZfaW5mby0+cHJvZ2hkcnNbaWR4XTsKPiArCWNvbnN0IGNoYXIgKnBidWY7Cj4g
KwlzdHJ1Y3QgZWxmX3BoZHIgKmJ1Zl9waGRyOwo+ICsKPiArCXBidWYgPSBidWYgKyBlbGZfaW5m
by0+ZWhkci0+ZV9waG9mZiArIChpZHggKiBzaXplb2YoKmJ1Zl9waGRyKSk7Cj4gKwlidWZfcGhk
ciA9IChzdHJ1Y3QgZWxmX3BoZHIgKikgcGJ1ZjsKPiArCj4gKwlwaGRyLT5wX3R5cGUgICA9IGVs
ZjMyX3RvX2NwdShlbGZfaW5mby0+ZWhkciwgYnVmX3BoZHItPnBfdHlwZSk7Cj4gKwlwaGRyLT5w
X29mZnNldCA9IGVsZjY0X3RvX2NwdShlbGZfaW5mby0+ZWhkciwgYnVmX3BoZHItPnBfb2Zmc2V0
KTsKPiArCXBoZHItPnBfcGFkZHIgID0gZWxmNjRfdG9fY3B1KGVsZl9pbmZvLT5laGRyLCBidWZf
cGhkci0+cF9wYWRkcik7Cj4gKwlwaGRyLT5wX3ZhZGRyICA9IGVsZjY0X3RvX2NwdShlbGZfaW5m
by0+ZWhkciwgYnVmX3BoZHItPnBfdmFkZHIpOwo+ICsJcGhkci0+cF9mbGFncyAgPSBlbGYzMl90
b19jcHUoZWxmX2luZm8tPmVoZHIsIGJ1Zl9waGRyLT5wX2ZsYWdzKTsKPiArCj4gKwkvKgo+ICsJ
ICogVGhlIGZvbGxvd2luZyBmaWVsZHMgaGF2ZSBhIHR5cGUgZXF1aXZhbGVudCB0byBFbGZfQWRk
cgo+ICsJICogYm90aCBpbiAzMiBiaXQgYW5kIDY0IGJpdCBFTEYuCj4gKwkgKi8KPiArCXBoZHIt
PnBfZmlsZXN6ID0gZWxmNjRfdG9fY3B1KGVsZl9pbmZvLT5laGRyLCBidWZfcGhkci0+cF9maWxl
c3opOwo+ICsJcGhkci0+cF9tZW1zeiAgPSBlbGY2NF90b19jcHUoZWxmX2luZm8tPmVoZHIsIGJ1
Zl9waGRyLT5wX21lbXN6KTsKPiArCXBoZHItPnBfYWxpZ24gID0gZWxmNjRfdG9fY3B1KGVsZl9p
bmZvLT5laGRyLCBidWZfcGhkci0+cF9hbGlnbik7Cj4gKwo+ICsJcmV0dXJuIGVsZl9pc19waGRy
X3NhbmUocGhkciwgbGVuKSA/IDAgOiAtRU5PRVhFQzsKPiArfQo+ICsKPiArLyoqCj4gKyAqIGVs
Zl9yZWFkX3BoZHJzIC0gcmVhZCB0aGUgcHJvZ3JhbSBoZWFkZXJzIGZyb20gdGhlIGJ1ZmZlcgo+
ICsgKgo+ICsgKiBUaGlzIGZ1bmN0aW9uIGFzc3VtZXMgdGhhdCB0aGUgcHJvZ3JhbSBoZWFkZXIg
dGFibGUgd2FzIGNoZWNrZWQgZm9yIHNhbml0eS4KPiArICogVXNlIGVsZl9pc19laGRyX3NhbmUo
KSBpZiBpdCB3YXNuJ3QuCj4gKyAqLwo+ICtzdGF0aWMgaW50IGVsZl9yZWFkX3BoZHJzKGNvbnN0
IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbiwKPiArCQkJICBzdHJ1Y3Qga2V4ZWNfZWxmX2luZm8gKmVs
Zl9pbmZvKQo+ICt7Cj4gKwlzaXplX3QgcGhkcl9zaXplLCBpOwo+ICsJY29uc3Qgc3RydWN0IGVs
ZmhkciAqZWhkciA9IGVsZl9pbmZvLT5laGRyOwo+ICsKPiArCS8qCj4gKwkgKiBlX3BobnVtIGlz
IGF0IG1vc3QgNjU1MzUgc28gY2FsY3VsYXRpbmcgdGhlIHNpemUgb2YgdGhlCj4gKwkgKiBwcm9n
cmFtIGhlYWRlciBjYW5ub3Qgb3ZlcmZsb3cuCj4gKwkgKi8KPiArCXBoZHJfc2l6ZSA9IHNpemVv
ZihzdHJ1Y3QgZWxmX3BoZHIpICogZWhkci0+ZV9waG51bTsKPiArCj4gKwllbGZfaW5mby0+cHJv
Z2hkcnMgPSBremFsbG9jKHBoZHJfc2l6ZSwgR0ZQX0tFUk5FTCk7Cj4gKwlpZiAoIWVsZl9pbmZv
LT5wcm9naGRycykKPiArCQlyZXR1cm4gLUVOT01FTTsKPiArCj4gKwlmb3IgKGkgPSAwOyBpIDwg
ZWhkci0+ZV9waG51bTsgaSsrKSB7Cj4gKwkJaW50IHJldDsKPiArCj4gKwkJcmV0ID0gZWxmX3Jl
YWRfcGhkcihidWYsIGxlbiwgZWxmX2luZm8sIGkpOwo+ICsJCWlmIChyZXQpIHsKPiArCQkJa2Zy
ZWUoZWxmX2luZm8tPnByb2doZHJzKTsKPiArCQkJZWxmX2luZm8tPnByb2doZHJzID0gTlVMTDsK
PiArCQkJcmV0dXJuIHJldDsKPiArCQl9Cj4gKwl9Cj4gKwo+ICsJcmV0dXJuIDA7Cj4gK30KPiAr
Cj4gKy8qKgo+ICsgKiBlbGZfaXNfc2hkcl9zYW5lIC0gY2hlY2sgdGhhdCBpdCBpcyBzYWZlIHRv
IHVzZSB0aGUgc2VjdGlvbiBoZWFkZXIKPiArICogQGJ1Zl9sZW46CXNpemUgb2YgdGhlIGJ1ZmZl
ciBpbiB3aGljaCB0aGUgRUxGIGZpbGUgaXMgbG9hZGVkLgo+ICsgKi8KPiArc3RhdGljIGJvb2wg
ZWxmX2lzX3NoZHJfc2FuZShjb25zdCBzdHJ1Y3QgZWxmX3NoZHIgKnNoZHIsIHNpemVfdCBidWZf
bGVuKQo+ICt7Cj4gKwlib29sIHNpemVfb2s7Cj4gKwo+ICsJLyogU0hUX05VTEwgaGVhZGVycyBo
YXZlIHVuZGVmaW5lZCB2YWx1ZXMsIHNvIHdlIGNhbid0IGNoZWNrIHRoZW0uICovCj4gKwlpZiAo
c2hkci0+c2hfdHlwZSA9PSBTSFRfTlVMTCkKPiArCQlyZXR1cm4gdHJ1ZTsKPiArCj4gKwkvKiBO
b3cgdmVyaWZ5IHNoX2VudHNpemUgKi8KPiArCXN3aXRjaCAoc2hkci0+c2hfdHlwZSkgewo+ICsJ
Y2FzZSBTSFRfU1lNVEFCOgo+ICsJCXNpemVfb2sgPSBzaGRyLT5zaF9lbnRzaXplID09IHNpemVv
ZihFbGZfU3ltKTsKPiArCQlicmVhazsKPiArCWNhc2UgU0hUX1JFTEE6Cj4gKwkJc2l6ZV9vayA9
IHNoZHItPnNoX2VudHNpemUgPT0gc2l6ZW9mKEVsZjY0X1JlbGEpOwo+ICsJCWJyZWFrOwo+ICsJ
Y2FzZSBTSFRfRFlOQU1JQzoKPiArCQlzaXplX29rID0gc2hkci0+c2hfZW50c2l6ZSA9PSBzaXpl
b2YoRWxmX0R5bik7Cj4gKwkJYnJlYWs7Cj4gKwljYXNlIFNIVF9SRUw6Cj4gKwkJc2l6ZV9vayA9
IHNoZHItPnNoX2VudHNpemUgPT0gc2l6ZW9mKEVsZjY0X1JlbCk7Cj4gKwkJYnJlYWs7Cj4gKwlj
YXNlIFNIVF9OT1RFOgo+ICsJY2FzZSBTSFRfUFJPR0JJVFM6Cj4gKwljYXNlIFNIVF9IQVNIOgo+
ICsJY2FzZSBTSFRfTk9CSVRTOgo+ICsJZGVmYXVsdDoKPiArCQkvKgo+ICsJCSAqIFRoaXMgaXMg
YSBzZWN0aW9uIHdob3NlIGVudHNpemUgcmVxdWlyZW1lbnRzCj4gKwkJICogSSBkb24ndCBjYXJl
IGFib3V0LiAgSWYgSSBkb24ndCBrbm93IGFib3V0Cj4gKwkJICogdGhlIHNlY3Rpb24gSSBjYW4n
dCBjYXJlIGFib3V0IGl0J3MgZW50c2l6ZQo+ICsJCSAqIHJlcXVpcmVtZW50cy4KPiArCQkgKi8K
PiArCQlzaXplX29rID0gdHJ1ZTsKPiArCQlicmVhazsKPiArCX0KPiArCj4gKwlpZiAoIXNpemVf
b2spIHsKPiArCQlwcl9kZWJ1ZygiRUxGIHNlY3Rpb24gd2l0aCB3cm9uZyBlbnRyeSBzaXplLlxu
Iik7Cj4gKwkJcmV0dXJuIGZhbHNlOwo+ICsJfSBlbHNlIGlmIChzaGRyLT5zaF9hZGRyICsgc2hk
ci0+c2hfc2l6ZSA8IHNoZHItPnNoX2FkZHIpIHsKPiArCQlwcl9kZWJ1ZygiRUxGIHNlY3Rpb24g
YWRkcmVzcyB3cmFwcyBhcm91bmQuXG4iKTsKPiArCQlyZXR1cm4gZmFsc2U7Cj4gKwl9Cj4gKwo+
ICsJaWYgKHNoZHItPnNoX3R5cGUgIT0gU0hUX05PQklUUykgewo+ICsJCWlmIChzaGRyLT5zaF9v
ZmZzZXQgKyBzaGRyLT5zaF9zaXplIDwgc2hkci0+c2hfb2Zmc2V0KSB7Cj4gKwkJCXByX2RlYnVn
KCJFTEYgc2VjdGlvbiBsb2NhdGlvbiB3cmFwcyBhcm91bmQuXG4iKTsKPiArCQkJcmV0dXJuIGZh
bHNlOwo+ICsJCX0gZWxzZSBpZiAoc2hkci0+c2hfb2Zmc2V0ICsgc2hkci0+c2hfc2l6ZSA+IGJ1
Zl9sZW4pIHsKPiArCQkJcHJfZGVidWcoIkVMRiBzZWN0aW9uIG5vdCBpbiBmaWxlLlxuIik7Cj4g
KwkJCXJldHVybiBmYWxzZTsKPiArCQl9Cj4gKwl9Cj4gKwo+ICsJcmV0dXJuIHRydWU7Cj4gK30K
PiArCj4gK3N0YXRpYyBpbnQgZWxmX3JlYWRfc2hkcihjb25zdCBjaGFyICpidWYsIHNpemVfdCBs
ZW4sIHN0cnVjdCBrZXhlY19lbGZfaW5mbyAqZWxmX2luZm8sCj4gKwkJCSBpbnQgaWR4KQo+ICt7
Cj4gKwlzdHJ1Y3QgZWxmX3NoZHIgKnNoZHIgPSAmZWxmX2luZm8tPnNlY2hkcnNbaWR4XTsKPiAr
CWNvbnN0IHN0cnVjdCBlbGZoZHIgKmVoZHIgPSBlbGZfaW5mby0+ZWhkcjsKPiArCWNvbnN0IGNo
YXIgKnNidWY7Cj4gKwlzdHJ1Y3QgZWxmX3NoZHIgKmJ1Zl9zaGRyOwo+ICsKPiArCXNidWYgPSBi
dWYgKyBlaGRyLT5lX3Nob2ZmICsgaWR4ICogc2l6ZW9mKCpidWZfc2hkcik7Cj4gKwlidWZfc2hk
ciA9IChzdHJ1Y3QgZWxmX3NoZHIgKikgc2J1ZjsKPiArCj4gKwlzaGRyLT5zaF9uYW1lICAgICAg
PSBlbGYzMl90b19jcHUoZWhkciwgYnVmX3NoZHItPnNoX25hbWUpOwo+ICsJc2hkci0+c2hfdHlw
ZSAgICAgID0gZWxmMzJfdG9fY3B1KGVoZHIsIGJ1Zl9zaGRyLT5zaF90eXBlKTsKPiArCXNoZHIt
PnNoX2FkZHIgICAgICA9IGVsZjY0X3RvX2NwdShlaGRyLCBidWZfc2hkci0+c2hfYWRkcik7Cj4g
KwlzaGRyLT5zaF9vZmZzZXQgICAgPSBlbGY2NF90b19jcHUoZWhkciwgYnVmX3NoZHItPnNoX29m
ZnNldCk7Cj4gKwlzaGRyLT5zaF9saW5rICAgICAgPSBlbGYzMl90b19jcHUoZWhkciwgYnVmX3No
ZHItPnNoX2xpbmspOwo+ICsJc2hkci0+c2hfaW5mbyAgICAgID0gZWxmMzJfdG9fY3B1KGVoZHIs
IGJ1Zl9zaGRyLT5zaF9pbmZvKTsKPiArCj4gKwkvKgo+ICsJICogVGhlIGZvbGxvd2luZyBmaWVs
ZHMgaGF2ZSBhIHR5cGUgZXF1aXZhbGVudCB0byBFbGZfQWRkcgo+ICsJICogYm90aCBpbiAzMiBi
aXQgYW5kIDY0IGJpdCBFTEYuCj4gKwkgKi8KPiArCXNoZHItPnNoX2ZsYWdzICAgICA9IGVsZjY0
X3RvX2NwdShlaGRyLCBidWZfc2hkci0+c2hfZmxhZ3MpOwo+ICsJc2hkci0+c2hfc2l6ZSAgICAg
ID0gZWxmNjRfdG9fY3B1KGVoZHIsIGJ1Zl9zaGRyLT5zaF9zaXplKTsKPiArCXNoZHItPnNoX2Fk
ZHJhbGlnbiA9IGVsZjY0X3RvX2NwdShlaGRyLCBidWZfc2hkci0+c2hfYWRkcmFsaWduKTsKPiAr
CXNoZHItPnNoX2VudHNpemUgICA9IGVsZjY0X3RvX2NwdShlaGRyLCBidWZfc2hkci0+c2hfZW50
c2l6ZSk7Cj4gKwo+ICsJcmV0dXJuIGVsZl9pc19zaGRyX3NhbmUoc2hkciwgbGVuKSA/IDAgOiAt
RU5PRVhFQzsKPiArfQo+ICsKPiArLyoqCj4gKyAqIGVsZl9yZWFkX3NoZHJzIC0gcmVhZCB0aGUg
c2VjdGlvbiBoZWFkZXJzIGZyb20gdGhlIGJ1ZmZlcgo+ICsgKgo+ICsgKiBUaGlzIGZ1bmN0aW9u
IGFzc3VtZXMgdGhhdCB0aGUgc2VjdGlvbiBoZWFkZXIgdGFibGUgd2FzIGNoZWNrZWQgZm9yIHNh
bml0eS4KPiArICogVXNlIGVsZl9pc19laGRyX3NhbmUoKSBpZiBpdCB3YXNuJ3QuCj4gKyAqLwo+
ICtzdGF0aWMgaW50IGVsZl9yZWFkX3NoZHJzKGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbiwK
PiArCQkJICBzdHJ1Y3Qga2V4ZWNfZWxmX2luZm8gKmVsZl9pbmZvKQo+ICt7Cj4gKwlzaXplX3Qg
c2hkcl9zaXplLCBpOwo+ICsKPiArCS8qCj4gKwkgKiBlX3NobnVtIGlzIGF0IG1vc3QgNjU1MzYg
c28gY2FsY3VsYXRpbmcKPiArCSAqIHRoZSBzaXplIG9mIHRoZSBzZWN0aW9uIGhlYWRlciBjYW5u
b3Qgb3ZlcmZsb3cuCj4gKwkgKi8KPiArCXNoZHJfc2l6ZSA9IHNpemVvZihzdHJ1Y3QgZWxmX3No
ZHIpICogZWxmX2luZm8tPmVoZHItPmVfc2hudW07Cj4gKwo+ICsJZWxmX2luZm8tPnNlY2hkcnMg
PSBremFsbG9jKHNoZHJfc2l6ZSwgR0ZQX0tFUk5FTCk7Cj4gKwlpZiAoIWVsZl9pbmZvLT5zZWNo
ZHJzKQo+ICsJCXJldHVybiAtRU5PTUVNOwo+ICsKPiArCWZvciAoaSA9IDA7IGkgPCBlbGZfaW5m
by0+ZWhkci0+ZV9zaG51bTsgaSsrKSB7Cj4gKwkJaW50IHJldDsKPiArCj4gKwkJcmV0ID0gZWxm
X3JlYWRfc2hkcihidWYsIGxlbiwgZWxmX2luZm8sIGkpOwo+ICsJCWlmIChyZXQpIHsKPiArCQkJ
a2ZyZWUoZWxmX2luZm8tPnNlY2hkcnMpOwo+ICsJCQllbGZfaW5mby0+c2VjaGRycyA9IE5VTEw7
Cj4gKwkJCXJldHVybiByZXQ7Cj4gKwkJfQo+ICsJfQo+ICsKPiArCXJldHVybiAwOwo+ICt9Cj4g
Kwo+ICsvKioKPiArICogZWxmX3JlYWRfZnJvbV9idWZmZXIgLSByZWFkIEVMRiBmaWxlIGFuZCBz
ZXRzIHVwIEVMRiBoZWFkZXIgYW5kIEVMRiBpbmZvCj4gKyAqIEBidWY6CUJ1ZmZlciB0byByZWFk
IEVMRiBmaWxlIGZyb20uCj4gKyAqIEBsZW46CVNpemUgb2YgQGJ1Zi4KPiArICogQGVoZHI6CVBv
aW50ZXIgdG8gZXhpc3Rpbmcgc3RydWN0IHdoaWNoIHdpbGwgYmUgcG9wdWxhdGVkLgo+ICsgKiBA
ZWxmX2luZm86CVBvaW50ZXIgdG8gZXhpc3Rpbmcgc3RydWN0IHdoaWNoIHdpbGwgYmUgcG9wdWxh
dGVkLgo+ICsgKgo+ICsgKiBUaGlzIGZ1bmN0aW9uIGFsbG93cyByZWFkaW5nIEVMRiBmaWxlcyB3
aXRoIGRpZmZlcmVudCBieXRlIG9yZGVyIHRoYW4KPiArICogdGhlIGtlcm5lbCwgYnl0ZS1zd2Fw
cGluZyB0aGUgZmllbGRzIGFzIG5lZWRlZC4KPiArICoKPiArICogUmV0dXJuOgo+ICsgKiBPbiBz
dWNjZXNzIHJldHVybnMgMCwgYW5kIHRoZSBjYWxsZXIgc2hvdWxkIGNhbGwga2V4ZWNfZnJlZV9l
bGZfaW5mbyhlbGZfaW5mbykgdG8KPiArICogZnJlZSB0aGUgbWVtb3J5IGFsbG9jYXRlZCBmb3Ig
dGhlIHNlY3Rpb24gYW5kIHByb2dyYW0gaGVhZGVycy4KPiArICovCj4gK2ludCBlbGZfcmVhZF9m
cm9tX2J1ZmZlcihjb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4sIHN0cnVjdCBlbGZoZHIgKmVo
ZHIsCj4gKwkJCSBzdHJ1Y3Qga2V4ZWNfZWxmX2luZm8gKmVsZl9pbmZvKQo+ICt7Cj4gKwlpbnQg
cmV0Owo+ICsKPiArCXJldCA9IGVsZl9yZWFkX2VoZHIoYnVmLCBsZW4sIGVoZHIpOwo+ICsJaWYg
KHJldCkKPiArCQlyZXR1cm4gcmV0Owo+ICsKPiArCWVsZl9pbmZvLT5idWZmZXIgPSBidWY7Cj4g
KwllbGZfaW5mby0+ZWhkciA9IGVoZHI7Cj4gKwlpZiAoZWhkci0+ZV9waG9mZiA+IDAgJiYgZWhk
ci0+ZV9waG51bSA+IDApIHsKPiArCQlyZXQgPSBlbGZfcmVhZF9waGRycyhidWYsIGxlbiwgZWxm
X2luZm8pOwo+ICsJCWlmIChyZXQpCj4gKwkJCXJldHVybiByZXQ7Cj4gKwl9Cj4gKwlpZiAoZWhk
ci0+ZV9zaG9mZiA+IDAgJiYgZWhkci0+ZV9zaG51bSA+IDApIHsKPiArCQlyZXQgPSBlbGZfcmVh
ZF9zaGRycyhidWYsIGxlbiwgZWxmX2luZm8pOwo+ICsJCWlmIChyZXQpIHsKPiArCQkJa2ZyZWUo
ZWxmX2luZm8tPnByb2doZHJzKTsKPiArCQkJcmV0dXJuIHJldDsKPiArCQl9Cj4gKwl9Cj4gKwo+
ICsJcmV0dXJuIDA7Cj4gK30KPiArCj4gKy8qKgo+ICsgKiBrZXhlY19mcmVlX2VsZl9pbmZvIC0g
ZnJlZSBtZW1vcnkgYWxsb2NhdGVkIGJ5IGVsZl9yZWFkX2Zyb21fYnVmZmVyCj4gKyAqLwo+ICt2
b2lkIGtleGVjX2ZyZWVfZWxmX2luZm8oc3RydWN0IGtleGVjX2VsZl9pbmZvICplbGZfaW5mbykK
PiArewo+ICsJa2ZyZWUoZWxmX2luZm8tPnByb2doZHJzKTsKPiArCW1lbXNldChlbGZfaW5mbywg
MCwgc2l6ZW9mKCplbGZfaW5mbykpOwo+ICt9Cj4gKwo+ICsvKioKPiArICoga2V4ZWNfYnVpbGRf
ZWxmX2luZm8gLSByZWFkIEVMRiBleGVjdXRhYmxlIGFuZCBjaGVjayB0aGF0IHdlIGNhbiB1c2Ug
aXQKPiArICovCj4gK2ludCBrZXhlY19idWlsZF9lbGZfaW5mbyhjb25zdCBjaGFyICpidWYsIHNp
emVfdCBsZW4sIHN0cnVjdCBlbGZoZHIgKmVoZHIsCj4gKwkJCSAgc3RydWN0IGtleGVjX2VsZl9p
bmZvICplbGZfaW5mbykKPiArewo+ICsJaW50IGk7Cj4gKwlpbnQgcmV0Owo+ICsKPiArCXJldCA9
IGVsZl9yZWFkX2Zyb21fYnVmZmVyKGJ1ZiwgbGVuLCBlaGRyLCBlbGZfaW5mbyk7Cj4gKwlpZiAo
cmV0KQo+ICsJCXJldHVybiByZXQ7Cj4gKwo+ICsJLyogQmlnIGVuZGlhbiB2bWxpbnV4IGhhcyB0
eXBlIEVUX0RZTi4gKi8KPiArCWlmIChlaGRyLT5lX3R5cGUgIT0gRVRfRVhFQyAmJiBlaGRyLT5l
X3R5cGUgIT0gRVRfRFlOKSB7Cj4gKwkJcHJfZXJyKCJOb3QgYW4gRUxGIGV4ZWN1dGFibGUuXG4i
KTsKPiArCQlnb3RvIGVycm9yOwo+ICsJfSBlbHNlIGlmICghZWxmX2luZm8tPnByb2doZHJzKSB7
Cj4gKwkJcHJfZXJyKCJObyBFTEYgcHJvZ3JhbSBoZWFkZXIuXG4iKTsKPiArCQlnb3RvIGVycm9y
Owo+ICsJfQo+ICsKPiArCWZvciAoaSA9IDA7IGkgPCBlaGRyLT5lX3BobnVtOyBpKyspIHsKPiAr
CQkvKgo+ICsJCSAqIEtleGVjIGRvZXMgbm90IHN1cHBvcnQgbG9hZGluZyBpbnRlcnByZXRlcnMu
Cj4gKwkJICogSW4gYWRkaXRpb24gdGhpcyBjaGVjayBrZWVwcyB1cyBmcm9tIGF0dGVtcHRpbmcK
PiArCQkgKiB0byBrZXhlYyBvcmRpbmF5IGV4ZWN1dGFibGVzLgo+ICsJCSAqLwo+ICsJCWlmIChl
bGZfaW5mby0+cHJvZ2hkcnNbaV0ucF90eXBlID09IFBUX0lOVEVSUCkgewo+ICsJCQlwcl9lcnIo
IlJlcXVpcmVzIGFuIEVMRiBpbnRlcnByZXRlci5cbiIpOwo+ICsJCQlnb3RvIGVycm9yOwo+ICsJ
CX0KPiArCX0KPiArCj4gKwlyZXR1cm4gMDsKPiArZXJyb3I6Cj4gKwlrZXhlY19mcmVlX2VsZl9p
bmZvKGVsZl9pbmZvKTsKPiArCXJldHVybiAtRU5PRVhFQzsKPiArfQo+ICsKPiArLyoqCj4gKyAq
IGVsZl9leGVjX2xvYWQgLSBsb2FkIEVMRiBleGVjdXRhYmxlIGltYWdlCj4gKyAqIEBsb3dlc3Rf
bG9hZF9hZGRyOglPbiByZXR1cm4sIHdpbGwgYmUgdGhlIGFkZHJlc3Mgd2hlcmUgdGhlIGZpcnN0
IFBUX0xPQUQKPiArICoJCQlzZWN0aW9uIHdpbGwgYmUgbG9hZGVkIGluIG1lbW9yeS4KPiArICoK
PiArICogUmV0dXJuOgo+ICsgKiAwIG9uIHN1Y2Nlc3MsIG5lZ2F0aXZlIHZhbHVlIG9uIGZhaWx1
cmUuCj4gKyAqLwo+ICtpbnQga2V4ZWNfZWxmX2xvYWQoc3RydWN0IGtpbWFnZSAqaW1hZ2UsIHN0
cnVjdCBlbGZoZHIgKmVoZHIsCj4gKwkJICAgc3RydWN0IGtleGVjX2VsZl9pbmZvICplbGZfaW5m
bywKPiArCQkgICBzdHJ1Y3Qga2V4ZWNfYnVmICprYnVmLAo+ICsJCSAgIHVuc2lnbmVkIGxvbmcg
Kmxvd2VzdF9sb2FkX2FkZHIpCj4gK3sKPiArCXVuc2lnbmVkIGxvbmcgbG93ZXN0X2FkZHIgPSBV
SU5UX01BWDsKPiArCWludCByZXQ7Cj4gKwlzaXplX3QgaTsKPiArCS8qIFJlYWQgaW4gdGhlIFBU
X0xPQUQgc2VnbWVudHMuICovCj4gKwlmb3IgKGkgPSAwOyBpIDwgZWhkci0+ZV9waG51bTsgaSsr
KSB7Cj4gKwkJdW5zaWduZWQgbG9uZyBsb2FkX2FkZHI7Cj4gKwkJc2l6ZV90IHNpemU7Cj4gKwkJ
Y29uc3Qgc3RydWN0IGVsZl9waGRyICpwaGRyOwo+ICsKPiArCQlwaGRyID0gJmVsZl9pbmZvLT5w
cm9naGRyc1tpXTsKPiArCQlpZiAocGhkci0+cF90eXBlICE9IFBUX0xPQUQpCj4gKwkJCWNvbnRp
bnVlOwo+ICsKPiArCQlzaXplID0gcGhkci0+cF9maWxlc3o7Cj4gKwkJaWYgKHNpemUgPiBwaGRy
LT5wX21lbXN6KQo+ICsJCQlzaXplID0gcGhkci0+cF9tZW1zejsKPiArCj4gKwkJa2J1Zi0+YnVm
ZmVyID0gKHZvaWQgKikgZWxmX2luZm8tPmJ1ZmZlciArIHBoZHItPnBfb2Zmc2V0Owo+ICsJCWti
dWYtPmJ1ZnN6ID0gc2l6ZTsKPiArCQlrYnVmLT5tZW1zeiA9IHBoZHItPnBfbWVtc3o7Cj4gKwkJ
a2J1Zi0+YnVmX2FsaWduID0gcGhkci0+cF9hbGlnbjsKPiArCQlrYnVmLT5idWZfbWluID0gcGhk
ci0+cF9wYWRkcjsKPiArCQlrYnVmLT5tZW0gPSBLRVhFQ19CVUZfTUVNX1VOS05PV047Cj4gKwkJ
cmV0ID0ga2V4ZWNfYWRkX2J1ZmZlcihrYnVmKTsKPiArCQlpZiAocmV0KQo+ICsJCQlnb3RvIG91
dDsKPiArCQlsb2FkX2FkZHIgPSBrYnVmLT5tZW07Cj4gKwo+ICsJCWlmIChsb2FkX2FkZHIgPCBs
b3dlc3RfYWRkcikKPiArCQkJbG93ZXN0X2FkZHIgPSBsb2FkX2FkZHI7Cj4gKwl9Cj4gKwo+ICsJ
aW1hZ2UtPnN0YXJ0ID0gZWhkci0+ZV9lbnRyeTsKPiArCSpsb3dlc3RfbG9hZF9hZGRyID0gbG93
ZXN0X2FkZHI7Cj4gKwlyZXQgPSAwOwo+ICsgb3V0Ogo+ICsJcmV0dXJuIHJldDsKPiArfQo+ICsK
PiAraW50IGtleGVjX2VsZl9rZXJuZWxfbG9hZChzdHJ1Y3Qga2ltYWdlICppbWFnZSwgc3RydWN0
IGtleGVjX2J1ZiAqa2J1ZiwKPiArCQkJY2hhciAqa2VybmVsX2J1ZiwgdW5zaWduZWQgbG9uZyBr
ZXJuZWxfbGVuLAo+ICsJCQl1bnNpZ25lZCBsb25nICprZXJuZWxfbG9hZF9hZGRyKQo+ICt7Cj4g
KwlpbnQgcmV0Owo+ICsJc3RydWN0IGVsZmhkciBlaGRyOwo+ICsJc3RydWN0IGtleGVjX2VsZl9p
bmZvIGVsZl9pbmZvOwo+ICsKPiArCXJldCA9IGtleGVjX2J1aWxkX2VsZl9pbmZvKGtlcm5lbF9i
dWYsIGtlcm5lbF9sZW4sICZlaGRyLCAmZWxmX2luZm8pOwo+ICsJaWYgKHJldCkKPiArCQlnb3Rv
IG91dDsKPiArCj4gKwlyZXQgPSBrZXhlY19lbGZfbG9hZChpbWFnZSwgJmVoZHIsICZlbGZfaW5m
bywga2J1Ziwga2VybmVsX2xvYWRfYWRkcik7Cj4gK291dDoKPiArCWtleGVjX2ZyZWVfZWxmX2lu
Zm8oJmVsZl9pbmZvKTsKPiArCXJldHVybiByZXQ7Cj4gKwo+ICt9Cj4gKwo+ICtpbnQga2V4ZWNf
ZWxmX3Byb2JlKGNvbnN0IGNoYXIgKmJ1ZiwgdW5zaWduZWQgbG9uZyBsZW4pCj4gK3sKPiArCXN0
cnVjdCBlbGZoZHIgZWhkcjsKPiArCXN0cnVjdCBrZXhlY19lbGZfaW5mbyBlbGZfaW5mbzsKPiAr
CWludCByZXQ7Cj4gKwo+ICsJcmV0ID0ga2V4ZWNfYnVpbGRfZWxmX2luZm8oYnVmLCBsZW4sICZl
aGRyLCAmZWxmX2luZm8pOwo+ICsJaWYgKHJldCkKPiArCQlyZXR1cm4gcmV0Owo+ICsKPiArCWtl
eGVjX2ZyZWVfZWxmX2luZm8oJmVsZl9pbmZvKTsKPiArCj4gKwlyZXR1cm4gZWxmX2NoZWNrX2Fy
Y2goJmVoZHIpID8gMCA6IC1FTk9FWEVDOwo+ICt9Cj4gCgoKCl9fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fCmtleGVjIG1haWxpbmcgbGlzdAprZXhlY0BsaXN0
cy5pbmZyYWRlYWQub3JnCmh0dHA6Ly9saXN0cy5pbmZyYWRlYWQub3JnL21haWxtYW4vbGlzdGlu
Zm8va2V4ZWMK
