Return-Path: <kexec-bounces+lists+kexec=lfdr.de@lists.infradead.org>
X-Original-To: lists+kexec@lfdr.de
Delivered-To: lists+kexec@lfdr.de
Received: from bombadil.infradead.org (bombadil.infradead.org [IPv6:2607:7c80:54:e::133])
	by mail.lfdr.de (Postfix) with ESMTPS id 137CB61D28
	for <lists+kexec@lfdr.de>; Mon,  8 Jul 2019 12:41:27 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed;
	d=lists.infradead.org; s=bombadil.20170209; h=Sender:Content-Type:
	Content-Transfer-Encoding:Cc:List-Subscribe:List-Help:List-Post:List-Archive:
	List-Unsubscribe:List-Id:In-Reply-To:MIME-Version:Date:Message-ID:References:
	To:From:Subject:Reply-To:Content-ID:Content-Description:Resent-Date:
	Resent-From:Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:List-Owner;
	 bh=NcJkEfk90H9wbOREH8lNr6bqGKGT7qhQfpMhneZtdmk=; b=LMZxle4djNzvmXaaTXn0NB5ir
	YqqhBerYbb9UZNt2L/hwJRzIPy1nPiTLQ8sZNCyhXvt8YKch/smQKCbSFeg1TPTEv1j+ncpDXww8c
	nNGEY5gagK9XmemrzF7Usg0TJsxiZGLV1yMkRSOKG7PRmPskFz/fJanrwkyjCiC2U9kMxZW/03/4k
	HHRQjxxoTQpz6II+4hamu2BWjcdVsdFTrE/QfmLRCt2ROo456XIzx5gboXA3P8nOaYQPjrbG2adUo
	Eo+vhLvWbbiMScm447vNhIRnxJ6rlV3wANFNg3EVR1LSsZ/ZhPW8XYsYzAul+MFwEjDhBStgPOCpP
	gaMAWyoVQ==;
Received: from localhost ([127.0.0.1] helo=bombadil.infradead.org)
	by bombadil.infradead.org with esmtp (Exim 4.92 #3 (Red Hat Linux))
	id 1hkR55-0001oe-38; Mon, 08 Jul 2019 10:41:11 +0000
Received: from pegase1.c-s.fr ([93.17.236.30])
 by bombadil.infradead.org with esmtps (Exim 4.92 #3 (Red Hat Linux))
 id 1hkR4v-0001nw-Fo
 for kexec@lists.infradead.org; Mon, 08 Jul 2019 10:41:04 +0000
Received: from localhost (mailhub1-int [192.168.12.234])
 by localhost (Postfix) with ESMTP id 45j26S0h9Nz9tyfW;
 Mon,  8 Jul 2019 12:40:48 +0200 (CEST)
Authentication-Results: localhost; dkim=pass
 reason="1024-bit key; insecure key"
 header.d=c-s.fr header.i=@c-s.fr header.b=RKEi0GCE; dkim-adsp=pass;
 dkim-atps=neutral
X-Virus-Scanned: Debian amavisd-new at c-s.fr
Received: from pegase1.c-s.fr ([192.168.12.234])
 by localhost (pegase1.c-s.fr [192.168.12.234]) (amavisd-new, port 10024)
 with ESMTP id EyagA4G-sdlp; Mon,  8 Jul 2019 12:40:48 +0200 (CEST)
Received: from messagerie.si.c-s.fr (messagerie.si.c-s.fr [192.168.25.192])
 by pegase1.c-s.fr (Postfix) with ESMTP id 45j26R6f5Nz9tyfT;
 Mon,  8 Jul 2019 12:40:47 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=c-s.fr; s=mail;
 t=1562582447; bh=ZqV/7ZEJOMnL7h1ceiT0PFI14kJH+6PjysoOgp0duzE=;
 h=Subject:From:To:Cc:References:Date:In-Reply-To:From;
 b=RKEi0GCE6Y9ns7LPPMj5P8jT9BnOYeoKYM7+LPbTYsi/BDD+DNqSo5Np/A+tbOiV8
 7UTVBaWyt3Ar+UVJSLmysV6EWsPohI/lw5DAXBKtJ0y9Y+82V8wZGmyTSoMguD+SZr
 Q2rltsfe5DN1FZPCN6UVHOmFaSwa+4qcWD4udYOg=
Received: from localhost (localhost [127.0.0.1])
 by messagerie.si.c-s.fr (Postfix) with ESMTP id BCD088B79B;
 Mon,  8 Jul 2019 12:40:52 +0200 (CEST)
X-Virus-Scanned: amavisd-new at c-s.fr
Received: from messagerie.si.c-s.fr ([127.0.0.1])
 by localhost (messagerie.si.c-s.fr [127.0.0.1]) (amavisd-new, port 10023)
 with ESMTP id hk-8gR4csuYm; Mon,  8 Jul 2019 12:40:52 +0200 (CEST)
Received: from [172.25.230.102] (po15451.idsi0.si.c-s.fr [172.25.230.102])
 by messagerie.si.c-s.fr (Postfix) with ESMTP id 8A2B98B76F;
 Mon,  8 Jul 2019 12:40:52 +0200 (CEST)
Subject: Re: [PATCH using git format-patch -C] kexec: add generic support for
 elf kernel images
From: Christophe Leroy <christophe.leroy@c-s.fr>
To: kexec@lists.infradead.org, Sven Schnelle <svens@stackframe.org>
References: <20190708100624.EBCDF68DB2@pc17473vm.idsi0.si.c-s.fr>
Message-ID: <e016c0bb-c857-b78c-a159-120e42d0db03@c-s.fr>
Date: Mon, 8 Jul 2019 12:40:52 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:60.0) Gecko/20100101
 Thunderbird/60.7.2
MIME-Version: 1.0
In-Reply-To: <20190708100624.EBCDF68DB2@pc17473vm.idsi0.si.c-s.fr>
Content-Language: fr
X-CRM114-Version: 20100106-BlameMichelson ( TRE 0.8.0 (BSD) ) MR-646709E3 
X-CRM114-CacheID: sfid-20190708_034101_906870_35B14606 
X-CRM114-Status: GOOD (  27.96  )
X-Spam-Score: -0.2 (/)
X-Spam-Report: SpamAssassin version 3.4.2 on bombadil.infradead.org summary:
 Content analysis details:   (-0.2 points)
 pts rule name              description
 ---- ---------------------- --------------------------------------------------
 -0.0 RCVD_IN_DNSWL_NONE     RBL: Sender listed at https://www.dnswl.org/,
 no trust [93.17.236.30 listed in list.dnswl.org]
 0.0 SPF_HELO_NONE          SPF: HELO does not publish an SPF Record
 -0.0 SPF_PASS               SPF: sender matches SPF record
 0.1 DKIM_SIGNED            Message has a DKIM or DK signature, not necessarily
 valid
 -0.1 DKIM_VALID_AU          Message has a valid DKIM or DK signature from
 author's domain
 -0.1 DKIM_VALID_EF          Message has a valid DKIM or DK signature from
 envelope-from domain
 -0.1 DKIM_VALID Message has at least one valid DKIM or DK signature
X-BeenThere: kexec@lists.infradead.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <kexec.lists.infradead.org>
List-Unsubscribe: <http://lists.infradead.org/mailman/options/kexec>,
 <mailto:kexec-request@lists.infradead.org?subject=unsubscribe>
List-Archive: <http://lists.infradead.org/pipermail/kexec/>
List-Post: <mailto:kexec@lists.infradead.org>
List-Help: <mailto:kexec-request@lists.infradead.org?subject=help>
List-Subscribe: <http://lists.infradead.org/mailman/listinfo/kexec>,
 <mailto:kexec-request@lists.infradead.org?subject=subscribe>
Cc: deller@gmx.de, linuxppc-dev@lists.ozlabs.org
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Sender: "kexec" <kexec-bounces@lists.infradead.org>
Errors-To: kexec-bounces+lists+kexec=lfdr.de@lists.infradead.org

SGkgU3ZlbiwKCkxlIDA4LzA3LzIwMTkgw6AgMTI6MDYsIENocmlzdG9waGUgTGVyb3kgYSDDqWNy
aXTCoDoKPiBGcm9tOiBTdmVuIFNjaG5lbGxlIDxzdmVuc0BzdGFja2ZyYW1lLm9yZz4KClBsZWFz
ZSBkZXNjcmliZSB5b3UgcGF0Y2guCgpBbGwgdGhlIGNoYW5nZXMgeW91IGFyZSBkb2luZyB0byB0
aGUgcHBjNjQgdmVyc2lvbiBpbiBvcmRlciB0byBtYWtlIGl0IApnZW5lcmljIHNob3VsZCBiZSBk
ZXNjcmliZWQuCgpUaG9zZSBjaGFuZ2VzIGFyZSBhbHNvIG1heWJlIHdvcnRoIHNwbGl0dGluZyB0
aGUgcGF0Y2ggaW4gc2V2ZXJhbCBwYXJ0cywgCmVpdGhlciBwcmVwYXJpbmcgdGhlIHBwYzY0IGZv
ciBnZW5lcmljIHRoZW4gbW92aW5nIHRvIGtlcm5lbC9rZXhlY19lbGYuYyAKb3IgbW92aW5nIHRv
IGtlcm5lbC9rZXhlY19lbGYuYyB3aXRob3V0IG1vZGlmaWNhdGlvbnMsIHRoZW4gbW9kaWZ5aW5n
IGl0IAp0byBtYWtlIGl0IGdlbmVyaWMuCgpOb3RlIHRoYXQgeW91ciBwYXRjaCBvbmx5IGFwcGxp
ZXMgb24gTGludXggNS4xLCBpdCBkb2Vzbid0IGFwcGx5IG9uIApwb3dlcnBjL25leHQuCgpJIHRo
aW5rIGl0IGFsc28gYmUgd29ydGggdGFraW5nIHRoZSBvcHBvcnR1bml0eSB0byBmaXggdGhlIHNw
YXJzZSAKd2FybmluZ3MsIHNlZSBodHRwczovL3BhdGNod29yay5vemxhYnMub3JnL3BhdGNoLzEx
Mjg3MjAvCgpjaGVja3BhdGNoIGNvbW1lbnRzIHNob3VsZCBhbHNvIGJlIGZpeGVkLCBzZWUgCmh0
dHBzOi8vb3BlbnBvd2VyLnh5ei9qb2Ivc25vd3BhdGNoL2pvYi9zbm93cGF0Y2gtbGludXgtY2hl
Y2twYXRjaC84MDQ0Ly9hcnRpZmFjdC9saW51eC9jaGVja3BhdGNoLmxvZwoKT3RoZXIgY29tbWVu
dHMgYmVsb3csCgo+IAo+IFNpZ25lZC1vZmYtYnk6IFN2ZW4gU2NobmVsbGUgPHN2ZW5zQHN0YWNr
ZnJhbWUub3JnPgo+IC0tLQo+ICAgcGF0Y2ggZ2VuZXJhdGVkIHdpdGggJ2dpdCBmb3JtYXQtcGF0
Y2ggLUMnIGluIG9yZGVyIHRvCj4gICBzZWUgdGhlIG1vZGlmaWNhdGlvbnMgZG9uZSBpbiBrZXhl
Y19lbGYuYyBpbiBhZGRpdGlvbiB0bwo+ICAgY29weWluZyBpdCBmcm9tIGFyY2gvcG93ZXJwYy9r
ZXJuZWwva2V4ZWNfZWxmXzY0LmMKPiAKPiAgIGFyY2gvS2NvbmZpZyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHwgICAzICsKPiAgIGFyY2gvcG93ZXJwYy9LY29uZmlnICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAxICsKPiAgIGFyY2gvcG93ZXJwYy9rZXJu
ZWwva2V4ZWNfZWxmXzY0LmMgICAgICAgICAgICAgICAgIHwgNTQ3ICstLS0tLS0tLS0tLS0tLS0t
LS0tLQo+ICAgaW5jbHVkZS9saW51eC9rZXhlYy5oICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgfCAgMzUgKysKPiAgIGtlcm5lbC9NYWtlZmlsZSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHwgICAxICsKPiAgIC4uLi9rZXJuZWwva2V4ZWNfZWxmXzY0LmMgPT4ga2VybmVs
L2tleGVjX2VsZi5jICAgIHwgMjY0ICsrKy0tLS0tLS0KPiAgIDYgZmlsZXMgY2hhbmdlZCwgMTE4
IGluc2VydGlvbnMoKyksIDczMyBkZWxldGlvbnMoLSkKPiAgIGNvcHkgYXJjaC9wb3dlcnBjL2tl
cm5lbC9rZXhlY19lbGZfNjQuYyA9PiBrZXJuZWwva2V4ZWNfZWxmLmMgKDY0JSkKPiAKPiBkaWZm
IC0tZ2l0IGEvYXJjaC9LY29uZmlnIGIvYXJjaC9LY29uZmlnCj4gaW5kZXggMzM2ODdkZGRkODZh
Li5jN2M3NWZiYzBiNzkgMTAwNjQ0Cj4gLS0tIGEvYXJjaC9LY29uZmlnCj4gKysrIGIvYXJjaC9L
Y29uZmlnCj4gQEAgLTE4LDYgKzE4LDkgQEAgY29uZmlnIEtFWEVDX0NPUkUKPiAgIAlzZWxlY3Qg
Q1JBU0hfQ09SRQo+ICAgCWJvb2wKPiAgIAo+ICtjb25maWcgS0VYRUNfRUxGCj4gKwlib29sCj4g
Kwo+ICAgY29uZmlnIEhBVkVfSU1BX0tFWEVDCj4gICAJYm9vbAo+ICAgCj4gZGlmZiAtLWdpdCBh
L2FyY2gvcG93ZXJwYy9LY29uZmlnIGIvYXJjaC9wb3dlcnBjL0tjb25maWcKPiBpbmRleCAyZDBi
ZTgyYzMwNjEuLjQ0N2I2ZTNhZDk5OSAxMDA2NDQKPiAtLS0gYS9hcmNoL3Bvd2VycGMvS2NvbmZp
Zwo+ICsrKyBiL2FyY2gvcG93ZXJwYy9LY29uZmlnCj4gQEAgLTUwMSw2ICs1MDEsNyBAQCBjb25m
aWcgS0VYRUNfRklMRQo+ICAgCXNlbGVjdCBLRVhFQ19DT1JFCj4gICAJc2VsZWN0IEhBVkVfSU1B
X0tFWEVDCj4gICAJc2VsZWN0IEJVSUxEX0JJTjJDCj4gKwlzZWxlY3QgS0VYRUNfRUxGCj4gICAJ
ZGVwZW5kcyBvbiBQUEM2NAo+ICAgCWRlcGVuZHMgb24gQ1JZUFRPPXkKPiAgIAlkZXBlbmRzIG9u
IENSWVBUT19TSEEyNTY9eQo+IGRpZmYgLS1naXQgYS9hcmNoL3Bvd2VycGMva2VybmVsL2tleGVj
X2VsZl82NC5jIGIvYXJjaC9wb3dlcnBjL2tlcm5lbC9rZXhlY19lbGZfNjQuYwo+IGluZGV4IGJh
NGYxOGE0M2VlOC4uZDA2MmM1OTkxNzIyIDEwMDY0NAo+IC0tLSBhL2FyY2gvcG93ZXJwYy9rZXJu
ZWwva2V4ZWNfZWxmXzY0LmMKPiArKysgYi9hcmNoL3Bvd2VycGMva2VybmVsL2tleGVjX2VsZl82
NC5jCj4gQEAgLTMxLDUzOSArMzEsNyBAQAo+ICAgI2luY2x1ZGUgPGxpbnV4L3NsYWIuaD4KPiAg
ICNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgo+ICAgCj4gLSNkZWZpbmUgUFVSR0FUT1JZX1NUQUNL
X1NJWkUJKDE2ICogMTAyNCkKCltzbmlwXQoKPiArI2RlZmluZSBQVVJHQVRPUllfU1RBQ0tfU0la
RSAoMTYgKiAxMDI0KQoKVGhpcyBsaW5lIHNob3VsZG4ndCBiZSBtb2RpZmllZCBieSB5b3VyIHBh
dGNoLiBJIHNlZSBhIHRhYiB3YXMgcmVwbGFjZWQgCmJ5IHNwYWNlLgoKPiAgIAo+ICAgc3RhdGlj
IHZvaWQgKmVsZjY0X2xvYWQoc3RydWN0IGtpbWFnZSAqaW1hZ2UsIGNoYXIgKmtlcm5lbF9idWYs
Cj4gICAJCQl1bnNpZ25lZCBsb25nIGtlcm5lbF9sZW4sIGNoYXIgKmluaXRyZCwKPiBAQCAtNTc3
LDE3ICs0NSwxNyBAQCBzdGF0aWMgdm9pZCAqZWxmNjRfbG9hZChzdHJ1Y3Qga2ltYWdlICppbWFn
ZSwgY2hhciAqa2VybmVsX2J1ZiwKPiAgIAl2b2lkICpmZHQ7Cj4gICAJY29uc3Qgdm9pZCAqc2xh
dmVfY29kZTsKPiAgIAlzdHJ1Y3QgZWxmaGRyIGVoZHI7Cj4gLQlzdHJ1Y3QgZWxmX2luZm8gZWxm
X2luZm87Cj4gKwlzdHJ1Y3Qga2V4ZWNfZWxmX2luZm8gZWxmX2luZm87Cj4gICAJc3RydWN0IGtl
eGVjX2J1ZiBrYnVmID0geyAuaW1hZ2UgPSBpbWFnZSwgLmJ1Zl9taW4gPSAwLAo+ICAgCQkJCSAg
LmJ1Zl9tYXggPSBwcGM2NF9ybWFfc2l6ZSB9Owo+ICAgCXN0cnVjdCBrZXhlY19idWYgcGJ1ZiA9
IHsgLmltYWdlID0gaW1hZ2UsIC5idWZfbWluID0gMCwKPiAgIAkJCQkgIC5idWZfbWF4ID0gcHBj
NjRfcm1hX3NpemUsIC50b3BfZG93biA9IHRydWUgfTsKPiAgIAo+IC0JcmV0ID0gYnVpbGRfZWxm
X2V4ZWNfaW5mbyhrZXJuZWxfYnVmLCBrZXJuZWxfbGVuLCAmZWhkciwgJmVsZl9pbmZvKTsKPiAr
CXJldCA9IGtleGVjX2J1aWxkX2VsZl9pbmZvKGtlcm5lbF9idWYsIGtlcm5lbF9sZW4sICZlaGRy
LCAmZWxmX2luZm8pOwo+ICAgCWlmIChyZXQpCj4gICAJCWdvdG8gb3V0Owo+ICAgCj4gLQlyZXQg
PSBlbGZfZXhlY19sb2FkKGltYWdlLCAmZWhkciwgJmVsZl9pbmZvLCAma2VybmVsX2xvYWRfYWRk
cik7Cj4gKwlyZXQgPSBrZXhlY19lbGZfbG9hZChpbWFnZSwgJmVoZHIsICZlbGZfaW5mbywgJmti
dWYsICZrZXJuZWxfbG9hZF9hZGRyKTsKPiAgIAlpZiAocmV0KQo+ICAgCQlnb3RvIG91dDsKPiAg
IAo+IEBAIC02MDYsNiArNzQsNyBAQCBzdGF0aWMgdm9pZCAqZWxmNjRfbG9hZChzdHJ1Y3Qga2lt
YWdlICppbWFnZSwgY2hhciAqa2VybmVsX2J1ZiwKPiAgIAkJa2J1Zi5idWZzeiA9IGtidWYubWVt
c3ogPSBpbml0cmRfbGVuOwo+ICAgCQlrYnVmLmJ1Zl9hbGlnbiA9IFBBR0VfU0laRTsKPiAgIAkJ
a2J1Zi50b3BfZG93biA9IGZhbHNlOwo+ICsJCWtidWYubWVtID0gS0VYRUNfQlVGX01FTV9VTktO
T1dOOwoKSXMgdGhhdCBjb3JyZWN0ID8gSSBzZWU6Ci0ga2J1Zi5tZW0gaXMgdW5zaWduZWQKLSBL
RVhFQ19CVUZfTUVNX1VOS05PV04gaXMgLTEgb24gczM5MAoKPiAgIAkJcmV0ID0ga2V4ZWNfYWRk
X2J1ZmZlcigma2J1Zik7Cj4gICAJCWlmIChyZXQpCj4gICAJCQlnb3RvIG91dDsKPiBAQCAtNjM4
LDYgKzEwNyw3IEBAIHN0YXRpYyB2b2lkICplbGY2NF9sb2FkKHN0cnVjdCBraW1hZ2UgKmltYWdl
LCBjaGFyICprZXJuZWxfYnVmLAo+ICAgCWtidWYuYnVmc3ogPSBrYnVmLm1lbXN6ID0gZmR0X3Np
emU7Cj4gICAJa2J1Zi5idWZfYWxpZ24gPSBQQUdFX1NJWkU7Cj4gICAJa2J1Zi50b3BfZG93biA9
IHRydWU7Cj4gKwlrYnVmLm1lbSA9IEtFWEVDX0JVRl9NRU1fVU5LTk9XTjsKPiAgIAlyZXQgPSBr
ZXhlY19hZGRfYnVmZmVyKCZrYnVmKTsKPiAgIAlpZiAocmV0KQo+ICAgCQlnb3RvIG91dDsKPiBA
QCAtNjUyLDEzICsxMjIsMTIgQEAgc3RhdGljIHZvaWQgKmVsZjY0X2xvYWQoc3RydWN0IGtpbWFn
ZSAqaW1hZ2UsIGNoYXIgKmtlcm5lbF9idWYsCj4gICAJCXByX2VycigiRXJyb3Igc2V0dGluZyB1
cCB0aGUgcHVyZ2F0b3J5LlxuIik7Cj4gICAKPiAgIG91dDoKPiAtCWVsZl9mcmVlX2luZm8oJmVs
Zl9pbmZvKTsKPiAtCj4gKwlrZXhlY19mcmVlX2VsZl9pbmZvKCZlbGZfaW5mbyk7Cj4gICAJLyog
TWFrZSBraW1hZ2VfZmlsZV9wb3N0X2xvYWRfY2xlYW51cCBmcmVlIHRoZSBmZHQgYnVmZmVyIGZv
ciB1cy4gKi8KPiAgIAlyZXR1cm4gcmV0ID8gRVJSX1BUUihyZXQpIDogZmR0Owo+ICAgfQo+ICAg
Cj4gICBjb25zdCBzdHJ1Y3Qga2V4ZWNfZmlsZV9vcHMga2V4ZWNfZWxmNjRfb3BzID0gewo+IC0J
LnByb2JlID0gZWxmNjRfcHJvYmUsCj4gKwkucHJvYmUgPSBrZXhlY19lbGZfcHJvYmUsCj4gICAJ
LmxvYWQgPSBlbGY2NF9sb2FkLAo+ICAgfTsKPiBkaWZmIC0tZ2l0IGEvaW5jbHVkZS9saW51eC9r
ZXhlYy5oIGIvaW5jbHVkZS9saW51eC9rZXhlYy5oCj4gaW5kZXggYjliMWJjNWY5NjY5Li43MjY0
OGIxOGI3NzggMTAwNjQ0Cj4gLS0tIGEvaW5jbHVkZS9saW51eC9rZXhlYy5oCj4gKysrIGIvaW5j
bHVkZS9saW51eC9rZXhlYy5oCj4gQEAgLTIxNiw2ICsyMTYsNDEgQEAgZXh0ZXJuIGludCBjcmFz
aF9wcmVwYXJlX2VsZjY0X2hlYWRlcnMoc3RydWN0IGNyYXNoX21lbSAqbWVtLCBpbnQga2VybmVs
X21hcCwKPiAgIAkJCQkgICAgICAgdm9pZCAqKmFkZHIsIHVuc2lnbmVkIGxvbmcgKnN6KTsKPiAg
ICNlbmRpZiAvKiBDT05GSUdfS0VYRUNfRklMRSAqLwo+ICAgCj4gKyNpZmRlZiBDT05GSUdfS0VY
RUNfRUxGCj4gKwo+ICtzdHJ1Y3Qga2V4ZWNfZWxmX2luZm8gewo+ICsJLyoKPiArCSAqIFdoZXJl
IHRoZSBFTEYgYmluYXJ5IGNvbnRlbnRzIGFyZSBrZXB0Lgo+ICsJICogTWVtb3J5IG1hbmFnZWQg
YnkgdGhlIHVzZXIgb2YgdGhlIHN0cnVjdC4KPiArCSAqLwo+ICsJY29uc3QgY2hhciAqYnVmZmVy
Owo+ICsKPiArCWNvbnN0IHN0cnVjdCBlbGZoZHIgKmVoZHI7Cj4gKwljb25zdCBzdHJ1Y3QgZWxm
X3BoZHIgKnByb2doZHJzOwo+ICsJc3RydWN0IGVsZl9zaGRyICpzZWNoZHJzOwo+ICt9Owo+ICsK
PiArdm9pZCBrZXhlY19mcmVlX2VsZl9pbmZvKHN0cnVjdCBrZXhlY19lbGZfaW5mbyAqZWxmX2lu
Zm8pOwo+ICsKPiAraW50IGtleGVjX2J1aWxkX2VsZl9pbmZvKGNvbnN0IGNoYXIgKmJ1Ziwgc2l6
ZV90IGxlbiwgc3RydWN0IGVsZmhkciAqZWhkciwKPiArCQkJICBzdHJ1Y3Qga2V4ZWNfZWxmX2lu
Zm8gKmVsZl9pbmZvKTsKPiArCj4gK2ludCBrZXhlY19lbGZfa2VybmVsX2xvYWQoc3RydWN0IGtp
bWFnZSAqaW1hZ2UsIHN0cnVjdCBrZXhlY19idWYgKmtidWYsCj4gKwkJCSAgY2hhciAqa2VybmVs
X2J1ZiwgdW5zaWduZWQgbG9uZyBrZXJuZWxfbGVuLAo+ICsJCQkgIHVuc2lnbmVkIGxvbmcgKmtl
cm5lbF9sb2FkX2FkZHIpOwo+ICsKPiAraW50IGtleGVjX2VsZl9wcm9iZShjb25zdCBjaGFyICpi
dWYsIHVuc2lnbmVkIGxvbmcgbGVuKTsKPiArCj4gK2ludCBrZXhlY19lbGZfbG9hZChzdHJ1Y3Qg
a2ltYWdlICppbWFnZSwgc3RydWN0IGVsZmhkciAqZWhkciwKPiArCQkJIHN0cnVjdCBrZXhlY19l
bGZfaW5mbyAqZWxmX2luZm8sCj4gKwkJCSBzdHJ1Y3Qga2V4ZWNfYnVmICprYnVmLAo+ICsJCQkg
dW5zaWduZWQgbG9uZyAqbG93ZXN0X2xvYWRfYWRkcik7Cj4gKwo+ICtpbnQga2V4ZWNfZWxmX2xv
YWQoc3RydWN0IGtpbWFnZSAqaW1hZ2UsIHN0cnVjdCBlbGZoZHIgKmVoZHIsCj4gKwkJCSBzdHJ1
Y3Qga2V4ZWNfZWxmX2luZm8gKmVsZl9pbmZvLAo+ICsJCQkgc3RydWN0IGtleGVjX2J1ZiAqa2J1
ZiwKPiArCQkJIHVuc2lnbmVkIGxvbmcgKmxvd2VzdF9sb2FkX2FkZHIpOwoKRHVwbGljYXRpb24g
b2Yga2V4ZWNfZWxmX2xvYWQoKQoKPiArI2VuZGlmCj4gICBzdHJ1Y3Qga2ltYWdlIHsKPiAgIAlr
aW1hZ2VfZW50cnlfdCBoZWFkOwo+ICAgCWtpbWFnZV9lbnRyeV90ICplbnRyeTsKPiBkaWZmIC0t
Z2l0IGEva2VybmVsL01ha2VmaWxlIGIva2VybmVsL01ha2VmaWxlCj4gaW5kZXggNmM1N2U3ODgx
N2RhLi4wODFiMzc4MDUwZDAgMTAwNjQ0Cj4gLS0tIGEva2VybmVsL01ha2VmaWxlCj4gKysrIGIv
a2VybmVsL01ha2VmaWxlCj4gQEAgLTYzLDYgKzYzLDcgQEAgb2JqLSQoQ09ORklHX0NSQVNIX0NP
UkUpICs9IGNyYXNoX2NvcmUubwo+ICAgb2JqLSQoQ09ORklHX0tFWEVDX0NPUkUpICs9IGtleGVj
X2NvcmUubwo+ICAgb2JqLSQoQ09ORklHX0tFWEVDKSArPSBrZXhlYy5vCj4gICBvYmotJChDT05G
SUdfS0VYRUNfRklMRSkgKz0ga2V4ZWNfZmlsZS5vCj4gK29iai0kKENPTkZJR19LRVhFQ19FTEYp
ICs9IGtleGVjX2VsZi5vCj4gICBvYmotJChDT05GSUdfQkFDS1RSQUNFX1NFTEZfVEVTVCkgKz0g
YmFja3RyYWNldGVzdC5vCj4gICBvYmotJChDT05GSUdfQ09NUEFUKSArPSBjb21wYXQubwo+ICAg
b2JqLSQoQ09ORklHX0NHUk9VUFMpICs9IGNncm91cC8KPiBkaWZmIC0tZ2l0IGEvYXJjaC9wb3dl
cnBjL2tlcm5lbC9rZXhlY19lbGZfNjQuYyBiL2tlcm5lbC9rZXhlY19lbGYuYwo+IHNpbWlsYXJp
dHkgaW5kZXggNjQlCj4gY29weSBmcm9tIGFyY2gvcG93ZXJwYy9rZXJuZWwva2V4ZWNfZWxmXzY0
LmMKPiBjb3B5IHRvIGtlcm5lbC9rZXhlY19lbGYuYwo+IGluZGV4IGJhNGYxOGE0M2VlOC4uMDdl
NWJjYzc5YmJhIDEwMDY0NAo+IC0tLSBhL2FyY2gvcG93ZXJwYy9rZXJuZWwva2V4ZWNfZWxmXzY0
LmMKPiArKysgYi9rZXJuZWwva2V4ZWNfZWxmLmMKPiBAQCAtMSw1NSArMSwxMyBAQAo+IC0vKgo+
IC0gKiBMb2FkIEVMRiB2bWxpbnV4IGZpbGUgZm9yIHRoZSBrZXhlY19maWxlX2xvYWQgc3lzY2Fs
bC4KPiAtICoKPiAtICogQ29weXJpZ2h0IChDKSAyMDA0ICBBZGFtIExpdGtlIChhZ2xAdXMuaWJt
LmNvbSkKPiAtICogQ29weXJpZ2h0IChDKSAyMDA0ICBJQk0gQ29ycC4KPiAtICogQ29weXJpZ2h0
IChDKSAyMDA1ICBSIFNoYXJhZGEgKHNoYXJhZGFAaW4uaWJtLmNvbSkKPiAtICogQ29weXJpZ2h0
IChDKSAyMDA2ICBNb2hhbiBLdW1hciBNIChtb2hhbkBpbi5pYm0uY29tKQo+IC0gKiBDb3B5cmln
aHQgKEMpIDIwMTYgIElCTSBDb3Jwb3JhdGlvbgo+IC0gKgo+IC0gKiBCYXNlZCBvbiBrZXhlYy10
b29scycga2V4ZWMtZWxmLWV4ZWMuYyBhbmQga2V4ZWMtZWxmLXBwYzY0LmMuCj4gLSAqIEhlYXZp
bHkgbW9kaWZpZWQgZm9yIHRoZSBrZXJuZWwgYnkKPiAtICogVGhpYWdvIEp1bmcgQmF1ZXJtYW5u
IDxiYXVlcm1hbkBsaW51eC52bmV0LmlibS5jb20+Lgo+IC0gKgo+IC0gKiBUaGlzIHByb2dyYW0g
aXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQo+
IC0gKiBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNl
IGFzIHB1Ymxpc2hlZCBieQo+IC0gKiB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uICh2ZXJz
aW9uIDIgb2YgdGhlIExpY2Vuc2UpLgo+IC0gKgo+IC0gKiBUaGlzIHByb2dyYW0gaXMgZGlzdHJp
YnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKPiAtICogYnV0IFdJVEhP
VVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKPiAt
ICogTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAg
U2VlIHRoZQo+IC0gKiBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxz
Lgo+IC0gKi8KPiArLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAKPiAgIAo+ICAg
I2RlZmluZSBwcl9mbXQoZm10KQkia2V4ZWNfZWxmOiAiIGZtdAo+ICAgCj4gICAjaW5jbHVkZSA8
bGludXgvZWxmLmg+Cj4gICAjaW5jbHVkZSA8bGludXgva2V4ZWMuaD4KPiAtI2luY2x1ZGUgPGxp
bnV4L2xpYmZkdC5oPgo+ICAgI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5oPgo+IC0jaW5jbHVkZSA8
bGludXgvb2ZfZmR0Lmg+Cj4gICAjaW5jbHVkZSA8bGludXgvc2xhYi5oPgo+ICAgI2luY2x1ZGUg
PGxpbnV4L3R5cGVzLmg+Cj4gICAKPiAtI2RlZmluZSBQVVJHQVRPUllfU1RBQ0tfU0laRQkoMTYg
KiAxMDI0KQo+IC0KPiAtI2RlZmluZSBlbGZfYWRkcl90b19jcHUJZWxmNjRfdG9fY3B1Cj4gLQo+
IC0jaWZuZGVmIEVsZl9SZWwKPiAtI2RlZmluZSBFbGZfUmVsCQlFbGY2NF9SZWwKPiAtI2VuZGlm
IC8qIEVsZl9SZWwgKi8KPiAtCj4gLXN0cnVjdCBlbGZfaW5mbyB7Cj4gLQkvKgo+IC0JICogV2hl
cmUgdGhlIEVMRiBiaW5hcnkgY29udGVudHMgYXJlIGtlcHQuCj4gLQkgKiBNZW1vcnkgbWFuYWdl
ZCBieSB0aGUgdXNlciBvZiB0aGUgc3RydWN0Lgo+IC0JICovCj4gLQljb25zdCBjaGFyICpidWZm
ZXI7Cj4gLQo+IC0JY29uc3Qgc3RydWN0IGVsZmhkciAqZWhkcjsKPiAtCWNvbnN0IHN0cnVjdCBl
bGZfcGhkciAqcHJvZ2hkcnM7Cj4gLQlzdHJ1Y3QgZWxmX3NoZHIgKnNlY2hkcnM7Cj4gLX07Cj4g
ICAKPiAgIHN0YXRpYyBpbmxpbmUgYm9vbCBlbGZfaXNfZWxmX2ZpbGUoY29uc3Qgc3RydWN0IGVs
ZmhkciAqZWhkcikKPiAgIHsKPiBAQCAtNjYsMjIgKzI0LDIyIEBAIHN0YXRpYyB1aW50NjRfdCBl
bGY2NF90b19jcHUoY29uc3Qgc3RydWN0IGVsZmhkciAqZWhkciwgdWludDY0X3QgdmFsdWUpCj4g
ICAJcmV0dXJuIHZhbHVlOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB1aW50MTZfdCBlbGYxNl90b19j
cHUoY29uc3Qgc3RydWN0IGVsZmhkciAqZWhkciwgdWludDE2X3QgdmFsdWUpCj4gK3N0YXRpYyB1
aW50MzJfdCBlbGYzMl90b19jcHUoY29uc3Qgc3RydWN0IGVsZmhkciAqZWhkciwgdWludDMyX3Qg
dmFsdWUpCgpBbnkgcmVhc29uIHRvIHN3aXRjaCBwb3NpdGlvbiBvZiBlbGYxNl90b19jcHUoKSB3
aXRoIGVsZjMyX3RvX2NwdSgpID8KCj4gICB7Cj4gICAJaWYgKGVoZHItPmVfaWRlbnRbRUlfREFU
QV0gPT0gRUxGREFUQTJMU0IpCj4gLQkJdmFsdWUgPSBsZTE2X3RvX2NwdSh2YWx1ZSk7Cj4gKwkJ
dmFsdWUgPSBsZTMyX3RvX2NwdSh2YWx1ZSk7Cj4gICAJZWxzZSBpZiAoZWhkci0+ZV9pZGVudFtF
SV9EQVRBXSA9PSBFTEZEQVRBMk1TQikKPiAtCQl2YWx1ZSA9IGJlMTZfdG9fY3B1KHZhbHVlKTsK
PiArCQl2YWx1ZSA9IGJlMzJfdG9fY3B1KHZhbHVlKTsKPiAgIAo+ICAgCXJldHVybiB2YWx1ZTsK
PiAgIH0KPiAgIAo+IC1zdGF0aWMgdWludDMyX3QgZWxmMzJfdG9fY3B1KGNvbnN0IHN0cnVjdCBl
bGZoZHIgKmVoZHIsIHVpbnQzMl90IHZhbHVlKQo+ICtzdGF0aWMgdWludDE2X3QgZWxmMTZfdG9f
Y3B1KGNvbnN0IHN0cnVjdCBlbGZoZHIgKmVoZHIsIHVpbnQxNl90IHZhbHVlKQo+ICAgewo+ICAg
CWlmIChlaGRyLT5lX2lkZW50W0VJX0RBVEFdID09IEVMRkRBVEEyTFNCKQo+IC0JCXZhbHVlID0g
bGUzMl90b19jcHUodmFsdWUpOwo+ICsJCXZhbHVlID0gbGUxNl90b19jcHUodmFsdWUpOwo+ICAg
CWVsc2UgaWYgKGVoZHItPmVfaWRlbnRbRUlfREFUQV0gPT0gRUxGREFUQTJNU0IpCj4gLQkJdmFs
dWUgPSBiZTMyX3RvX2NwdSh2YWx1ZSk7Cj4gKwkJdmFsdWUgPSBiZTE2X3RvX2NwdSh2YWx1ZSk7
Cj4gICAKPiAgIAlyZXR1cm4gdmFsdWU7Cj4gICB9Cj4gQEAgLTE4MCw5ICsxMzgsOSBAQCBzdGF0
aWMgaW50IGVsZl9yZWFkX2VoZHIoY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuLCBzdHJ1Y3Qg
ZWxmaGRyICplaGRyKQo+ICAgCWVoZHItPmVfdHlwZSAgICAgID0gZWxmMTZfdG9fY3B1KGVoZHIs
IGJ1Zl9laGRyLT5lX3R5cGUpOwo+ICAgCWVoZHItPmVfbWFjaGluZSAgID0gZWxmMTZfdG9fY3B1
KGVoZHIsIGJ1Zl9laGRyLT5lX21hY2hpbmUpOwo+ICAgCWVoZHItPmVfdmVyc2lvbiAgID0gZWxm
MzJfdG9fY3B1KGVoZHIsIGJ1Zl9laGRyLT5lX3ZlcnNpb24pOwo+IC0JZWhkci0+ZV9lbnRyeSAg
ICAgPSBlbGZfYWRkcl90b19jcHUoZWhkciwgYnVmX2VoZHItPmVfZW50cnkpOwo+IC0JZWhkci0+
ZV9waG9mZiAgICAgPSBlbGZfYWRkcl90b19jcHUoZWhkciwgYnVmX2VoZHItPmVfcGhvZmYpOwo+
IC0JZWhkci0+ZV9zaG9mZiAgICAgPSBlbGZfYWRkcl90b19jcHUoZWhkciwgYnVmX2VoZHItPmVf
c2hvZmYpOwo+ICsJZWhkci0+ZV9lbnRyeSAgICAgPSBlbGY2NF90b19jcHUoZWhkciwgYnVmX2Vo
ZHItPmVfZW50cnkpOwo+ICsJZWhkci0+ZV9waG9mZiAgICAgPSBlbGY2NF90b19jcHUoZWhkciwg
YnVmX2VoZHItPmVfcGhvZmYpOwo+ICsJZWhkci0+ZV9zaG9mZiAgICAgPSBlbGY2NF90b19jcHUo
ZWhkciwgYnVmX2VoZHItPmVfc2hvZmYpOwo+ICAgCWVoZHItPmVfZmxhZ3MgICAgID0gZWxmMzJf
dG9fY3B1KGVoZHIsIGJ1Zl9laGRyLT5lX2ZsYWdzKTsKPiAgIAllaGRyLT5lX3BoZW50c2l6ZSA9
IGVsZjE2X3RvX2NwdShlaGRyLCBidWZfZWhkci0+ZV9waGVudHNpemUpOwo+ICAgCWVoZHItPmVf
cGhudW0gICAgID0gZWxmMTZfdG9fY3B1KGVoZHIsIGJ1Zl9laGRyLT5lX3BobnVtKTsKPiBAQCAt
MjE0LDcgKzE3Miw3IEBAIHN0YXRpYyBib29sIGVsZl9pc19waGRyX3NhbmUoY29uc3Qgc3RydWN0
IGVsZl9waGRyICpwaGRyLCBzaXplX3QgYnVmX2xlbikKPiAgIAlyZXR1cm4gdHJ1ZTsKPiAgIH0K
PiAgIAo+IC1zdGF0aWMgaW50IGVsZl9yZWFkX3BoZHIoY29uc3QgY2hhciAqYnVmLCBzaXplX3Qg
bGVuLCBzdHJ1Y3QgZWxmX2luZm8gKmVsZl9pbmZvLAo+ICtzdGF0aWMgaW50IGVsZl9yZWFkX3Bo
ZHIoY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuLCBzdHJ1Y3Qga2V4ZWNfZWxmX2luZm8gKmVs
Zl9pbmZvLAo+ICAgCQkJIGludCBpZHgpCj4gICB7Cj4gICAJLyogT3ZlcnJpZGUgdGhlIGNvbnN0
IGluIHByb2doZHJzLCB3ZSBhcmUgdGhlIG9uZXMgZG9pbmcgdGhlIGxvYWRpbmcuICovCj4gQEAg
LTIyNiwxOCArMTg0LDE4IEBAIHN0YXRpYyBpbnQgZWxmX3JlYWRfcGhkcihjb25zdCBjaGFyICpi
dWYsIHNpemVfdCBsZW4sIHN0cnVjdCBlbGZfaW5mbyAqZWxmX2luZm8sCj4gICAJYnVmX3BoZHIg
PSAoc3RydWN0IGVsZl9waGRyICopIHBidWY7Cj4gICAKPiAgIAlwaGRyLT5wX3R5cGUgICA9IGVs
ZjMyX3RvX2NwdShlbGZfaW5mby0+ZWhkciwgYnVmX3BoZHItPnBfdHlwZSk7Cj4gLQlwaGRyLT5w
X29mZnNldCA9IGVsZl9hZGRyX3RvX2NwdShlbGZfaW5mby0+ZWhkciwgYnVmX3BoZHItPnBfb2Zm
c2V0KTsKPiAtCXBoZHItPnBfcGFkZHIgID0gZWxmX2FkZHJfdG9fY3B1KGVsZl9pbmZvLT5laGRy
LCBidWZfcGhkci0+cF9wYWRkcik7Cj4gLQlwaGRyLT5wX3ZhZGRyICA9IGVsZl9hZGRyX3RvX2Nw
dShlbGZfaW5mby0+ZWhkciwgYnVmX3BoZHItPnBfdmFkZHIpOwo+ICsJcGhkci0+cF9vZmZzZXQg
PSBlbGY2NF90b19jcHUoZWxmX2luZm8tPmVoZHIsIGJ1Zl9waGRyLT5wX29mZnNldCk7Cj4gKwlw
aGRyLT5wX3BhZGRyICA9IGVsZjY0X3RvX2NwdShlbGZfaW5mby0+ZWhkciwgYnVmX3BoZHItPnBf
cGFkZHIpOwo+ICsJcGhkci0+cF92YWRkciAgPSBlbGY2NF90b19jcHUoZWxmX2luZm8tPmVoZHIs
IGJ1Zl9waGRyLT5wX3ZhZGRyKTsKPiAgIAlwaGRyLT5wX2ZsYWdzICA9IGVsZjMyX3RvX2NwdShl
bGZfaW5mby0+ZWhkciwgYnVmX3BoZHItPnBfZmxhZ3MpOwo+ICAgCj4gICAJLyoKPiAgIAkgKiBU
aGUgZm9sbG93aW5nIGZpZWxkcyBoYXZlIGEgdHlwZSBlcXVpdmFsZW50IHRvIEVsZl9BZGRyCj4g
ICAJICogYm90aCBpbiAzMiBiaXQgYW5kIDY0IGJpdCBFTEYuCj4gICAJICovCj4gLQlwaGRyLT5w
X2ZpbGVzeiA9IGVsZl9hZGRyX3RvX2NwdShlbGZfaW5mby0+ZWhkciwgYnVmX3BoZHItPnBfZmls
ZXN6KTsKPiAtCXBoZHItPnBfbWVtc3ogID0gZWxmX2FkZHJfdG9fY3B1KGVsZl9pbmZvLT5laGRy
LCBidWZfcGhkci0+cF9tZW1zeik7Cj4gLQlwaGRyLT5wX2FsaWduICA9IGVsZl9hZGRyX3RvX2Nw
dShlbGZfaW5mby0+ZWhkciwgYnVmX3BoZHItPnBfYWxpZ24pOwo+ICsJcGhkci0+cF9maWxlc3og
PSBlbGY2NF90b19jcHUoZWxmX2luZm8tPmVoZHIsIGJ1Zl9waGRyLT5wX2ZpbGVzeik7Cj4gKwlw
aGRyLT5wX21lbXN6ICA9IGVsZjY0X3RvX2NwdShlbGZfaW5mby0+ZWhkciwgYnVmX3BoZHItPnBf
bWVtc3opOwo+ICsJcGhkci0+cF9hbGlnbiAgPSBlbGY2NF90b19jcHUoZWxmX2luZm8tPmVoZHIs
IGJ1Zl9waGRyLT5wX2FsaWduKTsKPiAgIAo+ICAgCXJldHVybiBlbGZfaXNfcGhkcl9zYW5lKHBo
ZHIsIGxlbikgPyAwIDogLUVOT0VYRUM7Cj4gICB9Cj4gQEAgLTI0OSw3ICsyMDcsNyBAQCBzdGF0
aWMgaW50IGVsZl9yZWFkX3BoZHIoY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuLCBzdHJ1Y3Qg
ZWxmX2luZm8gKmVsZl9pbmZvLAo+ICAgICogVXNlIGVsZl9pc19laGRyX3NhbmUoKSBpZiBpdCB3
YXNuJ3QuCj4gICAgKi8KPiAgIHN0YXRpYyBpbnQgZWxmX3JlYWRfcGhkcnMoY29uc3QgY2hhciAq
YnVmLCBzaXplX3QgbGVuLAo+IC0JCQkgIHN0cnVjdCBlbGZfaW5mbyAqZWxmX2luZm8pCj4gKwkJ
CSAgc3RydWN0IGtleGVjX2VsZl9pbmZvICplbGZfaW5mbykKPiAgIHsKPiAgIAlzaXplX3QgcGhk
cl9zaXplLCBpOwo+ICAgCWNvbnN0IHN0cnVjdCBlbGZoZHIgKmVoZHIgPSBlbGZfaW5mby0+ZWhk
cjsKPiBAQCAtMjk2LDEzICsyNTQsMTMgQEAgc3RhdGljIGJvb2wgZWxmX2lzX3NoZHJfc2FuZShj
b25zdCBzdHJ1Y3QgZWxmX3NoZHIgKnNoZHIsIHNpemVfdCBidWZfbGVuKQo+ICAgCQlzaXplX29r
ID0gc2hkci0+c2hfZW50c2l6ZSA9PSBzaXplb2YoRWxmX1N5bSk7Cj4gICAJCWJyZWFrOwo+ICAg
CWNhc2UgU0hUX1JFTEE6Cj4gLQkJc2l6ZV9vayA9IHNoZHItPnNoX2VudHNpemUgPT0gc2l6ZW9m
KEVsZl9SZWxhKTsKPiArCQlzaXplX29rID0gc2hkci0+c2hfZW50c2l6ZSA9PSBzaXplb2YoRWxm
NjRfUmVsYSk7Cj4gICAJCWJyZWFrOwo+ICAgCWNhc2UgU0hUX0RZTkFNSUM6Cj4gICAJCXNpemVf
b2sgPSBzaGRyLT5zaF9lbnRzaXplID09IHNpemVvZihFbGZfRHluKTsKPiAgIAkJYnJlYWs7Cj4g
ICAJY2FzZSBTSFRfUkVMOgo+IC0JCXNpemVfb2sgPSBzaGRyLT5zaF9lbnRzaXplID09IHNpemVv
ZihFbGZfUmVsKTsKPiArCQlzaXplX29rID0gc2hkci0+c2hfZW50c2l6ZSA9PSBzaXplb2YoRWxm
NjRfUmVsKTsKPiAgIAkJYnJlYWs7Cj4gICAJY2FzZSBTSFRfTk9URToKPiAgIAljYXNlIFNIVF9Q
Uk9HQklUUzoKPiBAQCAtMzQwLDcgKzI5OCw3IEBAIHN0YXRpYyBib29sIGVsZl9pc19zaGRyX3Nh
bmUoY29uc3Qgc3RydWN0IGVsZl9zaGRyICpzaGRyLCBzaXplX3QgYnVmX2xlbikKPiAgIAlyZXR1
cm4gdHJ1ZTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgaW50IGVsZl9yZWFkX3NoZHIoY29uc3QgY2hh
ciAqYnVmLCBzaXplX3QgbGVuLCBzdHJ1Y3QgZWxmX2luZm8gKmVsZl9pbmZvLAo+ICtzdGF0aWMg
aW50IGVsZl9yZWFkX3NoZHIoY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuLCBzdHJ1Y3Qga2V4
ZWNfZWxmX2luZm8gKmVsZl9pbmZvLAo+ICAgCQkJIGludCBpZHgpCj4gICB7Cj4gICAJc3RydWN0
IGVsZl9zaGRyICpzaGRyID0gJmVsZl9pbmZvLT5zZWNoZHJzW2lkeF07Cj4gQEAgLTM1Myw4ICsz
MTEsOCBAQCBzdGF0aWMgaW50IGVsZl9yZWFkX3NoZHIoY29uc3QgY2hhciAqYnVmLCBzaXplX3Qg
bGVuLCBzdHJ1Y3QgZWxmX2luZm8gKmVsZl9pbmZvLAo+ICAgCj4gICAJc2hkci0+c2hfbmFtZSAg
ICAgID0gZWxmMzJfdG9fY3B1KGVoZHIsIGJ1Zl9zaGRyLT5zaF9uYW1lKTsKPiAgIAlzaGRyLT5z
aF90eXBlICAgICAgPSBlbGYzMl90b19jcHUoZWhkciwgYnVmX3NoZHItPnNoX3R5cGUpOwo+IC0J
c2hkci0+c2hfYWRkciAgICAgID0gZWxmX2FkZHJfdG9fY3B1KGVoZHIsIGJ1Zl9zaGRyLT5zaF9h
ZGRyKTsKPiAtCXNoZHItPnNoX29mZnNldCAgICA9IGVsZl9hZGRyX3RvX2NwdShlaGRyLCBidWZf
c2hkci0+c2hfb2Zmc2V0KTsKPiArCXNoZHItPnNoX2FkZHIgICAgICA9IGVsZjY0X3RvX2NwdShl
aGRyLCBidWZfc2hkci0+c2hfYWRkcik7Cj4gKwlzaGRyLT5zaF9vZmZzZXQgICAgPSBlbGY2NF90
b19jcHUoZWhkciwgYnVmX3NoZHItPnNoX29mZnNldCk7Cj4gICAJc2hkci0+c2hfbGluayAgICAg
ID0gZWxmMzJfdG9fY3B1KGVoZHIsIGJ1Zl9zaGRyLT5zaF9saW5rKTsKPiAgIAlzaGRyLT5zaF9p
bmZvICAgICAgPSBlbGYzMl90b19jcHUoZWhkciwgYnVmX3NoZHItPnNoX2luZm8pOwo+ICAgCj4g
QEAgLTM2MiwxMCArMzIwLDEwIEBAIHN0YXRpYyBpbnQgZWxmX3JlYWRfc2hkcihjb25zdCBjaGFy
ICpidWYsIHNpemVfdCBsZW4sIHN0cnVjdCBlbGZfaW5mbyAqZWxmX2luZm8sCj4gICAJICogVGhl
IGZvbGxvd2luZyBmaWVsZHMgaGF2ZSBhIHR5cGUgZXF1aXZhbGVudCB0byBFbGZfQWRkcgo+ICAg
CSAqIGJvdGggaW4gMzIgYml0IGFuZCA2NCBiaXQgRUxGLgo+ICAgCSAqLwo+IC0Jc2hkci0+c2hf
ZmxhZ3MgICAgID0gZWxmX2FkZHJfdG9fY3B1KGVoZHIsIGJ1Zl9zaGRyLT5zaF9mbGFncyk7Cj4g
LQlzaGRyLT5zaF9zaXplICAgICAgPSBlbGZfYWRkcl90b19jcHUoZWhkciwgYnVmX3NoZHItPnNo
X3NpemUpOwo+IC0Jc2hkci0+c2hfYWRkcmFsaWduID0gZWxmX2FkZHJfdG9fY3B1KGVoZHIsIGJ1
Zl9zaGRyLT5zaF9hZGRyYWxpZ24pOwo+IC0Jc2hkci0+c2hfZW50c2l6ZSAgID0gZWxmX2FkZHJf
dG9fY3B1KGVoZHIsIGJ1Zl9zaGRyLT5zaF9lbnRzaXplKTsKPiArCXNoZHItPnNoX2ZsYWdzICAg
ICA9IGVsZjY0X3RvX2NwdShlaGRyLCBidWZfc2hkci0+c2hfZmxhZ3MpOwo+ICsJc2hkci0+c2hf
c2l6ZSAgICAgID0gZWxmNjRfdG9fY3B1KGVoZHIsIGJ1Zl9zaGRyLT5zaF9zaXplKTsKPiArCXNo
ZHItPnNoX2FkZHJhbGlnbiA9IGVsZjY0X3RvX2NwdShlaGRyLCBidWZfc2hkci0+c2hfYWRkcmFs
aWduKTsKPiArCXNoZHItPnNoX2VudHNpemUgICA9IGVsZjY0X3RvX2NwdShlaGRyLCBidWZfc2hk
ci0+c2hfZW50c2l6ZSk7Cj4gICAKPiAgIAlyZXR1cm4gZWxmX2lzX3NoZHJfc2FuZShzaGRyLCBs
ZW4pID8gMCA6IC1FTk9FWEVDOwo+ICAgfQo+IEBAIC0zNzcsNyArMzM1LDcgQEAgc3RhdGljIGlu
dCBlbGZfcmVhZF9zaGRyKGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbiwgc3RydWN0IGVsZl9p
bmZvICplbGZfaW5mbywKPiAgICAqIFVzZSBlbGZfaXNfZWhkcl9zYW5lKCkgaWYgaXQgd2Fzbid0
Lgo+ICAgICovCj4gICBzdGF0aWMgaW50IGVsZl9yZWFkX3NoZHJzKGNvbnN0IGNoYXIgKmJ1Ziwg
c2l6ZV90IGxlbiwKPiAtCQkJICBzdHJ1Y3QgZWxmX2luZm8gKmVsZl9pbmZvKQo+ICsJCQkgIHN0
cnVjdCBrZXhlY19lbGZfaW5mbyAqZWxmX2luZm8pCj4gICB7Cj4gICAJc2l6ZV90IHNoZHJfc2l6
ZSwgaTsKPiAgIAo+IEBAIC00MTYsMTEgKzM3NCwxMSBAQCBzdGF0aWMgaW50IGVsZl9yZWFkX3No
ZHJzKGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbiwKPiAgICAqIHRoZSBrZXJuZWwsIGJ5dGUt
c3dhcHBpbmcgdGhlIGZpZWxkcyBhcyBuZWVkZWQuCj4gICAgKgo+ICAgICogUmV0dXJuOgo+IC0g
KiBPbiBzdWNjZXNzIHJldHVybnMgMCwgYW5kIHRoZSBjYWxsZXIgc2hvdWxkIGNhbGwgZWxmX2Zy
ZWVfaW5mbyhlbGZfaW5mbykgdG8KPiArICogT24gc3VjY2VzcyByZXR1cm5zIDAsIGFuZCB0aGUg
Y2FsbGVyIHNob3VsZCBjYWxsIGtleGVjX2ZyZWVfZWxmX2luZm8oZWxmX2luZm8pIHRvCj4gICAg
KiBmcmVlIHRoZSBtZW1vcnkgYWxsb2NhdGVkIGZvciB0aGUgc2VjdGlvbiBhbmQgcHJvZ3JhbSBo
ZWFkZXJzLgo+ICAgICovCj4gICBpbnQgZWxmX3JlYWRfZnJvbV9idWZmZXIoY29uc3QgY2hhciAq
YnVmLCBzaXplX3QgbGVuLCBzdHJ1Y3QgZWxmaGRyICplaGRyLAo+IC0JCQkgc3RydWN0IGVsZl9p
bmZvICplbGZfaW5mbykKPiArCQkJIHN0cnVjdCBrZXhlY19lbGZfaW5mbyAqZWxmX2luZm8pCj4g
ICB7Cj4gICAJaW50IHJldDsKPiAgIAo+IEBAIC00NDcsMTkgKzQwNSwxOSBAQCBpbnQgZWxmX3Jl
YWRfZnJvbV9idWZmZXIoY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuLCBzdHJ1Y3QgZWxmaGRy
ICplaGRyLAo+ICAgfQo+ICAgCj4gICAvKioKPiAtICogZWxmX2ZyZWVfaW5mbyAtIGZyZWUgbWVt
b3J5IGFsbG9jYXRlZCBieSBlbGZfcmVhZF9mcm9tX2J1ZmZlcgo+ICsgKiBrZXhlY19mcmVlX2Vs
Zl9pbmZvIC0gZnJlZSBtZW1vcnkgYWxsb2NhdGVkIGJ5IGVsZl9yZWFkX2Zyb21fYnVmZmVyCj4g
ICAgKi8KPiAtdm9pZCBlbGZfZnJlZV9pbmZvKHN0cnVjdCBlbGZfaW5mbyAqZWxmX2luZm8pCj4g
K3ZvaWQga2V4ZWNfZnJlZV9lbGZfaW5mbyhzdHJ1Y3Qga2V4ZWNfZWxmX2luZm8gKmVsZl9pbmZv
KQo+ICAgewo+ICAgCWtmcmVlKGVsZl9pbmZvLT5wcm9naGRycyk7Cj4gLQlrZnJlZShlbGZfaW5m
by0+c2VjaGRycyk7CgpXaHkgaXMgdGhlIGFib3ZlIGtmcmVlKCkgcmVtb3ZlZCA/Cgo+ICAgCW1l
bXNldChlbGZfaW5mbywgMCwgc2l6ZW9mKCplbGZfaW5mbykpOwo+ICAgfQo+ICsKPiAgIC8qKgo+
IC0gKiBidWlsZF9lbGZfZXhlY19pbmZvIC0gcmVhZCBFTEYgZXhlY3V0YWJsZSBhbmQgY2hlY2sg
dGhhdCB3ZSBjYW4gdXNlIGl0Cj4gKyAqIGtleGVjX2J1aWxkX2VsZl9pbmZvIC0gcmVhZCBFTEYg
ZXhlY3V0YWJsZSBhbmQgY2hlY2sgdGhhdCB3ZSBjYW4gdXNlIGl0Cj4gICAgKi8KPiAtc3RhdGlj
IGludCBidWlsZF9lbGZfZXhlY19pbmZvKGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbiwgc3Ry
dWN0IGVsZmhkciAqZWhkciwKPiAtCQkJICAgICAgIHN0cnVjdCBlbGZfaW5mbyAqZWxmX2luZm8p
Cj4gK2ludCBrZXhlY19idWlsZF9lbGZfaW5mbyhjb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4s
IHN0cnVjdCBlbGZoZHIgKmVoZHIsCj4gKwkJCSAgc3RydWN0IGtleGVjX2VsZl9pbmZvICplbGZf
aW5mbykKPiAgIHsKPiAgIAlpbnQgaTsKPiAgIAlpbnQgcmV0Owo+IEBAIC00OTEsMjUgKzQ0OSwx
MCBAQCBzdGF0aWMgaW50IGJ1aWxkX2VsZl9leGVjX2luZm8oY29uc3QgY2hhciAqYnVmLCBzaXpl
X3QgbGVuLCBzdHJ1Y3QgZWxmaGRyICplaGRyLAo+ICAgCj4gICAJcmV0dXJuIDA7Cj4gICBlcnJv
cjoKPiAtCWVsZl9mcmVlX2luZm8oZWxmX2luZm8pOwo+ICsJa2V4ZWNfZnJlZV9lbGZfaW5mbyhl
bGZfaW5mbyk7Cj4gICAJcmV0dXJuIC1FTk9FWEVDOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyBpbnQg
ZWxmNjRfcHJvYmUoY29uc3QgY2hhciAqYnVmLCB1bnNpZ25lZCBsb25nIGxlbikKPiAtewo+IC0J
c3RydWN0IGVsZmhkciBlaGRyOwo+IC0Jc3RydWN0IGVsZl9pbmZvIGVsZl9pbmZvOwo+IC0JaW50
IHJldDsKPiAtCj4gLQlyZXQgPSBidWlsZF9lbGZfZXhlY19pbmZvKGJ1ZiwgbGVuLCAmZWhkciwg
JmVsZl9pbmZvKTsKPiAtCWlmIChyZXQpCj4gLQkJcmV0dXJuIHJldDsKPiAtCj4gLQllbGZfZnJl
ZV9pbmZvKCZlbGZfaW5mbyk7Cj4gLQo+IC0JcmV0dXJuIGVsZl9jaGVja19hcmNoKCZlaGRyKSA/
IDAgOiAtRU5PRVhFQzsKPiAtfQo+IC0KPiAgIC8qKgo+ICAgICogZWxmX2V4ZWNfbG9hZCAtIGxv
YWQgRUxGIGV4ZWN1dGFibGUgaW1hZ2UKPiAgICAqIEBsb3dlc3RfbG9hZF9hZGRyOglPbiByZXR1
cm4sIHdpbGwgYmUgdGhlIGFkZHJlc3Mgd2hlcmUgdGhlIGZpcnN0IFBUX0xPQUQKPiBAQCAtNTE4
LDE2ICs0NjEsMTQgQEAgc3RhdGljIGludCBlbGY2NF9wcm9iZShjb25zdCBjaGFyICpidWYsIHVu
c2lnbmVkIGxvbmcgbGVuKQo+ICAgICogUmV0dXJuOgo+ICAgICogMCBvbiBzdWNjZXNzLCBuZWdh
dGl2ZSB2YWx1ZSBvbiBmYWlsdXJlLgo+ICAgICovCj4gLXN0YXRpYyBpbnQgZWxmX2V4ZWNfbG9h
ZChzdHJ1Y3Qga2ltYWdlICppbWFnZSwgc3RydWN0IGVsZmhkciAqZWhkciwKPiAtCQkJIHN0cnVj
dCBlbGZfaW5mbyAqZWxmX2luZm8sCj4gLQkJCSB1bnNpZ25lZCBsb25nICpsb3dlc3RfbG9hZF9h
ZGRyKQo+ICtpbnQga2V4ZWNfZWxmX2xvYWQoc3RydWN0IGtpbWFnZSAqaW1hZ2UsIHN0cnVjdCBl
bGZoZHIgKmVoZHIsCj4gKwkJICAgc3RydWN0IGtleGVjX2VsZl9pbmZvICplbGZfaW5mbywKPiAr
CQkgICBzdHJ1Y3Qga2V4ZWNfYnVmICprYnVmLAo+ICsJCSAgIHVuc2lnbmVkIGxvbmcgKmxvd2Vz
dF9sb2FkX2FkZHIpCj4gICB7Cj4gLQl1bnNpZ25lZCBsb25nIGJhc2UgPSAwLCBsb3dlc3RfYWRk
ciA9IFVJTlRfTUFYOwo+ICsJdW5zaWduZWQgbG9uZyBsb3dlc3RfYWRkciA9IFVJTlRfTUFYOwo+
ICAgCWludCByZXQ7Cj4gICAJc2l6ZV90IGk7Cj4gLQlzdHJ1Y3Qga2V4ZWNfYnVmIGtidWYgPSB7
IC5pbWFnZSA9IGltYWdlLCAuYnVmX21heCA9IHBwYzY0X3JtYV9zaXplLAo+IC0JCQkJICAudG9w
X2Rvd24gPSBmYWxzZSB9Owo+IC0KPiAgIAkvKiBSZWFkIGluIHRoZSBQVF9MT0FEIHNlZ21lbnRz
LiAqLwo+ICAgCWZvciAoaSA9IDA7IGkgPCBlaGRyLT5lX3BobnVtOyBpKyspIHsKPiAgIAkJdW5z
aWduZWQgbG9uZyBsb2FkX2FkZHI7Cj4gQEAgLTU0MiwxMjMgKzQ4Myw1OCBAQCBzdGF0aWMgaW50
IGVsZl9leGVjX2xvYWQoc3RydWN0IGtpbWFnZSAqaW1hZ2UsIHN0cnVjdCBlbGZoZHIgKmVoZHIs
Cj4gICAJCWlmIChzaXplID4gcGhkci0+cF9tZW1zeikKPiAgIAkJCXNpemUgPSBwaGRyLT5wX21l
bXN6Owo+ICAgCj4gLQkJa2J1Zi5idWZmZXIgPSAodm9pZCAqKSBlbGZfaW5mby0+YnVmZmVyICsg
cGhkci0+cF9vZmZzZXQ7Cj4gLQkJa2J1Zi5idWZzeiA9IHNpemU7Cj4gLQkJa2J1Zi5tZW1zeiA9
IHBoZHItPnBfbWVtc3o7Cj4gLQkJa2J1Zi5idWZfYWxpZ24gPSBwaGRyLT5wX2FsaWduOwo+IC0J
CWtidWYuYnVmX21pbiA9IHBoZHItPnBfcGFkZHIgKyBiYXNlOwo+IC0JCXJldCA9IGtleGVjX2Fk
ZF9idWZmZXIoJmtidWYpOwo+ICsJCWtidWYtPmJ1ZmZlciA9ICh2b2lkICopIGVsZl9pbmZvLT5i
dWZmZXIgKyBwaGRyLT5wX29mZnNldDsKPiArCQlrYnVmLT5idWZzeiA9IHNpemU7Cj4gKwkJa2J1
Zi0+bWVtc3ogPSBwaGRyLT5wX21lbXN6Owo+ICsJCWtidWYtPmJ1Zl9hbGlnbiA9IHBoZHItPnBf
YWxpZ247Cj4gKwkJa2J1Zi0+YnVmX21pbiA9IHBoZHItPnBfcGFkZHI7Cj4gKwkJa2J1Zi0+bWVt
ID0gS0VYRUNfQlVGX01FTV9VTktOT1dOOwo+ICsJCXJldCA9IGtleGVjX2FkZF9idWZmZXIoa2J1
Zik7Cj4gICAJCWlmIChyZXQpCj4gICAJCQlnb3RvIG91dDsKPiAtCQlsb2FkX2FkZHIgPSBrYnVm
Lm1lbTsKPiArCQlsb2FkX2FkZHIgPSBrYnVmLT5tZW07Cj4gICAKPiAgIAkJaWYgKGxvYWRfYWRk
ciA8IGxvd2VzdF9hZGRyKQo+ICAgCQkJbG93ZXN0X2FkZHIgPSBsb2FkX2FkZHI7Cj4gICAJfQo+
ICAgCj4gLQkvKiBVcGRhdGUgZW50cnkgcG9pbnQgdG8gcmVmbGVjdCBuZXcgbG9hZCBhZGRyZXNz
LiAqLwo+IC0JZWhkci0+ZV9lbnRyeSArPSBiYXNlOwo+IC0KPiArCWltYWdlLT5zdGFydCA9IGVo
ZHItPmVfZW50cnk7Cj4gICAJKmxvd2VzdF9sb2FkX2FkZHIgPSBsb3dlc3RfYWRkcjsKPiAgIAly
ZXQgPSAwOwo+ICAgIG91dDoKPiAgIAlyZXR1cm4gcmV0Owo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2
b2lkICplbGY2NF9sb2FkKHN0cnVjdCBraW1hZ2UgKmltYWdlLCBjaGFyICprZXJuZWxfYnVmLAo+
IC0JCQl1bnNpZ25lZCBsb25nIGtlcm5lbF9sZW4sIGNoYXIgKmluaXRyZCwKPiAtCQkJdW5zaWdu
ZWQgbG9uZyBpbml0cmRfbGVuLCBjaGFyICpjbWRsaW5lLAo+IC0JCQl1bnNpZ25lZCBsb25nIGNt
ZGxpbmVfbGVuKQo+ICtpbnQga2V4ZWNfZWxmX2tlcm5lbF9sb2FkKHN0cnVjdCBraW1hZ2UgKmlt
YWdlLCBzdHJ1Y3Qga2V4ZWNfYnVmICprYnVmLAo+ICsJCQljaGFyICprZXJuZWxfYnVmLCB1bnNp
Z25lZCBsb25nIGtlcm5lbF9sZW4sCj4gKwkJCXVuc2lnbmVkIGxvbmcgKmtlcm5lbF9sb2FkX2Fk
ZHIpCj4gICB7Cj4gICAJaW50IHJldDsKPiAtCXVuc2lnbmVkIGludCBmZHRfc2l6ZTsKPiAtCXVu
c2lnbmVkIGxvbmcga2VybmVsX2xvYWRfYWRkcjsKPiAtCXVuc2lnbmVkIGxvbmcgaW5pdHJkX2xv
YWRfYWRkciA9IDAsIGZkdF9sb2FkX2FkZHI7Cj4gLQl2b2lkICpmZHQ7Cj4gLQljb25zdCB2b2lk
ICpzbGF2ZV9jb2RlOwo+ICAgCXN0cnVjdCBlbGZoZHIgZWhkcjsKPiAtCXN0cnVjdCBlbGZfaW5m
byBlbGZfaW5mbzsKPiAtCXN0cnVjdCBrZXhlY19idWYga2J1ZiA9IHsgLmltYWdlID0gaW1hZ2Us
IC5idWZfbWluID0gMCwKPiAtCQkJCSAgLmJ1Zl9tYXggPSBwcGM2NF9ybWFfc2l6ZSB9Owo+IC0J
c3RydWN0IGtleGVjX2J1ZiBwYnVmID0geyAuaW1hZ2UgPSBpbWFnZSwgLmJ1Zl9taW4gPSAwLAo+
IC0JCQkJICAuYnVmX21heCA9IHBwYzY0X3JtYV9zaXplLCAudG9wX2Rvd24gPSB0cnVlIH07Cj4g
LQo+IC0JcmV0ID0gYnVpbGRfZWxmX2V4ZWNfaW5mbyhrZXJuZWxfYnVmLCBrZXJuZWxfbGVuLCAm
ZWhkciwgJmVsZl9pbmZvKTsKPiAtCWlmIChyZXQpCj4gLQkJZ290byBvdXQ7Cj4gKwlzdHJ1Y3Qg
a2V4ZWNfZWxmX2luZm8gZWxmX2luZm87Cj4gICAKPiAtCXJldCA9IGVsZl9leGVjX2xvYWQoaW1h
Z2UsICZlaGRyLCAmZWxmX2luZm8sICZrZXJuZWxfbG9hZF9hZGRyKTsKPiArCXJldCA9IGtleGVj
X2J1aWxkX2VsZl9pbmZvKGtlcm5lbF9idWYsIGtlcm5lbF9sZW4sICZlaGRyLCAmZWxmX2luZm8p
Owo+ICAgCWlmIChyZXQpCj4gICAJCWdvdG8gb3V0Owo+ICAgCj4gLQlwcl9kZWJ1ZygiTG9hZGVk
IHRoZSBrZXJuZWwgYXQgMHglbHhcbiIsIGtlcm5lbF9sb2FkX2FkZHIpOwo+IC0KPiAtCXJldCA9
IGtleGVjX2xvYWRfcHVyZ2F0b3J5KGltYWdlLCAmcGJ1Zik7Cj4gLQlpZiAocmV0KSB7Cj4gLQkJ
cHJfZXJyKCJMb2FkaW5nIHB1cmdhdG9yeSBmYWlsZWQuXG4iKTsKPiAtCQlnb3RvIG91dDsKPiAt
CX0KPiAtCj4gLQlwcl9kZWJ1ZygiTG9hZGVkIHB1cmdhdG9yeSBhdCAweCVseFxuIiwgcGJ1Zi5t
ZW0pOwo+IC0KPiAtCWlmIChpbml0cmQgIT0gTlVMTCkgewo+IC0JCWtidWYuYnVmZmVyID0gaW5p
dHJkOwo+IC0JCWtidWYuYnVmc3ogPSBrYnVmLm1lbXN6ID0gaW5pdHJkX2xlbjsKPiAtCQlrYnVm
LmJ1Zl9hbGlnbiA9IFBBR0VfU0laRTsKPiAtCQlrYnVmLnRvcF9kb3duID0gZmFsc2U7Cj4gLQkJ
cmV0ID0ga2V4ZWNfYWRkX2J1ZmZlcigma2J1Zik7Cj4gLQkJaWYgKHJldCkKPiAtCQkJZ290byBv
dXQ7Cj4gLQkJaW5pdHJkX2xvYWRfYWRkciA9IGtidWYubWVtOwo+IC0KPiAtCQlwcl9kZWJ1Zygi
TG9hZGVkIGluaXRyZCBhdCAweCVseFxuIiwgaW5pdHJkX2xvYWRfYWRkcik7Cj4gLQl9Cj4gLQo+
IC0JZmR0X3NpemUgPSBmZHRfdG90YWxzaXplKGluaXRpYWxfYm9vdF9wYXJhbXMpICogMjsKPiAt
CWZkdCA9IGttYWxsb2MoZmR0X3NpemUsIEdGUF9LRVJORUwpOwo+IC0JaWYgKCFmZHQpIHsKPiAt
CQlwcl9lcnIoIk5vdCBlbm91Z2ggbWVtb3J5IGZvciB0aGUgZGV2aWNlIHRyZWUuXG4iKTsKPiAt
CQlyZXQgPSAtRU5PTUVNOwo+IC0JCWdvdG8gb3V0Owo+IC0JfQo+IC0JcmV0ID0gZmR0X29wZW5f
aW50byhpbml0aWFsX2Jvb3RfcGFyYW1zLCBmZHQsIGZkdF9zaXplKTsKPiAtCWlmIChyZXQgPCAw
KSB7Cj4gLQkJcHJfZXJyKCJFcnJvciBzZXR0aW5nIHVwIHRoZSBuZXcgZGV2aWNlIHRyZWUuXG4i
KTsKPiAtCQlyZXQgPSAtRUlOVkFMOwo+IC0JCWdvdG8gb3V0Owo+IC0JfQo+IC0KPiAtCXJldCA9
IHNldHVwX25ld19mZHQoaW1hZ2UsIGZkdCwgaW5pdHJkX2xvYWRfYWRkciwgaW5pdHJkX2xlbiwg
Y21kbGluZSk7Cj4gLQlpZiAocmV0KQo+IC0JCWdvdG8gb3V0Owo+IC0KPiAtCWZkdF9wYWNrKGZk
dCk7Cj4gKwlyZXQgPSBrZXhlY19lbGZfbG9hZChpbWFnZSwgJmVoZHIsICZlbGZfaW5mbywga2J1
Ziwga2VybmVsX2xvYWRfYWRkcik7Cj4gK291dDoKPiArCWtleGVjX2ZyZWVfZWxmX2luZm8oJmVs
Zl9pbmZvKTsKPiArCXJldHVybiByZXQ7Cj4gICAKPiAtCWtidWYuYnVmZmVyID0gZmR0Owo+IC0J
a2J1Zi5idWZzeiA9IGtidWYubWVtc3ogPSBmZHRfc2l6ZTsKPiAtCWtidWYuYnVmX2FsaWduID0g
UEFHRV9TSVpFOwo+IC0Ja2J1Zi50b3BfZG93biA9IHRydWU7Cj4gLQlyZXQgPSBrZXhlY19hZGRf
YnVmZmVyKCZrYnVmKTsKPiAtCWlmIChyZXQpCj4gLQkJZ290byBvdXQ7Cj4gLQlmZHRfbG9hZF9h
ZGRyID0ga2J1Zi5tZW07Cj4gK30KPiAgIAo+IC0JcHJfZGVidWcoIkxvYWRlZCBkZXZpY2UgdHJl
ZSBhdCAweCVseFxuIiwgZmR0X2xvYWRfYWRkcik7Cj4gK2ludCBrZXhlY19lbGZfcHJvYmUoY29u
c3QgY2hhciAqYnVmLCB1bnNpZ25lZCBsb25nIGxlbikKPiArewo+ICsJc3RydWN0IGVsZmhkciBl
aGRyOwo+ICsJc3RydWN0IGtleGVjX2VsZl9pbmZvIGVsZl9pbmZvOwo+ICsJaW50IHJldDsKPiAg
IAo+IC0Jc2xhdmVfY29kZSA9IGVsZl9pbmZvLmJ1ZmZlciArIGVsZl9pbmZvLnByb2doZHJzWzBd
LnBfb2Zmc2V0Owo+IC0JcmV0ID0gc2V0dXBfcHVyZ2F0b3J5KGltYWdlLCBzbGF2ZV9jb2RlLCBm
ZHQsIGtlcm5lbF9sb2FkX2FkZHIsCj4gLQkJCSAgICAgIGZkdF9sb2FkX2FkZHIpOwo+ICsJcmV0
ID0ga2V4ZWNfYnVpbGRfZWxmX2luZm8oYnVmLCBsZW4sICZlaGRyLCAmZWxmX2luZm8pOwo+ICAg
CWlmIChyZXQpCj4gLQkJcHJfZXJyKCJFcnJvciBzZXR0aW5nIHVwIHRoZSBwdXJnYXRvcnkuXG4i
KTsKPiArCQlyZXR1cm4gcmV0Owo+ICAgCj4gLW91dDoKPiAtCWVsZl9mcmVlX2luZm8oJmVsZl9p
bmZvKTsKPiArCWtleGVjX2ZyZWVfZWxmX2luZm8oJmVsZl9pbmZvKTsKPiAgIAo+IC0JLyogTWFr
ZSBraW1hZ2VfZmlsZV9wb3N0X2xvYWRfY2xlYW51cCBmcmVlIHRoZSBmZHQgYnVmZmVyIGZvciB1
cy4gKi8KPiAtCXJldHVybiByZXQgPyBFUlJfUFRSKHJldCkgOiBmZHQ7Cj4gKwlyZXR1cm4gZWxm
X2NoZWNrX2FyY2goJmVoZHIpID8gMCA6IC1FTk9FWEVDOwo+ICAgfQo+IC0KPiAtY29uc3Qgc3Ry
dWN0IGtleGVjX2ZpbGVfb3BzIGtleGVjX2VsZjY0X29wcyA9IHsKPiAtCS5wcm9iZSA9IGVsZjY0
X3Byb2JlLAo+IC0JLmxvYWQgPSBlbGY2NF9sb2FkLAo+IC19Owo+IAoKCkNocmlzdG9waGUKCl9f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmtleGVjIG1haWxp
bmcgbGlzdAprZXhlY0BsaXN0cy5pbmZyYWRlYWQub3JnCmh0dHA6Ly9saXN0cy5pbmZyYWRlYWQu
b3JnL21haWxtYW4vbGlzdGluZm8va2V4ZWMK
